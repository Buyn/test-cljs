:PROPERTIES:
:header-args: :tangle no :mkdirp yes :results output silent :no-expand t
:END:
* src worder
** src project
*** other
(find-file-other-frame "./project.clj")
(find-file-other-frame "dev.cljs.edn")
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/dev.cljs.edn
(find-file-other-frame "test.cljs.edn")
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/test.cljs.edn
(find-file-other-frame "figwheel-main.edn")
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/figwheel-main.edn
*** CANCELED deps.edn
:PROPERTIES:
:header-args: :tangle no
:END:
:header-args: :tangle deps.edn
**** file
(find-file-other-frame "deps.edn")
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/deps.edn
**** src
***** src deps.edn
#+begin_src clojure :no-expand t
{:deps {org.clojure/clojure {:mvn/version "1.12.0"}
        org.clojure/clojurescript {:mvn/version "1.11.132"}
        org.clojure/data.json {:mvn/version "2.5.1"}
        cljsjs/react {:mvn/version "18.3.1-1"}
        cljsjs/react-dom {:mvn/version "18.3.1-1"}
        org.clojure/core.async     {:mvn/version "0.7.559"
                                    :exclusions  [org.clojure/tools.reader]}
        keechma/keechma            {:mvn/version "0.3.14"
                                    :exclusions [cljsjs/react-with-addons
                                                 cljsjs/react-dom
                                                 cljsjs/react-dom-server]}
        keechma/entitydb           {:mvn/version "0.1.6"}
        reagent/reagent {:mvn/version "0.9.1" }}

 :paths ["src" "resources"]

 :aliases {:fig {:extra-deps
                 {com.bhauman/rebel-readline-cljs {:mvn/version "0.1.4"}
                  com.bhauman/figwheel-main {:mvn/version "0.2.20"}
                  org.slf4j/slf4j-nop {:mvn/version "2.0.16"}}
                 :extra-paths ["target" "test"]}
           :build {:main-opts ["-m" "figwheel.main" "-b" "dev" "-r"]}
           :clean {:main-opts ["-m" "figwheel.main" "--clean" "dev"]}
           :min   {:main-opts ["-m" "figwheel.main" "-O" "advanced" "-bo" "dev"]}
           :test  {:main-opts ["-m" "figwheel.main" "-co" "test.cljs.edn" "-m" "keechma-todomvc.test-runner"]}}}

#+end_src
***** CANCELED orignl
#+begin_src clojure :no-expand t :tangle no 
{:deps {org.clojure/clojure {:mvn/version "1.12.0"}
        org.clojure/clojurescript {:mvn/version "1.11.132"}
        org.clojure/data.json {:mvn/version "2.5.1"}
        cljsjs/react {:mvn/version "18.3.1-1"}
        cljsjs/react-dom {:mvn/version "18.3.1-1"}
        reagent/reagent {:mvn/version "1.2.0" }}
 :paths ["src" "resources"]
 :aliases {:fig {:extra-deps
                 {com.bhauman/rebel-readline-cljs {:mvn/version "0.1.4"}
                  com.bhauman/figwheel-main {:mvn/version "0.2.20"}
                  org.slf4j/slf4j-nop {:mvn/version "2.0.16"}}
                 :extra-paths ["target" "test"]}
           :build {:main-opts ["-m" "figwheel.main" "-b" "dev" "-r"]}
           :clean {:main-opts ["-m" "figwheel.main" "--clean" "dev"]}
           :min   {:main-opts ["-m" "figwheel.main" "-O" "advanced" "-bo" "dev"]}
           :test  {:main-opts ["-m" "figwheel.main" "-co" "test.cljs.edn" "-m" "keechma-todomvc.test-runner"]}}}
#+end_src
** src core
*** components.cljs
:PROPERTIES:
:header-args: :tangle src/keechma_todomvc/components.cljs
:END:
**** file components.cljs
(find-file-other-frame "./src/keechma_todomvc/components.cljs")
**** src components.cljs
#+begin_src clojure :no-expand t :mkdirp yes
(ns keechma-todomvc.components
  "# Todo UI Component system"
  (:require [keechma-todomvc.components.app :as app]
            [keechma-todomvc.components.footer :as footer]
            [keechma-todomvc.components.new-todo :as new-todo]
            [keechma-todomvc.components.todo-edit :as todo-edit]
            [keechma-todomvc.components.timer-button :as timer-button]
            [keechma-todomvc.components.todo-item :as todo-item]
            [keechma-todomvc.components.todo-list :as todo-list]
            [keechma-todomvc.components.export-txt :as export-txt]
            [keechma-todomvc.components.import-txt :as import-txt]
            [keechma-todomvc.components.toggle-todos :as toggle-todos]))

(def system
  "Defines the component `system`. All the components that send commands
  are configured to send them to the `:todos` topic controller."
  {:main app/component
   :footer (assoc footer/component :topic :todos)
   :new-todo (assoc new-todo/component :topic :todos)
   :todo-edit (assoc todo-edit/component :topic :todos)
   :todo-item (assoc todo-item/component :topic :todos)
   :timer-button (assoc timer-button/component :topic :todos)
   :import-txt (assoc import-txt/component :topic :todos)
   ;; :export-txt (assoc export-txt/component :topic :todos)
   :export-txt export-txt/component
   :todo-list todo-list/component
   :toggle-todos (assoc toggle-todos/component :topic :todos)})


#+end_src
*** app.cljs
:PROPERTIES:
:header-args: :tangle src/keechma_todomvc/app.cljs
:END:
**** src app.cljs
#+begin_src clojure :no-expand t :mkdirp yes
(ns keechma-todomvc.app
  "# Keechma TodoMVC App"
  (:require [keechma-todomvc.components :as components]
            [keechma-todomvc.controllers.todos :as todos]
            [keechma-todomvc.subscriptions :as subscriptions]
            [keechma.app-state :as app-state]))

(defonce running-app (atom nil))

;; ## App Definition

(def app-definition
  "Pulls the app together."
  {:routes [[":status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

;; ## App Lifecycle

(defn start!
  "Starts the app."
  []
  (reset! running-app (app-state/start! app-definition)))

(defn restart!
  "Restarts the app. `project.clj` contains a config setting for
  `figwheel` requesting a call to this function whenever the code is
  reloaded."
  []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup
  "Enables console output for dev builds."
  []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

;; ## Main

(defn ^:export main
  "Called from `index.html` to start the app. Exported because
  `index.html` refers to it by name even in non-dev builds."
  []
  (dev-setup)
  (start!))


#+end_src
**** file app.cljs
(find-file-other-frame "./src/keechma_todomvc/app.cljs")
*** other
(find-file-other-frame "./src/keechma_todomvc/subscriptions.cljs")
(find-file-other-frame "./src/keechma_todomvc/ui.cljs")
(find-file-other-frame "./src/keechma_todomvc/util.cljs")
(find-file-other-frame "./src/keechma_todomvc/edb.cljs")
(find-file-other-frame "./src/keechma_todomvc/edb.clj")
*** CANCELED worder.cljs
:PROPERTIES:
:header-args: :tangle no
:END:
:header-args: :tangle src/keechma_todomvc/worder.cljs
**** file worder.cljs
(find-file-other-frame "src/keechma_todomvc/worder.cljs")
**** src worder.cljs
***** test version src worder.cljs
#+begin_src clojure :no-expand t :mkdirp yes
(ns ^:figwheel-hooks keechma-todomvc.worder
  (:require
   [keechma-todomvc.components :as components]
   [keechma-todomvc.controllers.todos :as todos]
   [keechma-todomvc.subscriptions :as subscriptions]
   [reagent.core :as reagent :refer [atom]]
   [keechma.app-state :as app-state]))

(defn multiply [a b] (* a b))

(defonce running-app (atom nil))

(def app-definition
  {:routes [["/:status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

(defn start! []
  (reset! running-app (app-state/start! app-definition)))

(defn restart! []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

(defn ^:export main []
  (dev-setup)
  (start!))

(defn ^:after-load on-reload []
  (restart!))


#+end_src
***** keechma version src worder.cljs
#+begin_src clojure :no-expand t :mkdirp yes :tangle no
(ns ^:figwheel-hooks keechma-todomvc.worder
  "# Keechma TodoMVC App"
  (:require [keechma-todomvc.components :as components]
            [keechma-todomvc.controllers.todos :as todos]
            [keechma-todomvc.subscriptions :as subscriptions]
            [keechma.app-state :as app-state]))


(defn multiply [a b] (* a b))

(defonce running-app (atom nil))

;; ;; ## App Definition

(def app-definition
  "Pulls the app together."
  {:routes [[":status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

;; ## App Lifecycle

(defn start!
  "Starts the app."
  []
  (reset! running-app (app-state/start! app-definition)))

(defn restart!
  "Restarts the app. `project.clj` contains a config setting for
  `figwheel` requesting a call to this function whenever the code is
  reloaded."
  []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup
  "Enables console output for dev builds."
  []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

;; ;; ## Main

(defn ^:export main
  "Called from `index.html` to start the app. Exported because
  `index.html` refers to it by name even in non-dev builds."
  []
  (dev-setup)
  (start!))


(dev-setup)
(start!)
(println "This text is printed from src/keechma_todomvc/worder.cljs. Go ahead and edit it and see reloading in action.")


#+end_src
***** src worder.cljs
#+begin_src clojure :no-expand t :mkdirp yes :tangle no
(ns ^:figwheel-hooks keechma-todomvc.worder
  "# Keechma TodoMVC App"
  (:require [keechma-todomvc.components :as components]
            [keechma-todomvc.controllers.todos :as todos]
            [keechma-todomvc.subscriptions :as subscriptions]
            [goog.dom :as gdom]
            [reagent.core :as reagent :refer [atom]]
            [reagent.dom :as rdom]
            [keechma.app-state :as app-state]))

;; (ns ^:figwheel-hooks keechma-todomvc.worder
;;   (:require
;;    [goog.dom :as gdom]
;;    [reagent.core :as reagent :refer [atom]]
;;    [reagent.dom :as rdom]))

(defn multiply [a b] (* a b))

(defonce running-app (atom nil))

;; ;; ## App Definition

(def app-definition
  "Pulls the app together."
  {:routes [[":status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

;; ## App Lifecycle

(defn start!
  "Starts the app."
  []
  (reset! running-app (app-state/start! app-definition)))

(defn restart!
  "Restarts the app. `project.clj` contains a config setting for
  `figwheel` requesting a call to this function whenever the code is
  reloaded."
  []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup
  "Enables console output for dev builds."
  []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

;; ;; ## Main

(defn ^:export main
  "Called from `index.html` to start the app. Exported because
  `index.html` refers to it by name even in non-dev builds."
  []
  (dev-setup)
  (start!))

(println "This text is printed from src/keechma_todomvc/worder.cljs. Go ahead and edit it and see reloading in action.")

;; (defn multiply [a b] (* a b))

;; define your app data so that it doesn't get over-written on reload
(defonce app-state (atom {:text "Hello world!"}))

(defn get-app-element []
  (gdom/getElement "app"))

(defn hello-world []
  [:div
   [:h1 (:text @app-state)]
   [:h3 "Edit this in src/keechma_todomvc/worder.cljs and watch it change!"]])

(defn mount [el]
  (rdom/render [hello-world] el))

(defn mount-app-element []
  (when-let [el (get-app-element)]
    (mount el)))

;; conditionally start your application based on the presence of an "app" element
;; this is particularly helpful for testing this ns without launching the app
(mount-app-element)
;; (dev-setup)
;; (start!)

;; specify reload hook with ^:after-load metadata
(defn ^:after-load on-reload []
  (mount-app-element)
  ;; (dev-setup)
  ;; optionally touch your app-state to force rerendering depending on
  ;; your application
  ;; (swap! app-state update-in [:__figwheel_counter] inc)
)

;; (defn ^:after-load on-reload []
;;   (restart!))
#+end_src
***** CANCELED original figwheel template
#+begin_src clojure :no-expand t :mkdirp yes :tangle no 
(ns ^:figwheel-hooks keechma-todomvc.worder
  (:require
   [goog.dom :as gdom]
   [reagent.core :as reagent :refer [atom]]
   [reagent.dom :as rdom]))

(println "This text is printed from src/keechma_todomvc/worder.cljs. Go ahead and edit it and see reloading in action.")

(defn multiply [a b] (* a b))

;; define your app data so that it doesn't get over-written on reload
(defonce app-state (atom {:text "Hello world!"}))

(defn get-app-element []
  (gdom/getElement "app"))

(defn hello-world []
  [:div
   [:h1 (:text @app-state)]
   [:h3 "Edit this in src/keechma_todomvc/worder.cljs and watch it change!"]])

(defn mount [el]
  (rdom/render [hello-world] el))

(defn mount-app-element []
  (when-let [el (get-app-element)]
    (mount el)))

;; conditionally start your application based on the presence of an "app" element
;; this is particularly helpful for testing this ns without launching the app
(mount-app-element)

;; specify reload hook with ^:after-load metadata
(defn ^:after-load on-reload []
  (mount-app-element)
  ;; optionally touch your app-state to force rerendering depending on
  ;; your application
  ;; (swap! app-state update-in [:__figwheel_counter] inc)
)
#+end_src
**** repl

# (ns ^:figwheel-hooks keechma-todomvc.worder
(require `[keechma-todomvc.worder :as worder-main]

(in-ns `keechma-todomvc.worder)
**** exampl
(find-file-other-frame "./src/keechma_todomvc/app.cljs")
** src components
*** components/app.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/app.cljs
:END:
**** file components/app.cljs
(find-file-other-frame "./src/keechma_todomvc/components/app.cljs")
**** src components/app.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]))


(defn render
  "## Renders the top level UI

  Some elements are rendered inline, others are implemented as
  `components`. Each `component` will have its own `context` provided.

### Component Deps

- `:new-todo` top field where new `todos` are entered
- `:toggle-todos` checkbox to the left of `:new-todo`
- `:todo-list` main body list of `todos`
- `:footer` active count, filtering, clearing

### Subscription Deps

- `:has-todos?` returns true if there are any todos in the EntityDB."
  [ctx]
  [:<>
   [:section.todoapp
    [:header.header
     [:h1 "Worder"]
     [:div.export-panel
      [comp> ctx :import-txt]
      [comp> ctx :import-txt {:path "words-ung-ua.txt"
                              :title "üìñJung UA"}]

      ]
     [comp> ctx :new-todo]]
    (when (sub> ctx :has-todos?)
      [:<>
       [:section.main
        [comp> ctx :toggle-todos]
        [comp> ctx :todo-list]]
       [comp> ctx :footer]])]

    [:div.export-panel
        [comp> ctx :export-txt {:title "üíæ Export to text"
                                :sep "\t"
                                :eof "\n"
                                :ext ".txt"}]
        [comp> ctx :export-txt {:title "üíæ Export to CSV"
                                :sep ";"
                                :eof "\n"
                                :ext ".csv"}]]
   [:footer.info
    [:p "Double-click to edit a Word"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "https://www.linkedin.com/in/buyn-max"} "Freeman"]]]])

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :import-txt
                          :export-txt
                          :footer]
         :subscription-deps [:has-todos?]))

#+end_src

**** exempls
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/src/keechma_todomvc/components/app.cljs")
**** CANCELED arhiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 01 src components/app.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]))

(defn render
  "## Renders the top level UI

  Some elements are rendered inline, others are implemented as
  `components`. Each `component` will have its own `context` provided.

### Component Deps

- `:new-todo` top field where new `todos` are entered
- `:toggle-todos` checkbox to the left of `:new-todo`
- `:todo-list` main body list of `todos`
- `:footer` active count, filtering, clearing

### Subscription Deps

- `:has-todos?` returns true if there are any todos in the EntityDB."
  [ctx]
  [:<>
   [:section.todoapp
    [:header.header
     [:h1 "Worder"]
     [comp> ctx :new-todo]]
    (when (sub> ctx :has-todos?)
      [:<>
       [:section.main
        [comp> ctx :toggle-todos]
        [comp> ctx :todo-list]]
       [comp> ctx :footer]])]
   [:footer.info
    [:p "Double-click to edit a todo"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "http://todomvc.com"} "TodoMVC"]]]])

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :footer]
         :subscription-deps [:has-todos?]))

#+end_src


***** old
     [comp> ctx :timer-button]
                          :timer-button
     [:h1 "Worder"]
     ;; [comp> ctx :timer-button]
     [comp> ctx :new-todo]]

*** components/todo_edit.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/todo_edit.cljs
:END:
**** file
(find-file-other-frame "./src/keechma_todomvc/components/todo_edit.cljs")
**** src
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.todo-edit
  "# Todo Edit component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp sub>]]
            [keechma-todomvc.util :refer [is-enter? is-esc?]]
            [reagent.core :as reagent]))

(defn form-3-render
  "## Renders an Edit Field

### Form 3 render function

  Returns a `reagent class` created from a map that allows us to
  provide additional component data to `reagent` including
  implementations for `react lifecycle functions` like
  `:component-did-mount`.

### Subscription Deps

- `:edit-todo` returns the `todo` currently being edited, or nil

### Note

  This component is using a `form 3` render function to demonstrate
  the additional flexibility it allows. In this case, we could get the
  same effect by setting the `:auto-focus` attribute on the
  `:input.edit` element to `true` within a `form 2` render function."
  [ctx]
  (let [edit-todo (sub> ctx :edit-todo)
        todo-title (reagent/atom (:title edit-todo))
        handle-change #(reset! todo-title (.. % -target -value))
        update #(<cmd ctx :confirm-edit (assoc edit-todo :title @todo-title))
        cancel #(<cmd ctx :cancel-edit)
        handle-key-down #(let [key-code (.-keyCode %)]
                           (when (is-enter? key-code) (update))
                           (when (is-esc? key-code) (cancel)))
        render (fn []
                 [:input.edit {:value @todo-title
                               :on-blur update
                               :on-change handle-change
                               :on-key-down handle-key-down}])
        focus-input #(let [node (reagent/dom-node %)
                           length (count (.-value node))]
                       (reset! todo-title (str @todo-title "\t-\t"))
                       (.focus node)
                       (.setSelectionRange node length length))]
    (reagent/create-class
     {:display-name "todo-edit"
      :reagent-render render
      :component-did-mount focus-input})))

(def component
  (<comp :renderer form-3-render
         :subscription-deps [:edit-todo]))
#+end_src
**** exempl
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/src/keechma_todomvc/components/todo_edit.cljs")

*** components/timer_button.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/timer_button.cljs
:END:
**** file timer_button.cljs
(find-file-other-frame "./src/keechma_todomvc/components/timer_button.cljs")
**** src timer_button.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn render [ctx todo]
  (let [seconds (r/atom 0)
        timer-id (r/atom nil)
        start-ms (r/atom nil)
        running? #(not (= @timer-id nil))
        counter #(reset! seconds (/ (- (.now js/Date) @start-ms) 1000))
        stop! (fn []
                (counter)
                (js/clearInterval @timer-id)
                (reset! timer-id nil)
                (reset! start-ms nil)
                (<cmd ctx :start-edit todo)
                (<cmd ctx
                      :update-todo-time
                      {:id (:id todo) :time @seconds :todo todo}))
        start! (fn []
                  (reset! start-ms (.now js/Date))
                  (reset! timer-id (js/setInterval counter 100)))
        toggle! #(if (running?) (stop!) (start!))]  
    (fn []
      [:div.timer {:class (when (running?) "running")}
       [:button
        {:on-click toggle!} 
        (if (running?) "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
**** –ò–ò
***** —è –∏–∑–º–µ–Ω–∏–ª –Ω–µ–º–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏—é –∏ –¥–æ–≤–∞–π –∏–∑–º–µ–Ω–∏–º –ª–æ–≥–∏–≥–∏–∫—É
timer-button
–æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –∏ —Ä–µ–∞–≥–µ–Ω—Ç –∞—Ç–æ–º–∞.
–∫–Ω–æ–ø–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
–∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ–∫—É–¥–æ–º–µ—Ä. –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä.
–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å–µ–∫—É–Ω–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–æ –≤—Ç–æ—Ä–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ.
–ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã —Å–æ–∑–¥–∞—ë–º –∞—Ç–æ–º –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–∏. 
–∑–∞–ø–æ–º–∏–Ω–µ—Ç –≤—Ä–µ–º—è —Å–µ–π—á–∞—Å
–∏ –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫—É–Ω–¥—ã –≤—ã—Å—á–∏—Ç–≤–∞–µ—Ç —Ç–µ–∫—É—à–µ–µ –≤—Ä–µ–º—è - –∑–∞–ø–æ–º–Ω–µ–Ω–æ–µ.
–∏ –ø–æ–º–µ—à–∞–µ—Ç –≤ –∞—Ç–æ–º.
–∏ –¥–æ–≤–∞–π —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ —Ç–æ–ª—å–∫–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ–¥–Ω–æ –∞—Ç–æ–º–∞ –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥–µ—Ç –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–µ–∫—É–Ω—Ç—ã.
–æ—Å—Ç–∞–ª—å–Ω—ã–µ –ø–µ—Ä–º–µ–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–≥–∞—é —Å–¥–µ–ª–∞—Ç—å –≤—Ä–º–µ–Ω—ã–º–∏ –∏ –Ω–µ –∞—Ç–æ–º–∞–º–∏. –ß—Ç–æ–± –Ω–µ –ø–ª–æ–¥–∏—Ç—å —Å—É—à–Ω–æ—Å—Ç–∏.
–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ–∫—É–Ω—Ç —Å—Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ –º–∏–ª–µ—Å–∏–∫—É–Ω–¥ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
***** 
(defn render [ctx]
  (let [seconds (r/atom 0)
        timer-id (atom nil)
        start-ts (atom nil)
        toggle! (fn [_]
                  (if @timer-id
                    ;; Stop
                    (do (js/clearInterval @timer-id)
                        (reset! timer-id nil)
                        (reset! start-ts nil))
                    ;; Start
                    (let [now (.now js/Date)]
                      (reset! start-ts now)
                      (reset! timer-id
                              (js/setInterval
                                (fn []
                                  (let [elapsed (/ (- (.now js/Date) @start-ts) 1000)]
                                    (reset! seconds (Math/floor elapsed))))
                                500)))))]
    
    (fn []
        [:div.timer
          [:button
            {:on-click triger-fn}
            (if @running? "‚ñ† Stop" "‚ñ∂ Start")]
          [:span.seconds (str @seconds " sec.")]])))

***** —Ö–æ—á—É —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
timer-button
–æ–Ω –¥–æ–ª–∂–µ–Ω —Å–æ—Å—Ç–æ—è—Ç—å –∏–∑ –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤. –∏ —Ä–µ–∞–≥–µ–Ω—Ç –∞—Ç–æ–º–∞.
–∫–Ω–æ–ø–∫–∞ –∏ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
–∫–Ω–æ–ø–∫–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ–∫—É–¥–æ–º–µ—Ä. –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–µ–∫—É–Ω–¥–æ–º–µ—Ä.
–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å–µ–∫—É–Ω–¥ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≤–æ –≤—Ç–æ—Ä–æ–º —ç–ª–µ–º–µ–Ω—Ç–µ.
–ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã —Å–æ–∑–¥–∞—ë–º –∞—Ç–æ–º –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ñ—É–Ω–∫—Ü–∏–∏. 
–∑–∞–ø–æ–º–∏–Ω–µ—Ç –≤—Ä–µ–º—è —Å–µ–π—á–∞—Å
–∏ –∫–∞–∂–¥—ã–µ 0.5 —Å–µ–∫—É–Ω–¥—ã –≤—ã—Å—á–∏—Ç–≤–∞–µ—Ç —Ç–µ–∫—É—à–µ–µ –≤—Ä–µ–º—è - –∑–∞–ø–æ–º–Ω–µ–Ω–æ–µ.
–∏ –ø–æ–º–µ—à–∞–µ—Ç –≤ –∞—Ç–æ–º.
**** CANCELED arhiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 02 src timer_button.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)
        timer-id (r/atom nil)
        stop! (fn [] (do (js/clearInterval @timer-id)
                 (reset! timer-id nil)))
        start! (fn [] (let [start-ms (.now js/Date)]
                 (reset! timer-id
                       (js/setInterval
                        (fn []
                          (let [elapsed (/ (- (.now js/Date) start-ms) 1000)]
                            (reset! seconds elapsed)))
                        100))))
        toggle! (fn [_] (if @timer-id (stop!) (start!)))]  

    (fn []
      [:div.timer
       [:button
        {:on-click toggle!} 
        (if @timer-id "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
***** src 01 timer_button.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)    ;; –∑–¥–µ—Å—å –∂–∏–≤—ë—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        timer-id (r/atom nil)
        toggle! (fn [_]
           (if @timer-id
             ;; Stop
             (do (js/clearInterval @timer-id)
                 (reset! timer-id nil))
             ;; Start
             (let [start-ms (.now js/Date)]
               (reset! timer-id
                       (js/setInterval
                        (fn []
                          (let [elapsed (/ (- (.now js/Date) start-ms) 1000)]
                            (reset! seconds elapsed)))
                        100)))))]  

    (fn []
      [:div.timer
       [:button
        {:on-click toggle!} 
        (if @timer-id "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
***** src error
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)
        timer-id (atom nil)
        activ? (= @timer-id nil) 
        start-ms (atom 0)
        toggle! (fn [_]
           (if @timer-id
             ;; Stop
             (do (js/clearInterval @timer-id)
                 (reset! timer-id nil)
                 (let [elapsed (/ (- (.now js/Date) @start-ms) 1000)]
                    (reset! seconds elapsed)))
             ;; Start
             (do (reset! @start-ms (.now js/Date))
                 (reset! timer-id
                      (js/setInterval
                        (fn []
                          (let [elapsed (/ (- (.now js/Date) @start-ms) 1000)]
                            (reset! seconds elapsed)))
                        100)))))]  
    (fn []
      [:div.timer
       [:button
        {:on-click toggle!} 
        (if (activ?) "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
***** src 02
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)    ;; –∑–¥–µ—Å—å –∂–∏–≤—ë—Ç —Ç–æ–ª—å–∫–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        timer-id (atom nil)
        togle! (fn [_]
           (if @timer-id
             ;; Stop
             (do (js/clearInterval @timer-id)
                 (reset! timer-id nil))
             ;; Start
             (let [start-ms (.now js/Date)]
               (reset! timer-id
                       (js/setInterval
                        (fn []
                          (let [elapsed (/ (- (.now js/Date) start-ms) 1000)]
                            (reset! seconds elapsed)))
                        100)))))]  

    (fn []
      [:div.timer
       [:button
        {:on-click togle!} 
        (if @timer-id "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds
        (str @seconds " sec")
        ;; (-> @seconds
        ;;     (* 100)
        ;;     (Math/round)
        ;;     (/ 100)
        ;;     (str " sec"))
        ]])))
(def component
  (<comp :renderer render
         ;; :component-deps [:new-todo
         ;;                  :toggle-todos
         ;;                  :todo-list
         ;;                  :footer]
         ;; :subscription-deps [:has-todos?]
         ))
#+end_src
***** src 01
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [ctx]
  (let [running? (r/atom false)
          seconds  (r/atom 0)
          timer-id (r/atom nil)]
      (fn []
        [:div.timer
          [:button
            {:on-click
              (fn [_]
                (if @running?
                  (do
                    (swap! running? not)
                    (js/clearInterval @timer-id)
                    (reset! timer-id nil))
                  (do
                    (reset! seconds 0)
                    (swap! running? not)
                    (reset! timer-id
                            (js/setInterval
                              #(swap! seconds inc)
                              1000)))))}
            (if @running? "‚ñ† Stop" "‚ñ∂ Start")]
          [:span.seconds (str @seconds " sec.")]])))

(def component
  (<comp :renderer render
         ;; :component-deps [:new-todo
         ;;                  :toggle-todos
         ;;                  :todo-list
         ;;                  :footer]
         ;; :subscription-deps [:has-todos?]
         ))
#+end_src
**** reple
***** atom

(def timer-id (reagent.core/atom nil))

(= @timer-id nil)

(reset! timer-id 3)

@timer-id

(= @timer-id nil)

(def running? (not (= timer-id nil)))
running?
(running?)
{:class (when (running?) "running")}
***** command
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]

(keechma-todomvc.ui\<cmd 2 :update-todo-time 12 13))
***** js

(js/console.log
  (clj->js
    (-> @keechma.app-state/app-db :entities :todos)))
***** get app
(def app-db (-> keechma-todomvc.app/running-app deref :app-db))
(keechma-todomvc.edb/get-collection @app-db :todos :list)

:todos-by-status

(def app-db (-> keechma-todomvc.app/running-app deref :app-db))



;; –≤—ã–≤–µ—Å—Ç–∏ —Ä–∞–∑–º–µ—Ä todo-–∫–æ–ª–ª–µ–∫—Ü–∏–∏
(-> @app-db (get-in [:entities :todos :entities]) count)

;; –≤—ã–≤–µ—Å—Ç–∏ –ø–µ—Ä–≤—ã–π todo
(-> @app-db (get-in [:entities :todos :entities]) first val)
(println "Keys in app-db:" (keys @app-db))



@(-> keechma-todomvc.app/running-app deref :app-db)
(def app-db (-> keechma-todomvc.app/running-app deref :app-db))
@app-db
(require '[keechma-todomvc.edb :as edb])
(edb/get-collection @app-db :todos :list)
(edb/get-item-by-id @app-db :todos "todo123")
***** todos-by-status

(def app-db (-> keechma-todomvc.app/running-app deref :app-db))
(keechma-todomvc.edb/get-collection @app-db :todos :list)

(defn todos-by-status
  "Returns all `todos` with a `status`."
  [app-db status]
  (let [todos (edb/get-collection app-db :todos :list)]
    (case status
      :completed (filter :completed todos)
      :active (filter (complement :completed) todos)
      :all todos)))

:todos-by-status

(find-file-other-frame "./src/keechma_todomvc/components/todo_list.cljs")

(sub> app-db :todos-by-status :all)

(keechma-todomvc.ui/sub> app-db :todos-by-status "all")

(def app-db (-> keechma-todomvc.app/running-app deref :app-db))
(keechma-todomvc.edb/get-collection app-db :todos :list)

(keechma-todomvc.edb/get-collection app-db :todos :list)

(-> app-db :entities :todos)   
(-> app-db :entities)   

(-> keechma-todomvc.app/running-app :entities)


(:app-db (deref keechma-todomvc.app/running-app))
(:entities (:app-db @keechma-todomvc.app/running-app))
*** components/import_txt.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/import_txt.cljs
:END:
**** file import_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/import_txt.cljs")
**** src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]
            [clojure.string :as str]))

(defn process-lines [ctx content]
  (doseq [line (str/split content #"\n")]
    (let [t (str/trim line)]
      (when-not (empty? t)
        (<cmd ctx :create-todo t)))))

(defn import-from-path [ctx path]
  ;; –ø—É—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
  ;; –∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∫ ./txt/ –ø—Ä–∏ –ø—Ä–æ–¥–µ
  (let [url (if (.startsWith path "/")
              path
              (str "./txt/" path))]
    (-> (js/fetch url)
        (.then (fn [resp]
                 (if (.-ok resp)
                   (.text resp)
                   (throw (js/Error. (str "HTTP error: " (.-status resp)))))))
        (.then #(process-lines ctx %))
        (.catch #(js/console.error "Import failed:" %)))))

(defn import-from-dialog [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)]
    (set! (.-onload reader)
          (fn [evt]
            (let [content (.. evt -target -result)]
              (process-lines ctx content))))
    (.readAsText reader file)))

(defn render [ctx {:keys [path title]
                   :or {title "üìé Import from file"}}]
  (let [file-input (r/atom nil)]
    (fn []
      [:div.import-wrapper
       (if path
         [:button {:on-click #(import-from-path ctx path)} title]
         [:<>
          [:input {:type "file"
                   :style {:display "none"}
                   :ref #(reset! file-input %)
                   :on-change #(import-from-dialog ctx %)}]
          [:button {:on-click #(.click @file-input)} title]])])))

(def component
  (<comp :renderer render))

#+end_src
**** CANCELED arhiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 04 src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]
            [clojure.string :as str]))

(defn process-lines [ctx content]
  (doseq [line (str/split content #"\n")]
    (let [t (str/trim line)]
      (when-not (empty? t)
        (<cmd ctx :create-todo t)))))

(defn import-from-path [ctx path]
  ;; –ø—É—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å –∞–±—Å–æ–ª—é—Ç–Ω—ã–π –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
  ;; –∏–ª–∏ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω—ã–π –∫ /txt/ –ø—Ä–∏ –ø—Ä–æ–¥–µ
  (let [url (if (.startsWith path "/")
              path
              (str "./txt/" path))]
    (-> (js/fetch url)
        (.then (fn [resp]
                 (if (.-ok resp)
                   (.text resp)
                   (throw (js/Error. (str "HTTP error: " (.-status resp)))))))
        (.then #(process-lines ctx %))
        (.catch #(js/console.error "Import failed:" %)))))

(defn import-from-dialog [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)]
    (set! (.-onload reader)
          (fn [evt]
            (let [content (.. evt -target -result)]
              (process-lines ctx content))))
    (.readAsText reader file)))

(defn render [ctx {:keys [path title]
                   :or {title "üìé Import from file"}}]
  (let [file-input (r/atom nil)]
    (fn []
      [:div.import-wrapper
       (if path
         [:button {:on-click #(import-from-path ctx path)} title]
         [:<>
          [:input {:type "file"
                   :style {:display "none"}
                   :ref #(reset! file-input %)
                   :on-change #(import-from-dialog ctx %)}]
          [:button {:on-click #(.click @file-input)} title]])])))

(def component
  (<comp :renderer render))

#+end_src
***** 03 src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)
        onload-evt (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t))))))]
        (set! (.-onload reader) onload-evt)
        (println (.readAsText reader file))))

(defn render [ctx]
  (let [file-input (r/atom nil)]  
    (fn []
      [:div
        [:input {:type "file"
                :style {:display "none"}
                :ref #(reset! file-input %)
                :on-change #(import-file ctx %)}]
        [:button {:on-click #(.click @file-input)}
        "üìéImport from file"]])))

(def component
  (<comp :renderer render))
#+end_src
***** 02 src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)
        onload-evt (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t))))))]
        (set! (.-onload reader) onload-evt)
        (println (.readAsText reader file))))

(defn render [ctx]
  (let [file-input (r/atom nil)]  
    (fn []
      [:div
        [:input {:type "file"
                :style {:display "none"}
                :ref #(reset! file-input %)
                :on-change #(import-file ctx %)}]
        [:button {:on-click #(.click @file-input)}
        "üìéImport from file"]])))

(def component
  (<comp :renderer render))
#+end_src
***** 01 src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)]
    (set! (.-onload reader)
          (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t)))))))
    (.readAsText reader file)))

(defn render [ctx]
  (let [file-input (r/atom nil)]  
    (fn []
      [:div
        [:input {:type "file"
                :style {:display "none"}
                :ref #(reset! file-input %)
                :on-change #(import-file ctx %)}]
        [:button {:on-click #(.click @file-input)}
        "Import from file"]])))

(def component
  (<comp :renderer render))
#+end_src
**** reple
*** components/export_txt.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/export_txt.cljs
:END:
**** file export_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/export_txt.cljs")
**** src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos {:keys [sep ext eof]}]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title sep (or time 0)))
                   todos)
        content (str/join eof lines)
        blob (js/Blob. #js [content] #js {:type "text/plain;charset=utf-8"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    ;; —Å–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É
    (set! (.-href a) url)
    (set! (.-download a)
          (str "words-" (.toISOString (js/Date.)) ext))
    ;; –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ DOM, –∏–Ω–∞—á–µ Firefox –Ω–µ —Å—Ä–µ–∞–≥–∏—Ä—É–µ—Ç
    (.appendChild (.-body js/document) a)
    ;; "–∫–ª–∏–∫" –ø–æ —Å—Å—ã–ª–∫–µ
    (.click a)
    ;; —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º URL —á—É—Ç—å –ø–æ–∑–∂–µ
    (.remove a)
    (js/setTimeout #(js/URL.revokeObjectURL url) 2000)))

(defn render [ctx {:keys [title] :as props}]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button.export-btn
     {:on-click #(export-file todos props)
      :title "Export current list to text file"}
     title]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))


#+end_src


#+end_src
**** CANCELED arhiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 03 src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title "\t" (or time 0)))
                   todos)
        content (str/join "\n" lines)
        blob (js/Blob. #js [content] #js {:type "text/plain;charset=utf-8"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    ;; —Å–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É
    (set! (.-href a) url)
    (set! (.-download a)
          (str "words-" (.toISOString (js/Date.)) ".txt"))
    ;; –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ DOM, –∏–Ω–∞—á–µ Firefox –Ω–µ —Å—Ä–µ–∞–≥–∏—Ä—É–µ—Ç
    (.appendChild (.-body js/document) a)
    ;; "–∫–ª–∏–∫" –ø–æ —Å—Å—ã–ª–∫–µ
    (.click a)
    ;; —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º URL —á—É—Ç—å –ø–æ–∑–∂–µ
    (.remove a)
    (js/setTimeout #(js/URL.revokeObjectURL url) 2000)))

(defn render [ctx]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button.export-btn
     {:on-click #(export-file todos)
      :title "Export current list to text file"}
     "üíæ Export to text"]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))


#+end_src


#+end_src
***** 02 src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title "\t" (or time 0)))
                   todos)
        content (str/join "\n" lines)
        blob (js/Blob. #js [content] #js {:type "text/plain;charset=utf-8"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    (set! (.-href a) url)
    (set! (.-download a)
          (str "todos-" (.toISOString (js/Date.)) ".txt"))
    (.click a)
    (.revokeObjectURL js/URL url)))

(defn render [ctx]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button.export-btn
     {:on-click #(export-file @todos)
      :title "Export current list to text file"}
     "üíæ Export to text"]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))


#+end_src
***** 00 src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title "\t" (or time 0)))
                   todos)
        content (str/join "\n" lines)
        blob (js/Blob. #js [content] #js {:type "text/plain"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    (set! (.-href a) url)
    (set! (.-download a) "words.txt")
    (.click a)
    (.revokeObjectURL js/URL url)))

(defn render [ctx]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:div.timer
      [:button {:on-click #(export-file @todos)}
      "üíæ Export to text"]]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))

#+end_src
**** reple
*** components/todo_item.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/todo_item.cljs
:END:
**** file components/todo_item.cljs
(find-file-other-frame "./src/keechma_todomvc/components/todo_item.cljs")
**** src components/todo_item.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.todo-item
  "# Todo Item component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp comp>]]))

(defn render
  "## Renders a todo list item

  The item's content includes:

- a `checkbox` for toggling `:completed`
- a `label` displaying the `:title`
- a `button` to delete the item

If the item is currently being edited, overlays a `todo-edit` component.

### Component Deps

- `:todo-edit` presents ui to edit a `todo`'s title

### Arguments

  This render function has arguments in addition to `ctx`. Values for
  those are provided at the site where this component is included
  within another, in this case `:todo-list`. If this were a `form-2`
  render function, the returned function would have only `todo` and
  `is-editing?` as arguments."
  [ctx todo is-editing?]
  [:li {:class [(when is-editing? :editing)
                (when (:completed todo) :completed)]}
   [:div.view
    ;; {:on-double-click #(<cmd ctx :start-edit todo)}
    [:input.toggle {:type :checkbox
                    :checked (:completed todo)
                    :on-change #(<cmd ctx :toggle-todo todo)}]
    [:label (:title todo)
      [comp> ctx :timer-button todo]]
    [:button.destroy {:on-click #(<cmd ctx :delete-todo todo)}]]
   (when is-editing?
     [comp> ctx :todo-edit])])

(def component
  (<comp :renderer render
         :component-deps [:todo-edit
                          :timer-button]))

#+end_src
     
**** exempls
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/src/keechma_todomvc/components/todo_item.cljs")
*** components/new_todo.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/components/new_todo.cljs
:END:
**** file components/new_todo.cljs
(find-file-other-frame "./src/keechma_todomvc/components/new_todo.cljs")
**** src components/new_todo.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.new-todo
  "# New Todo component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp]]
            [keechma-todomvc.util :refer [is-enter?]]
            [reagent.core :as reagent]))

(defn form-2-render
  "## Renders an input field for a new todo

  Stores the pending new `title` inside a local `atom`. When the user
  presses `enter`, sends a `:create-todo` command to the `todos`
  controller to create the new `todo`.

### Form 2 Render

  A `form 2` render function sets up local state and returns a
  rendering function from its first call. That `inner` rendering
  function will be called each time `reagent` needs to render the
  component. The arguments for the `inner` function are the same as
  for the `form 2` render function except that the `ctx` argument is
  not present. The local state can be used by the code in the `inner`
  render function. It will persist until the component is unmounted."
  [ctx]
  (let [new-title (reagent/atom "")]
    (fn []
      [:input.new-todo
       {:placeholder "What needs to be Word?"
        :value @new-title
        :auto-focus true
        :on-change #(reset! new-title (.. % -target -value))
        :on-key-down #(when (is-enter? (.-keyCode %))
                        (<cmd ctx :create-todo @new-title)
                        (reset! new-title ""))}])))

(def component
  (<comp :renderer form-2-render))

#+end_src
     
**** exempls
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/src/keechma_todomvc/components/new_todo.cljs")
*** other
(find-file-other-frame "./src/keechma_todomvc/components/new_todo.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/toggle_todos.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/todo_list.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/footer.cljs")

** src entities
*** entities/todo.cljs
:PROPERTIES:
:header-args: :tangle ./src/keechma_todomvc/entities/todo.cljs
:END:
**** file entities/todo.cljs
(find-file-other-frame "./src/keechma_todomvc/entities/todo.cljs")
**** src entities/todo.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.entities.todo
  "# Todo Entities"
  (:require [clojure.string :as str]
            [keechma-todomvc.edb :as edb])
  (:import [goog.ui IdGenerator]))

;; ## Helpers

(def id-generator (IdGenerator.))

(defn id
  "Returns a unique ID for a new todo."
  []
  (.getNextUniqueId id-generator))

(defn valid-title?
  "Returns `true` if `title` is a valid `todo` title."
  [title]
  (not (str/blank? title)))

;; ## Subscription Support (Read)

(defn todos-by-status
  "Returns all `todos` with a `status`."
  [app-db status]
  (let [todos (edb/get-collection app-db :todos :list)]
    (case status
      :completed (filter :completed todos)
      :active (filter (complement :completed) todos)
      :all todos)))

(defn edit-todo
  "Returns the `todo` currently being edited."
  [app-db]
  (->> (get-in app-db [:kv :editing-id])
       (edb/get-item-by-id app-db :todos)))

;; ## Action Support (Write)

;; ### Edit Management

(defn start-edit
  "Sets state: this `todo` is currently being edited."
  [app-db {:keys [id] :as todo}]
  (assoc-in app-db [:kv :editing-id] id))

(defn cancel-edit
  "Clears state: no `todo` is currently being edited."
  [app-db]
  (assoc-in app-db [:kv :editing-id] nil))

(defn confirm-edit
  "Updates `todo` if `new-todo` has a valid `title`."
  [app-db {:keys [id title] :as new-todo}]
  (assert id)
  (if (valid-title? title)
    (-> app-db
        (cancel-edit)
        (edb/insert-item :todos new-todo))
    app-db))

;; ### Create, Update, Delete Todos

(defn create-todos
  "Creates an empty `todos` list."
  [app-db]
  (edb/insert-collection app-db :todos :list []))

(defn create-todo
  "If `title` is valid, creates a new `todo` and inserts it at the
  beginning of the `todo` list."
  [app-db title]
  (if (valid-title? title)
    (let [todo {:id (str "todo" (id))
                :completed false
                :title title}]
      (edb/prepend-collection app-db :todos :list [todo]))
    app-db))

(defn update-todo
  "Merges new data into a `todo`. `patch-todo` must have an `:id`
  value that is the `id` of the `todo` to be updated."
  [app-db {:keys [id] :as patch-todo}]
  (assert id)
  (edb/insert-item app-db :todos patch-todo))

(defn update-todo-time
  "Updates the `:time` value on an existing todo item.
  This handler expects a map with the `:todo`, `:id` and new `:time` value.
  If the todo exists, a new todo map is created with the updated time
  and stored back in the EntityDB.
  Arguments:
  - app-db: The current application state atom
  - {:keys [id time todo]}: A map containing the todo ID and the new time (in seconds)
  Returns:
  - The updated `app-db` value
  Notes:
  - If `id` or `todo` is missing, the original `app-db` unchanged."
  [app-db {:keys [id time todo]}]
  (assert id)
  (assert todo)
  (let [updated-todo (assoc todo :time time)]
    (edb/insert-item app-db :todos updated-todo)))

(defn toggle-todo
  "Toggles the `:completed` status of a saved `todo`."
  [app-db todo]
  (update-todo app-db (update todo :completed not)))

(defn toggle-all
  "Marks all `todos` as completed or not based on `completed?`."
  [app-db completed?]
  (reduce (fn [acc todo]
            (update-todo acc (assoc todo :completed completed?)))
          app-db
          (todos-by-status app-db :all)))

(defn delete-todo
  "Removes a `todo` from the EntityDB."
  [app-db {:keys [id] :as todo}]
  (edb/remove-item app-db :todos id))

(defn delete-completed
  "Removes all completed `todos` from the EntityDB."
  [app-db]
  (reduce (fn [acc {:keys [id]}]
            (edb/remove-item acc :todos id))
          app-db
          (todos-by-status app-db :completed)))

;; ## Actions for keechma.controllers/dispatcher

(defn actions
  "Returns a mapping from `todo` topic `command` keywords to `action`
  functions. The mapping is suitable for use by
  `keechma.controller/dispatcher`.

  Adapts the calling convention from the one used by
  `keechma.controllers/dispatcher`:

  `(action-fn app-db-atom args-vec)`

  to one that is more natural for ClojureScript:

  `(handler app-db-atom arg1 arg2 arg3 ...)`.

  Combined with `<cmd` in `ui.cljs`, this allows natural-looking
  arguments in calls to `<cmd` to be handled by a handler with a
  natural looking argument vector in its definition. This insulates
  app developers from the restriction against varags in protocol
  functions that results in `keechma.ui-component/send-command`
  supporting only exactly 2 or 3 args, the last one an optional
  explicit vector of additional args.

  The adapter also provides the side-effect of updating the `app-db`
  with the result of each call, allowing the handlers to be written
  and tested as pure functions that return the new `app-db` value."
  []
  (let [cmd-handlers {:start-edit start-edit
                      :cancel-edit cancel-edit
                      :confirm-edit confirm-edit
                      :create-todo create-todo
                      :delete-todo delete-todo
                      :toggle-todo toggle-todo
                      :toggle-all toggle-all
                      :update-todo-time update-todo-time
                      :delete-completed delete-completed}
        action-adapter (fn [f]
                         (fn [app-db args]
                           (apply swap! app-db f args)))]
    (reduce-kv (fn [acc k f]
                 (assoc acc k (action-adapter f)))
               {}
               cmd-handlers)))

#+end_src
     
**** exempls
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/src/keechma_todomvc/entities/todo.cljs")
**** CANCELED archiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 01 update-todo-time
(defn update-todo-time
  [app-db {:keys [id time]}]
  ;; (assert id)
  ;; (let [todo (edb/get-item-by-id app-db :todos id)
  ;;       updated-todo (assoc todo :time time)]
  ;;   (edb/insert-item app-db :todos updated-todo))
  (println "test!!!!")
  app-db)

***** update-todo-time
(defn update-todo-time
  [app-db {:keys [id] :as patch-todo}]
  ;; (assert id)
  ;; (println patch-todo)
  ;; (println time)
  (println "test!")
  ;; —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å time –≤–Ω—É—Ç—Ä–∏ —Ç—É–¥—É
  ;; –∏ –Ω–æ–≤–µ—Ä–Ω–æ –≤—ã–∑–≤–∞—Ç—å update-todo
  )

** src resources
*** index.html
:PROPERTIES:
:header-args: :tangle ./resources/public/index.html
:END:
**** file
(find-file-other-frame "./resources/public/index.html")
**** src
#+begin_src html :no-expand t :mkdirp yes 
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Worder ‚Ä¢ Keechma</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link rel="icon" href="https://clojurescript.org/images/cljs-logo-icon-32.png">
  </head>
  <body>
    <div id="app"> 
    </div> <!-- end of app div -->
    <p>"js app loading..."</p>
    <script src="js/app.js" type="text/javascript"></script>
    <script>keechma_todomvc.app.main()</script>
  </body>
</html>
#+end_src
**** exampl
(find-file-other-frame "/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/group-chat/resources/public/index.html")
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/resources/public/index.html")

*** style.css
:PROPERTIES:
:header-args: :tangle ./resources/public/css/style.css
:END:
**** file style.css
(find-file-other-frame "./resources/public/css/style.css")
**** src style.css
***** all
#+begin_src css :no-expand t :mkdirp yes 
/* Source: https://github.com/tastejs/todomvc-app-css/blob/v2.1.0/index.css */
html,
body {
    margin: 0;
    padding: 0;
}

button {
    margin: 0;
    padding: 0;
    border: 0;
    background: none;
    font-size: 100%;
    vertical-align: baseline;
    font-family: inherit;
    font-weight: inherit;
    color: inherit;
    -webkit-appearance: none;
    appearance: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif;
    line-height: 1.4em;
    background: #f5f5f5;
    color: #4d4d4d;
    min-width: 230px;
    max-width: 550px;
    margin: 0 auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-weight: 300;
}

:focus {
    outline: 0;
}

.hidden {
    display: none;
}

.todoapp {
    background: #fff;
    margin: 130px 0 40px 0;
    position: relative;
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2),
                0 25px 50px 0 rgba(0, 0, 0, 0.1);
}

.todoapp input::-webkit-input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::-moz-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp h1 {
    position: absolute;
    top: -155px;
    width: 100%;
    font-size: 100px;
    font-weight: 100;
    text-align: center;
    color: rgba(175, 47, 47, 0.15);
    -webkit-text-rendering: optimizeLegibility;
    -moz-text-rendering: optimizeLegibility;
    text-rendering: optimizeLegibility;
}

.new-todo,
.edit {
    position: relative;
    margin: 0;
    width: 100%;
    font-size: 24px;
    font-family: inherit;
    font-weight: inherit;
    line-height: 1.4em;
    border: 0;
    color: inherit;
    padding: 6px;
    border: 1px solid #999;
    box-shadow: inset 0 -1px 5px 0 rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.new-todo {
    padding: 16px 16px 16px 60px;
    border: none;
    background: rgba(0, 0, 0, 0.003);
    box-shadow: inset 0 -2px 1px rgba(0,0,0,0.03);
}

.main {
    position: relative;
    z-index: 2;
    border-top: 1px solid #e6e6e6;
}

.toggle-all {
    text-align: center;
    border: none; /* Mobile Safari */
    opacity: 0;
    position: absolute;
}

.toggle-all + label {
    width: 60px;
    height: 34px;
    font-size: 0;
    position: absolute;
    top: -52px;
    left: -13px;
    -webkit-transform: rotate(90deg);
    transform: rotate(90deg);
}

.toggle-all + label:before {
    content: '‚ùØ';
    font-size: 22px;
    color: #e6e6e6;
    padding: 10px 27px 10px 27px;
}

.toggle-all:checked + label:before {
    color: #737373;
}

.todo-list {
    margin: 0;
    padding: 0;
    list-style: none;
}

.todo-list li {
    position: relative;
    font-size: 24px;
    border-bottom: 1px solid #ededed;
}

.todo-list li:last-child {
    border-bottom: none;
}

.todo-list li.editing {
    border-bottom: none;
    padding: 0;
}

.todo-list li.editing .edit {
    display: block;
    width: 506px;
    padding: 12px 16px;
    margin: 0 0 0 43px;
}

.todo-list li.editing .view {
    display: none;
}

.todo-list li .toggle {
    text-align: center;
    width: 40px;
    /* auto, since non-WebKit browsers doesn't support input styling */
    height: auto;
    position: absolute;
    top: 0;
    bottom: 0;
    margin: auto 0;
    border: none; /* Mobile Safari */
    -webkit-appearance: none;
    appearance: none;
}

.todo-list li .toggle {
    opacity: 0;
}

.todo-list li .toggle + label {
    /*
        Firefox requires `#` to be escaped - https://bugzilla.mozilla.org/show_bug.cgi?id=922433
        IE and Edge requires *everything* to be escaped to render, so we do that instead of just the `#` - https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7157459/
   ,*/
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23ededed%22%20stroke-width%3D%223%22/%3E%3C/svg%3E');
    background-repeat: no-repeat;
    background-position: center left;
}

.todo-list li .toggle:checked + label {
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23bddad5%22%20stroke-width%3D%223%22/%3E%3Cpath%20fill%3D%22%235dc2af%22%20d%3D%22M72%2025L42%2071%2027%2056l-4%204%2020%2020%2034-52z%22/%3E%3C/svg%3E');
}

.todo-list li label {
    word-break: break-all;
    padding: 15px 15px 15px 60px;
    display: block;
    line-height: 1.2;
    transition: color 0.4s;
}

.todo-list li.completed label {
    color: #d9d9d9;
    text-decoration: line-through;
}

.todo-list li .destroy {
    display: none;
    position: absolute;
    top: 0;
    right: 10px;
    bottom: 0;
    width: 40px;
    height: 40px;
    margin: auto 0;
    font-size: 30px;
    color: #cc9a9a;
    margin-bottom: 11px;
    transition: color 0.2s ease-out;
}

.todo-list li .destroy:hover {
    color: #af5b5e;
}

.todo-list li .destroy:after {
    content: '√ó';
}

.todo-list li:hover .destroy {
    display: block;
}

.todo-list li .edit {
    display: none;
}

.todo-list li.editing:last-child {
    margin-bottom: -1px;
}

.footer {
    color: #777;
    padding: 10px 15px;
    height: 20px;
    text-align: center;
    border-top: 1px solid #e6e6e6;
}

.footer:before {
    content: '';
    position: absolute;
    right: 0;
    bottom: 0;
    left: 0;
    height: 50px;
    overflow: hidden;
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2),
                0 8px 0 -3px #f6f6f6,
                0 9px 1px -3px rgba(0, 0, 0, 0.2),
                0 16px 0 -6px #f6f6f6,
                0 17px 2px -6px rgba(0, 0, 0, 0.2);
}

.todo-count {
    float: left;
    text-align: left;
}

.todo-count strong {
    font-weight: 300;
}

.filters {
    margin: 0;
    padding: 0;
    list-style: none;
    position: absolute;
    right: 0;
    left: 0;
}

.filters li {
    display: inline;
}

.filters li a {
    color: inherit;
    margin: 3px;
    padding: 3px 7px;
    text-decoration: none;
    border: 1px solid transparent;
    border-radius: 3px;
}

.filters li a:hover {
    border-color: rgba(175, 47, 47, 0.1);
}

.filters li a.selected {
    border-color: rgba(175, 47, 47, 0.2);
}

.clear-completed,
html .clear-completed:active {
    float: right;
    position: relative;
    line-height: 20px;
    text-decoration: none;
    cursor: pointer;
}

.clear-completed:hover {
    text-decoration: underline;
}

.info {
    margin: 65px auto 0;
    color: #bfbfbf;
    font-size: 10px;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
    text-align: center;
}

.info p {
    line-height: 1;
}

.info a {
    color: inherit;
    text-decoration: none;
    font-weight: 400;
}

.info a:hover {
    text-decoration: underline;
}

/*
    Hack to remove background from Mobile Safari.
    Can't use it globally since it destroys checkboxes in Firefox
,*/
@media screen and (-webkit-min-device-pixel-ratio:0) {
    .toggle-all,
    .todo-list li .toggle {
        background: none;
    }

    .todo-list li .toggle {
        height: 40px;
    }
}

@media (max-width: 430px) {
    .footer {
        height: 50px;
    }

    .filters {
        bottom: 10px;
    }
}
#+end_src
***** /* === Timer Component Styling Fit for WorderMVC === */
#+begin_src css :no-expand t :mkdirp yes 
.todo-list li .timer {
    display: inline-flex;
    align-items: center;
    margin-left: auto; 
}

.todo-list li .timer button {
    font-size: 13px;           
    padding: 7px 13px;         
    background: none;
    border: 2px solid #ccc;
    border-radius: 4px;
    cursor: pointer;
    color: #555;
    transition: all 0.2s ease-out;
}

.todo-list li .timer button:hover {
    background: #eee;
    border-color: #bbb;
    color: #333;
}

/* —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–≥–¥–∞ —Ç–∞–π–º–µ—Ä –∑–∞–ø—É—â–µ–Ω */
.todo-list li .timer.running button {
    background: #27ae60;
    border-color: #1e874b;
    color: #fff;
}

.todo-list li.completed .timer .seconds {
    color: #d9d9d9;
}

.todo-list li .timer .seconds {
    margin-left: 8px;
    font-size: 14px;
    color: #777;
}


#+end_src
***** /* === Export Panel Layout === */
#+begin_src css :no-expand t :mkdirp yes 
.export-panel {
    display: flex;
    justify-content: flex-start;
    gap: 8px;
    margin: 10px 0 15px 0;
    padding-left: 2px;
}

#+end_src
***** /* === Export Button (Keechma WorderMVC) === */
#+begin_src css :no-expand t :mkdirp yes 
.export-btn {
    float: right;
    margin-left: 8px;
    padding: 3px 10px;
    font-size: 12px;
    line-height: 20px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background: #fafafa;
    cursor: pointer;
    color: #555;
    transition: all 0.2s ease-in-out;
}

.export-btn:hover {
    background: #e6e6e6;
    border-color: #aaa;
    color: #333;
}

.export-btn:active {
    background: #d6d6d6;
    border-color: #888;
}

.footer .export-btn {
    position: relative;
    top: -2px;
}


#+end_src
**** –ò–ò
***** –¥–æ–≤–∞–π —Å–¥–µ–ª–∞–µ–º —Å—Ç–∏–ª—å
–¥–ª—è —ç—Ç–∏—Ö –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤.
**** exampl
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/example-todomvc/resources/public/css/style.css")
**** CANCELED arhiv
:PROPERTIES:
:header-args: :tangle no
:END:
***** 00 /* === Timer Component Styles === */
#+begin_src css :no-expand t :mkdirp yes 

.timer {
    margin: 15px auto;
    padding: 10px;
    text-align: center;
    font-size: 18px;
}

.timer button {
    background: #5dc2af;
    color: #fff;
    border-radius: 4px;
    padding: 6px 14px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s ease-out;
    border: none;
}

.timer button:hover {
    background: #54b2a0;
}

.timer button:active {
    background: #4aa492;
}

.timer .seconds {
    margin-left: 10px;
    font-weight: bold;
    color: #4d4d4d;
}

.timer.running .seconds {
    color: #5dc2af;
}
#+end_src
***** 00 /* === Timer Component Styling Fit for TodoMVC === */
#+begin_src css :no-expand t :mkdirp yes 
.todo-list li .timer {
    display: inline-flex;
    align-items: center;
    margin-left: 10px;
}

.todo-list li .timer button {
    font-size: 12px;
    padding: 3px 6px;
    background: none;
    border: 1px solid #ccc;
    border-radius: 3px;
    cursor: pointer;
    color: #777;
    transition: all 0.2s ease-out;
}

.todo-list li .timer button:hover {
    background: #eee;
    border-color: #bbb;
    color: #555;
}

.todo-list li .timer button:active {
    background: #ddd;
    border-color: #aaa;
    color: #333;
}

.todo-list li .timer .seconds {
    margin-left: 6px;
    font-size: 12px;
    color: #777;
}

.todo-list li.completed .timer .seconds {
    color: #d9d9d9;
}

#+end_src

***** 00 /* === Export Button (Keechma WorderMVC) === */
#+begin_src css :no-expand t :mkdirp yes 
.export-btn {
    float: right;
    margin-left: 8px;
    padding: 3px 10px;
    font-size: 12px;
    line-height: 20px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background: #fafafa;
    cursor: pointer;
    color: #555;
    transition: all 0.2s ease-in-out;
}

.export-btn:hover {
    background: #e6e6e6;
    border-color: #aaa;
    color: #333;
}

.export-btn:active {
    background: #d6d6d6;
    border-color: #888;
}

.footer .export-btn {
    position: relative;
    top: -2px;
}


#+end_src
* files worder
** files core
(find-file-other-frame "./project.clj")
(find-file-other-frame "./src/keechma_todomvc/app.cljs")
(find-file-other-frame "./src/keechma_todomvc/subscriptions.cljs")
(find-file-other-frame "./src/keechma_todomvc/ui.cljs")
(find-file-other-frame "./src/keechma_todomvc/util.cljs")
(find-file-other-frame "./src/keechma_todomvc/components.cljs")
(find-file-other-frame "./src/keechma_todomvc/edb.cljs")
(find-file-other-frame "./src/keechma_todomvc/edb.clj")
** files components
(find-file-other-frame "./src/keechma_todomvc/components/app.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/new_todo.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/toggle_todos.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/todo_list.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/todo_item.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/todo_edit.cljs")
(find-file-other-frame "./src/keechma_todomvc/components/footer.cljs")
** files controler
(find-file-other-frame "./src/keechma_todomvc/controllers/todos.cljs")
** files entities
(find-file-other-frame "./src/keechma_todomvc/entities/todo.cljs")
** files resurs
(find-file-other-frame "./resources/public/css/style.css")
(find-file-other-frame "./resources/public/index.html")
** files project
(find-file-other-frame "./project.clj")
(find-file-other-frame "./target/stale/leiningen.figwheel.clean-on-dependency-change")
* run worder
*** run
#+begin_src elisp :results output silent 
(evil-previous-line)
(org-cycle)
(delete-other-windows)
(let (buffer-name-to-close (buffer-name))
        (evil-window-split)
        (eshell)
        (evil-quit)
        (switch-to-buffer-other-frame buffer-name-to-close))
#+end_src

lein figwheel

:cljs/quit
:cljs/restart


cd worder
clojure -M:fig:build
clojure -M:fig:build dev

ls 
ls target public/js
ls .cpcache
rm -rf target public/js
rm -rf .cpcache

lein cljsbuild once

lein deps :refresh

*** build
:cljs/quit
–Ω–∞–¥–æ —É–¥–æ–ª–∏—Ç—å –≤—Ä—É—á–Ω—É—é
  resources/public/js/app.js
  –∏ —Ç–æ–≥–¥–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç –∫–æ–º–ø–ª–∏—Ü–∏—è –Ω–æ—Ä–º–∞–ª—å–Ω–æ
rm resources/public/js/app.js
lein do clean, cljsbuild once min

–î–æ–±–∞–≤—å :clean-targets –≤ project.clj, —á—Ç–æ–±—ã lein clean —É–¥–∞–ª—è–ª –≤–µ—Å—å js-–ø–∞–ø–∫—É:
:clean-targets ^{:protect false} ["resources/public/js" "target"]
(–≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ resources/public/js/app.js —É–¥–∞–ª–∏—Ç—Å—è –ø—Ä–∏ lein clean.)


lein clean

lein cljsbuild once min

  resources/public/js/app.js
  resources/public/js/min/

2. –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:
   python3 -m http.server -d resources/public
   –∏–ª–∏
   npx http-server resources/public

*** clon
git clone https://github.com/keechma/example-todomvc.git
*** publish
**** git
git remote add origin https://github.com/Buyn/worder.git
git branch -M main
git push -u origin main

https://buyn.github.io/

https://<username>.github.io/<repo-name>/.
https://buyn.github.io/worder.git
https://buyn.github.io/worder.git/.
**** orign
# Sample workflow for building and deploying a Jekyll site to GitHub Pages
name: Deploy Jekyll with GitHub Pages dependencies preinstalled

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        uses: actions/configure-pages@v5
      - name: Build with Jekyll
        uses: actions/jekyll-build-pages@v1
        with:
          source: ./
          destination: ./_site
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3

  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
**** static.yml

# Simple workflow for deploying static content to GitHub Pages
name: Deploy static content to Pages

on:
  # Runs on pushes targeting the default branch
  push:
    branches: ["main"]

  # Allows you to run this workflow manually from the Actions tab
  workflow_dispatch:

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Single deploy job since we're just deploying
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Setup Pages
        uses: actions/configure-pages@v5
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          # Upload entire repository
          path: '.'
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
**** workflows
worder/.github/workflows
.github/workflows/deploy.yml
**** name: Build and Deploy
name: Build and Deploy
on:
  push:
    branches:
      - main

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Clojure tools
        uses: DeLaGuardo/setup-clojure@v2
        with:
          deps: 'true'
          tools-deps: 'true'

      - name: Build ClojureScript
        run: |
          lein clean
          lein cljsbuild once min

      - name: Deploy to GitHub Pages
        uses: peaceiris/actions-gh-pages@v3
        with:
          github_token: ${{ secrets.GITHUB_TOKEN }}
          publish_dir: ./resources/public

* TODO todo worder
** DONE –æ—Ç–∫–ª—é—á–∏—Ç—å –¥–∞–±–ª –∫–ª–∏–∫.
** DONE –¥–∞–±–ª –∫–ª–∏–∫ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø–æ —Å—Ç–æ–ø.
** DONE —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–±–æ–≤–ª–µ—Ç "—Ç–∞–± - —Ç–∞–±"
–ø–æ—Å–ª–µ –Ω–∞—á–∞–ª—å–Ω–æ–≥–æ —Å–ª–æ–≤–∞. –∏ —Å—Ç–∞–≤–∏—Ç –∫—É—Ä—Å–æ—Ä –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ
** DONE —Å–¥–µ–ª–∞—Ç—å —Ç—Ö—Ç —Å–ª–æ–≤ —é–Ω–≥–∞.
/home/buyn/Desktop/words.txt
** —Å–¥–µ–ª–∞—Ç—å –∫–Ω–æ–ø–∫—É –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç–∞.
*** path
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/resources/public/txt/words-ung-ua.txt
*** src
**** file import_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/import_txt.cljs")
**** src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)
        onload-evt (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t))))))]
        (set! (.-onload reader) onload-evt)
        (println (.readAsText reader file))))

(defn render [ctx]
  (let [file-input (r/atom nil)]  
    (fn []
      [:div
        [:input {:type "file"
                :style {:display "none"}
                :ref #(reset! file-input %)
                :on-change #(import-file ctx %)}]
        [:button {:on-click #(.click @file-input)}
        "üìéImport from file"]])))

(def component
  (<comp :renderer render))
#+end_src
*** 
—Ö–æ—á—É –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ—Ç —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º.
–µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É. —Ç–æ –æ–Ω –µ–≥–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–æ –ø–µ—Ä–µ–¥–æ–Ω–æ–º—É –ø—É—Ç–∏.
–ø—Ä–∏—á—ë–º –≤–∞–∂–Ω–æ —á—Ç–æ–± –æ–Ω –º–æ–≥ –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ñ–∞–∏–ª —Å –ø–∞—Ä–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤.
/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/resources/public/txt/words-ung-ua.txt
–µ—Å–ª–∏ –∂–µ –≤—ã–∑–≤–∞–Ω–æ –±–µ–∑ —É–∫–∞–∑–∞–Ω–∏—è –ø—É—Ç–∏ —Ç–æ –æ–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–∫–Ω–æ –∑–∞–ø—Ä–æ—Å–∞.

** —Å–¥–µ–ª–∞—Ç—å –∞–≤—Ç–æ –∑–∞–≥—Ä—É–∑–∫—É –¥–µ—Ñ–∞–ª—Ç–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
** WAITING –ø–æ–º–æ—à—å —É–Ω–∏ —Å—Ç–∏–ª—å –ø—Ä–∏–∂–∞—Ç—å –∫–Ω–æ–ø—É –≤ –ø—Ä–∞–≤–æ

* REPL
:PROPERTIES:
:header-args: :tangle no :mkdirp yes :results output silent :no-expand t
:END:
** start
lein figwheel
clojure -M:fig:build
#+begin_src elisp :results output silent 
(evil-previous-line)
(org-cycle)
(delete-other-windows)
(let (buffer-name-to-close (buffer-name))
        (evil-window-split)
        (eshell)
        (evil-quit)
        (switch-to-buffer-other-frame buffer-name-to-close))
#+end_src
** commans
clojure -M:fig:build
:cljs/quit
:cljs/restart

clojure -M:fig:clean
clojure -M:fig:build
* backlog worder
** —Å–º–µ–Ω–∏—Ç—å —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É
–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫—É—é –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å —á—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –ø–æ–ª—É—á–∏—Ç—Å—è
** –∏—Å–ø—Ä–∞–≤–∏—Ç—å –¥–∞–±–ª –∫–ª–∏–∫
** —Å—Ç–∞—Ä—Ç —Ç–∞–π–º–µ—Ä–∞ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Å—Ç–æ–ª—å–Ω—ã–µ
—Ç–∞–π–º–µ—Ä—ã
—Ç–∞–∫ —á—Ç–æ–± –≤—Å–µ–≥–¥–∞ –±—ã–ª–æ –Ω–µ –±–æ–ª–µ–µ –æ–¥–Ω–æ–≥–æ —Ç–∞–π–º–µ—Ä–∞
** –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–¥ —Å–ª–æ–≤–∞ –≤ –∏–Ω—Ç–µ—Ä–≤–µ–π—Å–µ
–¥–æ–±–æ–≤–ª–µ–º —Å–ª–æ–≤–∞ –≤–º–µ—Å—Ç–æ —Ç—É–¥—É
–≤–∏–¥–µ–º–æ –≤–æ—Ä–¥–µ—Ä
** —Ç—É–¥—É –∏—Ç–µ–º –∫–æ–º–ø–ª–∏—Ç –¥–µ–ª–∞–µ—Ç –Ω–µ–≤–æ–∑–º–æ–∂–Ω—ã –∑–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä
** –ê–≤—Ç–æ-—Å—Ç–æ–ø, –µ—Å–ª–∏ todo –ø–æ–º–µ—á–µ–Ω completed
| –ê–≤—Ç–æ-—Å—Ç–æ–ø, –µ—Å–ª–∏ todo –ø–æ–º–µ—á–µ–Ω completed        | –õ–æ–≥–∏—á–Ω–æ–µ UX-–ø–æ–≤–µ–¥–µ–Ω–∏–µ 
** –ø–æ–Ω—è—Ç—å –º–æ–∂–Ω–æ –ª–∏ –æ–ø—Ç–µ–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∞—Ç–æ–º—ã
—á—Ç–æ–± –ø–æ –æ—Å—Ç–∞–Ω–æ–≤–∫—É —Ç–∞–π–º–µ—Ä–∞ –æ—Å–≤–æ–±–æ–∂–¥–∞–ª–∏—Å—å –Ω–µ –Ω—É–∂–Ω—ã–µ –∞—Ç–æ–º—ã
–æ–Ω–∏ –Ω—É–∂–Ω—ã —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Ç–∞–π–º–µ—Ä–∞
** —Ç—É–¥—É –∏—Ç–µ–º –∫–æ–º–ø–ª–∏—Ç –¥–µ–ª–∞–µ—Ç –∫–Ω–æ–ø–∫—É —Å–µ—Ä–æ–π
** —Ç—É–¥—É –∏—Ç–µ–º –∫–æ–º–ø–ª–∏—Ç –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ç–∞–π–º–µ—Ä
–µ—Å–ª–∏ –æ–Ω –∑–∞–ø—É—â–µ–Ω –≤ —ç—Ç–æ—Ç –º–æ–º–µ–Ω—Ç
** —É–±–µ–¥–∏—Ç—Å—è —á—Ç–æ —É–¥–∞–µ–Ω–∏–µ –æ—Å—Ç–∞–Ω–≤–∞–ª–∏–≤–∞–µ—Ç —Ç–∞–π–º–µ—Ä

–ï—â—ë: —á–∏—Å—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

–î–æ–±–∞–≤—å "cleanup" —á—Ç–æ–±—ã –Ω–µ –æ—Å—Ç–∞–≤–ª—è—Ç—å setInterval –≤–∏—Å–µ—Ç—å, –µ—Å–ª–∏ todo —É–¥–∞–ª—è–µ—Ç—Å—è / –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è:

–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—à—å form-2, –º–æ–∂–Ω–æ –≤ reagent/create-class (form-3) —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å :component-will-unmount –∏ —Ç–∞–º js/clearInterval. –ò–ª–∏ –≤ form-2 ‚Äî –≤–µ—Ä–Ω—É—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ—á–∏—Å—Ç–∫–∏ —á–µ—Ä–µ–∑ reagent.core/create-class ‚Äî –Ω–æ –ø—Ä–æ—â–µ: –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ –∏–ª–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ —è–≤–Ω–æ —á–∏—Å—Ç–∏ @timer-id.
** –ø–µ—Ä–µ–ø–∏—Å–∞—Ç—å —Ç–µ–∫—Å—Ç –ø–æ–¥ —Å–ª–æ–≤–∞ –≤ –∫–æ–¥–µ
–ø–æ–≤–æ–∑–º–æ–∂–Ω–æ –≤–µ–∑–¥–µ –ø–æ –∫–æ–¥—É
** –ø–µ—Ä–µ–¥–∞—Ç—å –≤–∞–ª–µ
* project comands
:PROPERTIES:
:header-args: :tangle no
:END:
** –ø–æ–∏—Å–∫ –ø–æ –ø—Ä–æ–µ–∫—Ç—É
*** 
**** dropbox in org
#+begin_src sh  
grep --include=\*.cljs -rnw ./ -e ":todos-by-status"
#+end_src       

#+RESULTS:
| ./src/keechma_todomvc/components/todo_list.cljs:18:-                     | `:todos-by-status` | returns           | `todos`         | with  | a   | `status`         |                    |
| ./src/keechma_todomvc/components/todo_list.cljs:26:                      | (doall             | (map              | todo-item       | (sub> | ctx | :todos-by-status | route-status)))])) |
| ./src/keechma_todomvc/components/todo_list.cljs:31:                      | :subscription-deps | [:todos-by-status |                 |       |     |                  |                    |
| ./src/keechma_todomvc/subscriptions.cljs:48:(def                         | subscriptions      | {:todos-by-status | todos-by-status |       |     |                  |                    |
| ./resources/public/js/dev/keechma_todomvc/components/todo_list.cljs:18:- | `:todos-by-status` | returns           | `todos`         | with  | a   | `status`         |                    |
| ./resources/public/js/dev/keechma_todomvc/components/todo_list.cljs:26:  | (doall             | (map              | todo-item       | (sub> | ctx | :todos-by-status | route-status)))])) |
| ./resources/public/js/dev/keechma_todomvc/components/todo_list.cljs:31:  | :subscription-deps | [:todos-by-status |                 |       |     |                  |                    |
| ./resources/public/js/dev/keechma_todomvc/subscriptions.cljs:48:(def     | subscriptions      | {:todos-by-status | todos-by-status |       |     |                  |                    |


**** dropbox in org
#+begin_src sh  
grep --include=\*.cljs -rnw ./ -e "reagent.core"
#+end_src       

#+RESULTS:
| ./src/keechma_todomvc/components/new_todo.cljs:5:                          | [reagent.core    | :as             | reagent])) |         |        |           |
| ./target/public/cljs-out/dev/reagent/core.cljs:1:(ns                       | reagent.core     |                 |            |         |        |           |
| ./target/public/cljs-out/dev/reagent/core.cljs:2:                          | (:require-macros | [reagent.core]) |            |         |        |           |
| ./target/public/cljs-out/dev/keechma_todomvc/components/new_todo.cljs:5:   | [reagent.core    | :as             | reagent])) |         |        |           |
| ./target/public/cljs-out/dev/keechma_todomvc/components/todo_edit.cljs:5:  | [reagent.core    | :as             | reagent])) |         |        |           |
| ./target/public/cljs-out/dev/keechma/app_state/react_native_router.cljs:3: | [reagent.core    | :as             | r]         |         |        |           |
| ./target/public/cljs-out/dev/keechma/app_state.cljs:2:                     | (:require        | [reagent.core   | :as        | reagent | :refer | [cursor]] |


** files other
find "$PWD" -type f >>filepath.txt

(find-file-other-frame "./README.md")
(find-file-other-frame "./figwheel_server.log")
** repl
*** run eshell in project root
clojure -M:fig:build
:cljs/quit
:cljs/restart

clj -M:dev
clojure -m cljs.main --compile my-cljs-project.core --repl


clojure -P
clojure -M:fig:clean
clojure -M:fig:build

#+begin_src elisp :results output silent :dir ./notes/
(evil-previous-line)
(org-cycle)
(delete-other-windows)
(let (buffer-name-to-close (buffer-name))
        (evil-window-split)
        (eshell)
        (evil-quit)
        (switch-to-buffer-other-frame buffer-name-to-close))
#+end_src

      ;; (execute-kbd-macro "A \C-m")
*** run eshell in org root
clj -M:dev
clojure -m cljs.main --compile my-cljs-project.core --repl
#+begin_src elisp :results output silent
(evil-previous-line)
(org-cycle)
(delete-other-windows)
(let (buffer-name-to-close (buffer-name))
        (evil-window-split)
        (eshell)
        (evil-quit)
        (switch-to-buffer-other-frame buffer-name-to-close))
#+end_src

      ;; (execute-kbd-macro "A \C-m")
*** run repl
clj -M:dev
clojure -m cljs.main --compile my-cljs-project.core --repl

clojure -M:fig:build
:cljs/quit
:cljs/restart
#+begin_src eshell
clj -m cljs.main --compile my-cljs-project.core --repl


#+end_src

#+RESULTS:
*** repl commands
:cljs/quit
*** repl test
(js/alert "Am I connected?")
** new project
clj -X:new :template figwheel-main :name learn-cljs/notes :args '["+deps" "--reagent"]'

{:deps {org.clojure/clojure {:mvn/version "1.10.0"}
        org.clojure/clojurescript {:mvn/version "1.10.773"}
        reagent/reagent {:mvn/version "1.0.0"}
        funcool/bide {:mvn/version "1.6.0"}
        camel-snake-kebab/camel-snake-kebab {:mvn/version "0.4.2"}}

$ clj -X:new :template figwheel-main :name learn-cljs/weather :args 
[[file:~/Dropbox/orgs/org-Brain/ClojureScript Idioms.org::*2025-09-04T11:12:30+03:00][2025-09-04T11:12:30+03:00]]
** cider
If you have a Clojure project in your file system and want CIDER to launch an nREPL session for it, simply visit a file that belongs to the project, and type M-x cider-jack-in RET.[1] CIDER will start an nREPL server and automatically connect to it.
  In Clojure(Script) buffers the command cider-jack-in is bound to C-c C-x (C-)j (C-)j. 

** console
*** run console in org root
clj -M:dev
clojure -m cljs.main --compile my-cljs-project.core --repl
#+begin_src elisp :results output silent
(buyn-shell-start "konsole")
(evil-previous-line)
(org-cycle)
(delete-other-windows)
#+end_src

*** run console with command
#+begin_src elisp :results output silent
(buyn-shell-start "konsole -e /bin/bash --rcfile <(clj -M:dev)")
(evil-previous-line)
(org-cycle)
(delete-other-windows)
#+end_src

** auto-tangle-block:
#+NAME: auto-tangle-block
#+begin_src emacs-lisp :results output silent :tangle no
(setq org-src-preserve-indentation t)
(untabify (point-min) (point-max))
(save-buffer)
;; (universal-argument)
;; (universal-argument)
(org-babel-tangle)
(evil-close-fold)
(evil-close-fold)
;; (find-file-other-frame "reagent-test/src/learn_cljs/reagent_test.cljs")
;; (find-file-other-frame "~/INI/hydra-cfg.el")
;; (load "~/INI/hydra-cfg.el")
;; (load "~/ELs/BuYn/reader.el")
 #+end_src
* DONE Done worder
** DONE —Å–¥–µ–ª–∞—Ç—å —Å—Ç–∏–ª—å –ø–æ–¥ —Ç—É–¥—É –∏—Ç–µ–º—Å
*** 1
–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Å —Ç–∞–π—Ç–ª–æ–º –∏ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Ç—É–¥—É
*** src
**** file components/todo_item.cljs
(find-file-other-frame "./src/keechma_todomvc/components/todo_item.cljs")
**** src components/todo_item.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.todo-item
  "# Todo Item component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp comp>]]))

(defn render
  [ctx todo is-editing?]
  [:li {:class [(when is-editing? :editing)
                (when (:completed todo) :completed)]}
   [:div.view {:on-double-click #(<cmd ctx :start-edit todo)}
    [:input.toggle {:type :checkbox
                    :checked (:completed todo)
                    :on-change #(<cmd ctx :toggle-todo todo)}]
    [:label (:title todo)]
    [comp> ctx :timer-button]
    [:button.destroy {:on-click #(<cmd ctx :delete-todo todo)}]]
   (when is-editing?
     [comp> ctx :todo-edit])])

(def component
  (<comp :renderer render
         :component-deps [:todo-edit
                          :timer-button]))

#+end_src
     
**** file timer_button.cljs
(find-file-other-frame "./src/keechma_todomvc/components/timer_button.cljs")
**** src timer_button.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)
        timer-id (r/atom nil)
        start-ms (r/atom nil)
        counter (fn [] (reset! seconds (/ (- (.now js/Date) @start-ms) 1000)))
        stop! (fn []
                (counter)
                (js/clearInterval @timer-id)
                (reset! timer-id nil)
                (reset! start-ms nil))
        start! (fn []
                  (reset! start-ms (.now js/Date))
                  (reset! timer-id (js/setInterval counter 100)))
        toggle! (fn [_] (if @timer-id (stop!) (start!)))]  
    (fn []
      [:div.timer
       [:button
        {:on-click toggle!} 
        (if @timer-id "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
**** file style.css
(find-file-other-frame "./resources/public/css/style.css")
**** src style.css
***** all
#+begin_src css :no-expand t :mkdirp yes 
/* Source: https://github.com/tastejs/todomvc-app-css/blob/v2.1.0/index.css */
html,
body {
    margin: 0;
    padding: 0;
}

button {
    margin: 0;
    padding: 0;
    border: 0;
    background: none;
    font-size: 100%;
    vertical-align: baseline;
    font-family: inherit;
    font-weight: inherit;
    color: inherit;
    -webkit-appearance: none;
    appearance: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif;
    line-height: 1.4em;
    background: #f5f5f5;
    color: #4d4d4d;
    min-width: 230px;
    max-width: 550px;
    margin: 0 auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-weight: 300;
}

:focus {
    outline: 0;
}

.hidden {
    display: none;
}

.todoapp {
    background: #fff;
    margin: 130px 0 40px 0;
    position: relative;
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2),
                0 25px 50px 0 rgba(0, 0, 0, 0.1);
}

.todoapp input::-webkit-input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::-moz-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp h1 {
    position: absolute;
    top: -155px;
    width: 100%;
    font-size: 100px;
    font-weight: 100;
    text-align: center;
    color: rgba(175, 47, 47, 0.15);
    -webkit-text-rendering: optimizeLegibility;
    -moz-text-rendering: optimizeLegibility;
    text-rendering: optimizeLegibility;
}

.new-todo,
.edit {
    position: relative;
    margin: 0;
    width: 100%;
    font-size: 24px;
    font-family: inherit;
    font-weight: inherit;
    line-height: 1.4em;
    border: 0;
    color: inherit;
    padding: 6px;
    border: 1px solid #999;
    box-shadow: inset 0 -1px 5px 0 rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.new-todo {
    padding: 16px 16px 16px 60px;
    border: none;
    background: rgba(0, 0, 0, 0.003);
    box-shadow: inset 0 -2px 1px rgba(0,0,0,0.03);
}

.main {
    position: relative;
    z-index: 2;
    border-top: 1px solid #e6e6e6;
}

.toggle-all {
    text-align: center;
    border: none; /* Mobile Safari */
    opacity: 0;
    position: absolute;
}

.toggle-all + label {
    width: 60px;
    height: 34px;
    font-size: 0;
    position: absolute;
    top: -52px;
    left: -13px;
    -webkit-transform: rotate(90deg);
    transform: rotate(90deg);
}

.toggle-all + label:before {
    content: '‚ùØ';
    font-size: 22px;
    color: #e6e6e6;
    padding: 10px 27px 10px 27px;
}

.toggle-all:checked + label:before {
    color: #737373;
}

.todo-list {
    margin: 0;
    padding: 0;
    list-style: none;
}

.todo-list li {
    position: relative;
    font-size: 24px;
    border-bottom: 1px solid #ededed;
}

.todo-list li:last-child {
    border-bottom: none;
}

.todo-list li.editing {
    border-bottom: none;
    padding: 0;
}

.todo-list li.editing .edit {
    display: block;
    width: 506px;
    padding: 12px 16px;
    margin: 0 0 0 43px;
}

.todo-list li.editing .view {
    display: none;
}

.todo-list li .toggle {
    text-align: center;
    width: 40px;
    /* auto, since non-WebKit browsers doesn't support input styling */
    height: auto;
    position: absolute;
    top: 0;
    bottom: 0;
    margin: auto 0;
    border: none; /* Mobile Safari */
    -webkit-appearance: none;
    appearance: none;
}

.todo-list li .toggle {
    opacity: 0;
}

.todo-list li .toggle + label {
    /*
        Firefox requires `#` to be escaped - https://bugzilla.mozilla.org/show_bug.cgi?id=922433
        IE and Edge requires *everything* to be escaped to render, so we do that instead of just the `#` - https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7157459/
   */
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23ededed%22%20stroke-width%3D%223%22/%3E%3C/svg%3E');
    background-repeat: no-repeat;
    background-position: center left;
}

.todo-list li .toggle:checked + label {
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23bddad5%22%20stroke-width%3D%223%22/%3E%3Cpath%20fill%3D%22%235dc2af%22%20d%3D%22M72%2025L42%2071%2027%2056l-4%204%2020%2020%2034-52z%22/%3E%3C/svg%3E');
}

.todo-list li label {
    word-break: break-all;
    padding: 15px 15px 15px 60px;
    display: block;
    line-height: 1.2;
    transition: color 0.4s;
}

.todo-list li.completed label {
    color: #d9d9d9;
    text-decoration: line-through;
}

.todo-list li .destroy {
    display: none;
    position: absolute;
    top: 0;
    right: 10px;
    bottom: 0;
    width: 40px;
    height: 40px;
    margin: auto 0;
    font-size: 30px;
    color: #cc9a9a;
    margin-bottom: 11px;
    transition: color 0.2s ease-out;
}

.todo-list li .destroy:hover {
    color: #af5b5e;
}

.todo-list li .destroy:after {
    content: '√ó';
}

.todo-list li:hover .destroy {
    display: block;
}

.todo-list li .edit {
    display: none;
}

.todo-list li.editing:last-child {
    margin-bottom: -1px;
}

.footer {
    color: #777;
    padding: 10px 15px;
    height: 20px;
    text-align: center;
    border-top: 1px solid #e6e6e6;
}

.footer:before {
    content: '';
    position: absolute;
    right: 0;
    bottom: 0;
    left: 0;
    height: 50px;
    overflow: hidden;
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2),
                0 8px 0 -3px #f6f6f6,
                0 9px 1px -3px rgba(0, 0, 0, 0.2),
                0 16px 0 -6px #f6f6f6,
                0 17px 2px -6px rgba(0, 0, 0, 0.2);
}

.todo-count {
    float: left;
    text-align: left;
}

.todo-count strong {
    font-weight: 300;
}

.filters {
    margin: 0;
    padding: 0;
    list-style: none;
    position: absolute;
    right: 0;
    left: 0;
}

.filters li {
    display: inline;
}

.filters li a {
    color: inherit;
    margin: 3px;
    padding: 3px 7px;
    text-decoration: none;
    border: 1px solid transparent;
    border-radius: 3px;
}

.filters li a:hover {
    border-color: rgba(175, 47, 47, 0.1);
}

.filters li a.selected {
    border-color: rgba(175, 47, 47, 0.2);
}

.clear-completed,
html .clear-completed:active {
    float: right;
    position: relative;
    line-height: 20px;
    text-decoration: none;
    cursor: pointer;
}

.clear-completed:hover {
    text-decoration: underline;
}

.info {
    margin: 65px auto 0;
    color: #bfbfbf;
    font-size: 10px;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
    text-align: center;
}

.info p {
    line-height: 1;
}

.info a {
    color: inherit;
    text-decoration: none;
    font-weight: 400;
}

.info a:hover {
    text-decoration: underline;
}

/*
    Hack to remove background from Mobile Safari.
    Can't use it globally since it destroys checkboxes in Firefox
*/
@media screen and (-webkit-min-device-pixel-ratio:0) {
    .toggle-all,
    .todo-list li .toggle {
        background: none;
    }

    .todo-list li .toggle {
        height: 40px;
    }
}

@media (max-width: 430px) {
    .footer {
        height: 50px;
    }

    .filters {
        bottom: 10px;
    }
}
#+end_src
***** /* === Timer Component Styles === */
#+begin_src css :no-expand t :mkdirp yes 

.timer {
    margin: 15px auto;
    padding: 10px;
    text-align: center;
    font-size: 18px;
}

.timer button {
    background: #5dc2af;
    color: #fff;
    border-radius: 4px;
    padding: 6px 14px;
    font-size: 14px;
    cursor: pointer;
    transition: background 0.2s ease-out;
    border: none;
}

.timer button:hover {
    background: #54b2a0;
}

.timer button:active {
    background: #4aa492;
}

.timer .seconds {
    margin-left: 10px;
    font-weight: bold;
    color: #4d4d4d;
}

.timer.running .seconds {
    color: #5dc2af;
}
#+end_src

*** –¥–æ–≤–∞–π –∏–∑–º–µ–Ω–∏–º —Å—Ç–∏–ª—å –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ button timer
—á—Ç–æ–± –æ–Ω –±–æ–ª—å—à–µ –æ—Ç—Ä–∞–∂–∞–ª —Å—Ç–∏–ª—å —Ç—É–¥—É –∏–º–æ–≤ —á–∞—Å—Ç—å –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω —è–≤–ª–µ—Ç—Å—è
–æ–Ω–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É —Å —Ç–∞–π—Ç–ª–æ–º –∏ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è —Ç—É–¥—É
** DONE –¥–æ–±–∞–≤–∏—Ç—å —Ü–µ—Ç –ø—Ä–∏ –∞–∫—Ç–∏–≤–∞—Ü–∏
[:div.timer {:class (when running? "running")}
 [:button {:on-click toggle!} (if running? "‚ñ†" "‚ñ∂")}
 [:span.seconds @seconds]]

** DONE –¥–æ–±–∞–≤–∏—Ç—å —Å–æ—Ö—Ä–∞–Ω–∏–µ –ø–µ—Ä–º–µ–Ω–Ω–æ–π –≤ —Ç—É–¥—É
*** 1
—Ç–æ–µ—Å—Ç—å –≤ –≥–ª–∞–≤–Ω—É—é –ø–µ—Ä–º–µ–Ω–Ω—É—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∫–∞–∫ —Å–≤–æ–π—Å—Ç–≤–æ –∫–∞–∂–¥–æ–≥–æ —Ç—É–¥—É
üíæ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ edb (–ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ todo-id)
*** src
**** file timer_button.cljs
(find-file-other-frame "./src/keechma_todomvc/components/timer_button.cljs")
**** src timer_button.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [reagent.core :as r]))

(defn render [_ctx]
  (let [seconds (r/atom 0)
        timer-id (r/atom nil)
        start-ms (r/atom nil)
        running? (fn [](not (= @timer-id nil)))
        counter (fn [] (reset! seconds (/ (- (.now js/Date) @start-ms) 1000)))
        stop! (fn []
                (counter)
                (js/clearInterval @timer-id)
                (reset! timer-id nil)
                (reset! start-ms nil))
        start! (fn []
                  (reset! start-ms (.now js/Date))
                  (reset! timer-id (js/setInterval counter 100)))
        toggle! (fn [_] (if (running?) (stop!) (start!)))]  
    (fn []
      [:div.timer {:class (when (running?) "running")}
       [:button
        {:on-click toggle!} 
        (if (running?) "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str @seconds " sec")]])))

(def component
  (<comp :renderer render))
#+end_src
*** –¥–∞ –¥–æ–≤–∞–π –¥–æ–±–∞–≤–∏–º
—á—Ç–æ–± –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ stop!
–ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–∫—É–Ω–¥ –≤ edb (–ø—Ä–∏–≤—è–∑–∞—Ç—å –∫ todo-id)
*** –ò–ò
–û—Ç–ª–∏—á–Ω–æ ‚Äî –¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º —ç—Ç–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏ ¬´–ø–æ-–∫–µ—á—á–º–æ–≤—Å–∫–∏¬ª ‚úÖ
–ï—Å–ª–∏ —Ö–æ—Ç–∏–º **—Å–æ—Ö—Ä–∞–Ω—è—Ç—å –∏—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è –≤ EDB**, –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –Ω–∞–¥–æ –∑–Ω–∞—Ç—å **todo-id** –∏ –≤—ã–∑—ã–≤–∞—Ç—å **cmd**.

---

## ‚úÖ –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å:

1Ô∏è‚É£ –í —Ä–µ–Ω–¥–µ—Ä –ø–µ—Ä–µ–¥–∞—Ç—å `todo` (–º–∏–Ω–∏–º—É–º `id`)
2Ô∏è‚É£ –ù–∞ `stop!` –≤—ã–∑–≤–∞—Ç—å `( <cmd ctx :save-timer-time {:id id :seconds @seconds} )`
3Ô∏è‚É£ –í `controllers/todos.cljs` –¥–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —ç—Ç–æ–≥–æ `:save-timer-time`
4Ô∏è‚É£ –í `entitydb` —Ö—Ä–∞–Ω–∏—Ç—å –Ω–æ–≤–æ–µ –ø–æ–ª–µ, –Ω–∞–ø—Ä–∏–º–µ—Ä `:timer-sec`

---

## ‚úÖ –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: timer_button.cljs

> ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–µ–ø–µ—Ä—å –æ–∂–∏–¥–∞–µ—Ç todo –∫–∞–∫ –≤—Ç–æ—Ä–æ–π –∞—Ä–≥—É–º–µ–Ω—Ç

```clojure
(ns keechma-todomvc.components.timer-button
  (:require [keechma-todomvc.ui :refer [<comp <cmd sub>]]
            [reagent.core :as r]))

(defn render [ctx todo]
  (let [id (:id todo)
        seconds (r/atom 0)
        timer-id (r/atom nil)
        start-ms (r/atom nil)

        running? #(some? @timer-id)

        counter #(reset! seconds (/ (- (.now js/Date) @start-ms) 1000))

        save! #(when id
                 (<cmd ctx :save-timer-time {:id id
                                             :timer-sec @seconds}))

        stop! (fn []
                (counter)
                (js/clearInterval @timer-id)
                (reset! timer-id nil)
                (reset! start-ms nil)
                (save!))

        start! #(do (reset! start-ms (.now js/Date))
                    (reset! timer-id (js/setInterval counter 100)))

        toggle! (fn [_]
                  (if (running?) (stop!) (start!)))]

    (fn [_ctx _todo] ;; <- rerender fn
      [:div.timer {:class (when (running?) "running")}
       [:button {:on-click toggle!}
        (if (running?) "‚ñ† Stop" "‚ñ∂ Start")]
       [:span.seconds (str (int @seconds) " sec")]])))

(def component
  (<comp :renderer render
         :subscription-deps []))
```

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä: —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ edb

–í `keechma-todomvc.controllers.todos` –¥–æ–±–∞–≤–ª—è–µ–º:

```clojure
(defmethod cmd :save-timer-time
  [_ _ {:keys [id timer-sec] :as payload}]
  (fn [app-db]
    (if id
      (edb/insert-item app-db :todos (assoc payload :id id))
      app-db)))
```

> üîπ –ú—ã –æ–±–Ω–æ–≤–ª—è–µ–º item todo –≤ EDB, –¥–æ–±–∞–≤–ª—è—è –ø–æ–ª–µ `:timer-sec`
> üîπ –ú–æ–∂–Ω–æ –ø–æ—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤ UI

---

## ‚úÖ –ü–µ—Ä–µ–¥–∞—á–∞ timer button –≤ todo-item

–í `todo_item.cljs` –∏–∑–º–µ–Ω—è–µ–º:

```clojure
[:label (:title todo)]
[comp> ctx :timer-button todo]
```

–í–∞–∂–Ω–æ: –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É –Ω—É–∂–Ω–æ **–∑–Ω–∞—Ç—å `todo-id`**, –∏–Ω–∞—á–µ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ—á–µ–≥–æ.

---

## ‚úÖ –î–æ–ø. —É–ª—É—á—à–µ–Ω–∏—è, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å:

| –û–ø—Ü–∏—è                                         | –≠—Ñ—Ñ–µ–∫—Ç                |
| --------------------------------------------- | --------------------- |
| –ê–≤—Ç–æ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ | –¢–∞–π–º–µ—Ä –ø–æ–º–Ω–∏—Ç –∏—Å—Ç–æ—Ä–∏—é |
| –ê–≤—Ç–æ-—Å—Ç–æ–ø, –µ—Å–ª–∏ todo –ø–æ–º–µ—á–µ–Ω completed        | –õ–æ–≥–∏—á–Ω–æ–µ UX-–ø–æ–≤–µ–¥–µ–Ω–∏–µ |
| –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —Ç–∞–π–º–µ—Ä–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ                  | –ê–Ω–∏–º–∞—Ü–∏—è              |
| –û—Ç–ø—Ä–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ backend                    | –ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–∏     |

---

–ï—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å ‚Äî —Å–¥–µ–ª–∞–µ–º:

‚úÖ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–µ—Å–ª–∏ —Ç–∞–π–º–µ—Ä —É–∂–µ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª—Å—è)
‚úÖ –æ–±–Ω—É–ª–µ–Ω–∏–µ –ø—Ä–∏ `cancel-edit` –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–∏ todo
‚úÖ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é —Å–ø–∏—Å–∫–∞ –ø–æ —Ç–∞–π–º–µ—Ä—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, longest todo first)

---

### –•–æ—á–µ—à—å next step?

–°–¥–µ–ª–∞–µ–º —Ç–∞–∫, —á—Ç–æ–±—ã:

‚úî –ü—Ä–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–µ —Ç–∞–π–º–µ—Ä–∞ –æ–Ω **–ø—Ä–æ–¥–æ–ª–∂–∞–ª**, –∞ –Ω–µ —Å–±—Ä–∞—Å—ã–≤–∞–ª –≤—Ä–µ–º—è
‚úî –ó–Ω–∞—á–µ–Ω–∏–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–æ—Å—å **–∫–∞–∂–¥—ã–µ N —Å–µ–∫—É–Ω–¥** –∞–≤—Ç–æ–º–∞—Ç–æ–º
‚úî –ü—Ä–∏ navigate/refresh –≤—Ä–µ–º—è **–≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª–æ—Å—å**

---

–•–æ—á–µ—à—å —Ç–∞–π–º–µ—Ä –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ **–º–∏–Ω–∏-POMODORO** –≤ TodoMVC? ‚è±üî•
*** :on-change #(<cmd ctx :toggle-todo todo)}]
*** src
**** file components.cljs
(find-file-other-frame "./src/keechma_todomvc/components.cljs")
**** src components.cljs
#+begin_src clojure :no-expand t :mkdirp yes
(ns keechma-todomvc.components
  "# Todo UI Component system"
  (:require [keechma-todomvc.components.app :as app]
            [keechma-todomvc.components.footer :as footer]
            [keechma-todomvc.components.new-todo :as new-todo]
            [keechma-todomvc.components.todo-edit :as todo-edit]
            [keechma-todomvc.components.timer-button :as timer-button]
            [keechma-todomvc.components.todo-item :as todo-item]
            [keechma-todomvc.components.todo-list :as todo-list]
            [keechma-todomvc.components.toggle-todos :as toggle-todos]))

(def system
  "Defines the component `system`. All the components that send commands
  are configured to send them to the `:todos` topic controller."
  {:main app/component
   :footer (assoc footer/component :topic :todos)
   :new-todo (assoc new-todo/component :topic :todos)
   :todo-edit (assoc todo-edit/component :topic :todos)
   :todo-item (assoc todo-item/component :topic :todos)
   :timer-button (assoc timer-button/component :topic :todos)
   :todo-list todo-list/component
   :toggle-todos (assoc toggle-todos/component :topic :todos)})


#+end_src
**** file components/todo_item.cljs
(find-file-other-frame "./src/keechma_todomvc/components/todo_item.cljs")
**** src components/todo_item.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.todo-item
  "# Todo Item component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp comp>]]))

(defn render
  [ctx todo is-editing?]
  [:li {:class [(when is-editing? :editing)
                (when (:completed todo) :completed)]}
   [:div.view {:on-double-click #(<cmd ctx :start-edit todo)}
    [:input.toggle {:type :checkbox
                    :checked (:completed todo)
                    :on-change #(<cmd ctx :toggle-todo todo)}]
    [:label (:title todo)
      [comp> ctx :timer-button todo]]
    [:button.destroy {:on-click #(<cmd ctx :delete-todo todo)}]]
   (when is-editing?
     [comp> ctx :todo-edit])])

(def component
  (<comp :renderer render
         :component-deps [:todo-edit
                          :timer-button]))

#+end_src
     
**** file entities/todo.cljs
(find-file-other-frame "./src/keechma_todomvc/entities/todo.cljs")
**** src entities/todo.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.entities.todo
  "# Todo Entities"
  (:require [clojure.string :as str]
            [keechma-todomvc.edb :as edb])
  (:import [goog.ui IdGenerator]))

;; ## Helpers

(def id-generator (IdGenerator.))

(defn id
  "Returns a unique ID for a new todo."
  []
  (.getNextUniqueId id-generator))

(defn valid-title?
  "Returns `true` if `title` is a valid `todo` title."
  [title]
  (not (str/blank? title)))

;; ## Subscription Support (Read)

(defn todos-by-status
  "Returns all `todos` with a `status`."
  [app-db status]
  (let [todos (edb/get-collection app-db :todos :list)]
    (case status
      :completed (filter :completed todos)
      :active (filter (complement :completed) todos)
      :all todos)))

(defn edit-todo
  "Returns the `todo` currently being edited."
  [app-db]
  (->> (get-in app-db [:kv :editing-id])
       (edb/get-item-by-id app-db :todos)))

;; ## Action Support (Write)

;; ### Edit Management

(defn start-edit
  "Sets state: this `todo` is currently being edited."
  [app-db {:keys [id] :as todo}]
  (assoc-in app-db [:kv :editing-id] id))

(defn cancel-edit
  "Clears state: no `todo` is currently being edited."
  [app-db]
  (assoc-in app-db [:kv :editing-id] nil))

(defn confirm-edit
  "Updates `todo` if `new-todo` has a valid `title`."
  [app-db {:keys [id title] :as new-todo}]
  (assert id)
  (if (valid-title? title)
    (-> app-db
        (cancel-edit)
        (edb/insert-item :todos new-todo))
    app-db))

;; ### Create, Update, Delete Todos

(defn create-todos
  "Creates an empty `todos` list."
  [app-db]
  (edb/insert-collection app-db :todos :list []))

(defn create-todo
  "If `title` is valid, creates a new `todo` and inserts it at the
  beginning of the `todo` list."
  [app-db title]
  (if (valid-title? title)
    (let [todo {:id (str "todo" (id))
                :completed false
                :title title}]
      (edb/prepend-collection app-db :todos :list [todo]))
    app-db))

(defn update-todo
  "Merges new data into a `todo`. `patch-todo` must have an `:id`
  value that is the `id` of the `todo` to be updated."
  [app-db {:keys [id] :as patch-todo}]
  (assert id)
  (edb/insert-item app-db :todos patch-todo))


(defn update-todo-time
  [app-db {:keys [id] :as patch-todo} time]
  ;; (assert id)
  ;; (println patch-todo)
  ;; (println time)
  (println "test!")
  ;; —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å time –≤–Ω—É—Ç—Ä–∏ —Ç—É–¥—É
  ;; –∏ –Ω–æ–≤–µ—Ä–Ω–æ –≤—ã–∑–≤–∞—Ç—å update-todo
  )

(defn toggle-todo
  "Toggles the `:completed` status of a saved `todo`."
  [app-db todo]
  (update-todo app-db (update todo :completed not)))

(defn toggle-all
  "Marks all `todos` as completed or not based on `completed?`."
  [app-db completed?]
  (reduce (fn [acc todo]
            (update-todo acc (assoc todo :completed completed?)))
          app-db
          (todos-by-status app-db :all)))

(defn delete-todo
  "Removes a `todo` from the EntityDB."
  [app-db {:keys [id] :as todo}]
  (edb/remove-item app-db :todos id))

(defn delete-completed
  "Removes all completed `todos` from the EntityDB."
  [app-db]
  (reduce (fn [acc {:keys [id]}]
            (edb/remove-item acc :todos id))
          app-db
          (todos-by-status app-db :completed)))

;; ## Actions for keechma.controllers/dispatcher

(defn actions
  "Returns a mapping from `todo` topic `command` keywords to `action`
  functions. The mapping is suitable for use by
  `keechma.controller/dispatcher`.

  Adapts the calling convention from the one used by
  `keechma.controllers/dispatcher`:

  `(action-fn app-db-atom args-vec)`

  to one that is more natural for ClojureScript:

  `(handler app-db-atom arg1 arg2 arg3 ...)`.

  Combined with `<cmd` in `ui.cljs`, this allows natural-looking
  arguments in calls to `<cmd` to be handled by a handler with a
  natural looking argument vector in its definition. This insulates
  app developers from the restriction against varags in protocol
  functions that results in `keechma.ui-component/send-command`
  supporting only exactly 2 or 3 args, the last one an optional
  explicit vector of additional args.

  The adapter also provides the side-effect of updating the `app-db`
  with the result of each call, allowing the handlers to be written
  and tested as pure functions that return the new `app-db` value."
  []
  (let [cmd-handlers {:start-edit start-edit
                      :cancel-edit cancel-edit
                      :confirm-edit confirm-edit
                      :create-todo create-todo
                      :delete-todo delete-todo
                      :toggle-todo toggle-todo
                      :toggle-all toggle-all
                      :update-todo-time update-todo-time
                      :delete-completed delete-completed}
        action-adapter (fn [f]
                         (fn [app-db args]
                           (apply swap! app-db f args)))]
    (reduce-kv (fn [acc k f]
                 (assoc acc k (action-adapter f)))
               {}
               cmd-handlers)))

#+end_src
     
**** file components/todo_item.cljs
(find-file-other-frame "./src/keechma_todomvc/components/todo_item.cljs")
**** src components/todo_item.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.todo-item
  "# Todo Item component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp comp>]]))

(defn render
  "## Renders a todo list item

  The item's content includes:

- a `checkbox` for toggling `:completed`
- a `label` displaying the `:title`
- a `button` to delete the item

If the item is currently being edited, overlays a `todo-edit` component.

### Component Deps

- `:todo-edit` presents ui to edit a `todo`'s title

### Arguments

  This render function has arguments in addition to `ctx`. Values for
  those are provided at the site where this component is included
  within another, in this case `:todo-list`. If this were a `form-2`
  render function, the returned function would have only `todo` and
  `is-editing?` as arguments."
  [ctx todo is-editing?]
  [:li {:class [(when is-editing? :editing)
                (when (:completed todo) :completed)]}
   [:div.view {:on-double-click #(<cmd ctx :start-edit todo)}
    [:input.toggle {:type :checkbox
                    :checked (:completed todo)
                    :on-change #(<cmd ctx :toggle-todo todo)}]
    [:label (:title todo)
      [comp> ctx :timer-button todo]]
    [:button.destroy {:on-click #(<cmd ctx :delete-todo todo)}]]
   (when is-editing?
     [comp> ctx :todo-edit])])

(def component
  (<comp :renderer render
         :component-deps [:todo-edit
                          :timer-button]))

#+end_src
     
*** —á—Ç–æ-—Ç–æ update-todo-time —É–º–µ–Ω—è –Ω–µ—Ä–∞–±–æ—Ç–∞–µ—Ç
–¥–æ–ª–∂–Ω–æ –ø—Ä–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–∏ stop!
–ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–µ–∫—É–Ω–¥ –≤ edb (–ø—Ä–∏–≤—è–∑–∞–Ω–æ–µ –∫ todo-id)
–Ω–æ —Ñ—É–Ω–∫—Ü–∏—è –≤—ã–∑–≤–∞–µ—Ç—Å—è. –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ —Å—Ç–æ–ø —è –ø–æ–ª—É—á–∞—é —è –ø–æ–ª—É—á–∞—é –æ–∂–∏–¥–∞–µ–º—ã —Ç–µ—Å—Ç

test! client.cljs:39:18
Trying to send command to a controller that is not running 
Object { meta: null, cnt: 3, arr: (6) [‚Ä¶], __hash: null, "cljs$lang$protocol_mask$partition0$": 16647951, "cljs$lang$protocol_mask$partition1$": 139268 }
controller_manager.cljs:27:16
–≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞
–ß—Ç–æ —è –¥–µ–ª–∞—é –Ω–µ—Ç–∞–∫?
–∏ –ø—Ä–µ–¥–ª–æ–∂–∏ —Ä–∞–±–æ—á—É—é –≤–µ—Ä—Å–∏—é update-todo-time –≤—ã–ø–æ–ª–Ω—è—é—à–∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

** DONE –∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–ø–∏—é
—É–±–µ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—Ç–æ —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏
** DONE –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –æ—Ä–≥ –Ω—É–∂–Ω—ã–µ —Ñ–∞–π–ª–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã
–≤–∑—è—Ç—å –∫–∞–∫ –º–∏–Ω–Ω–∏–º—É–º –æ–¥–∏–Ω —Ñ–∞–∏–ª —á—Ç–æ —É–±–µ–¥–∏—Ç—å –≤ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞
** DONE —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–∏—Ç
** CANCELED –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø–æ–¥ —Ñ–∏–≥–≤–∏–ª–ª –º–∞–∏–Ω
*** –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –≤ –¥–µ–ª–µ–π—Ç
*** —Å–¥–µ–ª–∞—Ç—å —Ç–µ–º–ø–ª–∞—Ç
clj -X:new :template figwheel-main :name keechma-todomvc/worder :args '["+deps" "--reagent"]'
clj -X:new :template figwheel-main :name worder/keechma-todomvc :args '["+deps" "--reagent"]'
*** —á–µ—Ä–µ–∑ —Ç–µ–º–ø–ª–∞—Ç
–ü–µ—Ä–µ–¥–µ–ª–∞—Ç—å **Leiningen + figwheel** ‚Üí **deps.edn + figwheel-main** ‚Äî –º–æ–∂–Ω–æ ‚úÖ
–ù–æ **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞** project.clj ‚Üí deps.edn **–Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç**.
Lein –∏ deps –∏—Å–ø–æ–ª—å–∑—É—é—Ç **—Ä–∞–∑–Ω—ã–µ —ç–∫–æ—Å–∏—Å—Ç–µ–º—ã**, –ø–æ—ç—Ç–æ–º—É —á–∞—Å—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–¥—ë—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –≤—Ä—É—á–Ω—É—é.

---

## ‚úÖ –°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π –ø—É—Ç—å ‚Äî –¥–∞:

> –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ–¥ Figwheel Main –∏ **–ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ —Ç–æ–ª—å–∫–æ –∫–æ–¥**

–≠—Ç–æ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ** –¥–∞—Å—Ç —Ä–∞–±–æ—á—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –±–µ–∑ –±–æ—Ä—å–±—ã —Å–æ —Å–±–æ—Ä–∫–æ–π.

---

–ù–æ –µ—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –¥–∞–≤–∞–π —Å–¥–µ–ª–∞–µ–º **–∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é "–ø—Ä–∞–≤–∏–ª—å–Ω–æ"** üí™
–í–æ—Ç —Ç–æ—á–Ω—ã–π –ø–ª–∞–Ω –¥–ª—è —Ç–≤–æ–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

---

# ‚úÖ deps.edn –¥–ª—è —Ç–≤–æ–µ–≥–æ TodoMVC –Ω–∞ Keechma

–°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª: `deps.edn`

```clojure
{:paths ["src" "resources"]

 :deps {org.clojure/clojure        {:mvn/version "1.10.1"}
        org.clojure/clojurescript  {:mvn/version "1.10.597"}
        org.clojure/core.async     {:mvn/version "0.7.559"
                                    :exclusions  [org.clojure/tools.reader]}
        reagent/reagent            {:mvn/version "0.9.1"}
        keechma/keechma            {:mvn/version "0.3.14"
                                    :exclusions [cljsjs/react-with-addons
                                                 cljsjs/react-dom
                                                 cljsjs/react-dom-server]}
        keechma/entitydb           {:mvn/version "0.1.6"}}

 :aliases
 {:fig {:extra-deps
        {com.bhauman/figwheel-main {:mvn/version "0.2.18"}
         com.bhauman/rebel-readline-cljs {:mvn/version "0.1.4"}}
        :main-opts ["-m" "figwheel.main"]}}}
```

---

## ‚úÖ –ö–æ–Ω—Ñ–∏–≥ Figwheel Main

–°–æ–∑–¥–∞–π —Ñ–∞–π–ª: `figwheel-main.edn`

```clojure
{:watch-dirs ["src"]
 :css-dirs   ["resources/public/css"]}
```

---

## ‚úÖ Build config (–≤–º–µ—Å—Ç–æ :cljsbuild)

–°–æ–∑–¥–∞–π: `dev.cljs.edn`

```clojure
{:main keechma-todomvc.app
 :output-to "resources/public/js/app.js"
 :output-dir "resources/public/js/dev"
 :asset-path "js/dev"
 :closure-defines {goog.DEBUG true}
 :preloads [devtools.preload]}
```

–ò production build:

`prod.cljs.edn`:

```clojure
{:main keechma-todomvc.app
 :optimizations :advanced
 :output-to "resources/public/js/app.js"
 :output-dir "resources/public/js/min"
 :closure-defines {goog.DEBUG false}}
```

---

## ‚úÖ –ó–∞–ø—É—Å–∫

Dev mode (–∞–Ω–∞–ª–æ–≥ `lein figwheel`):

```bash
clojure -M:fig:build dev
```

Prod build:

```bash
clojure -M:fig:build prod
```

---

# üß† –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –ø–æ–¥—Ö–æ–¥–æ–≤

| –°–ø–æ—Å–æ–±                            | –ü–ª—é—Å—ã                       | –ú–∏–Ω—É—Å—ã                                 |
| --------------------------------- | --------------------------- | -------------------------------------- |
| ‚úÖ –ù–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç + –ø–µ—Ä–µ–Ω–æ—Å –∫–æ–¥–∞     | –ë—ã—Å—Ç—Ä–æ, —á–∏—Å—Ç–æ, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ   | –ù—É–∂–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å —Ä—É–∫–∞–º–∏                |
| üõ† –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤—Ä—É—á–Ω—É—é (–∫–∞–∫ –≤—ã—à–µ) | –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ | –ù—É–∂–Ω–æ —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ deps+figwheel-main |
| ‚ùå –ê–≤—Ç–æ-–∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä                  | ‚Äî                           | –ï–≥–æ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç                      |

---

## üéÅ –•–æ—á–µ—à—å ‚Äî —è –º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å –≤—Å—ë –∑–∞ —Ç–µ–±—è üíÖ

–Ø –º–æ–≥—É:
‚úÖ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —ç—Ç–∞–ª–æ–Ω–Ω—ã–π figwheel-main –ø—Ä–æ–µ–∫—Ç
‚úÖ –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ç–≤–æ–∏ —Ñ–∞–π–ª—ã
‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞–ø—É—Å–∫
‚úÖ –ü–æ–º–æ—á—å –¥–æ–±–∞–≤–∏—Ç—å live reload HTML, REPL, nREPL, Shadow –≥–æ—Ç–æ–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥

–¢–æ–ª—å–∫–æ —Å–∫–∞–∂–∏, –∫–∞–∫ —Ç—ã —Ö–æ—á–µ—à—å –Ω–∞–∑–≤–∞—Ç—å –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç üí¨

–ù–∞–ø—Ä–∏–º–µ—Ä:

```
keechma-todomvc-main
```

–•–æ—á–µ—à—å ‚Äî —Å–¥–µ–ª–∞—é PR-style diff, —á—Ç–æ–±—ã –±—ã–ª–æ –≤–∏–¥–Ω–æ –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚úÖ

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º? üòé

*** –ò–ò
—É –º–µ–Ω—è –µ—Å—Ç—å –ø—Ä–æ–µ–∫—Ç –ø–æ–¥ lein figwheel
(find-file-other-frame "./project.clj")
(defproject keechma-todomvc "0.1.0-SNAPSHOT"
  :description "TodoMVC implemented in Keechma"
  :url "http://github.com/keechma/keechma-todomvc"
  :license {:name "MIT"}

  :min-lein-version "2.5.3"

  :dependencies [[org.clojure/clojure "1.10.1"]
                 [org.clojure/clojurescript "1.10.597"]
                 [org.clojure/core.async "0.7.559"
                  :exclusions [org.clojure/tools.reader]]
                 [reagent "0.9.1"]
                 [keechma "0.3.14"
                  :exclusions [cljsjs/react-with-addons
                               cljsjs/react-dom
                               cljsjs/react-dom-server]]
                 [keechma/entitydb "0.1.6"]]

  :plugins [[lein-figwheel "0.5.19"]
            [lein-cljsbuild "1.1.7"
             :exclusions [[org.clojure/clojure]]]
            [lein-marginalia "0.9.1"]]

  :source-paths ["src"]

  :clean-targets ^{:protect false} ["resources/public/js/compiled" "target"]

  :cljsbuild
  {:builds
   [{:id "dev"
     :source-paths ["src"]
     :figwheel {:on-jsload "keechma-todomvc.app/restart!"}
     :compiler {:main                 keechma-todomvc.app
                :optimizations        :none
                :output-to            "resources/public/js/app.js"
                :output-dir           "resources/public/js/dev"
                :asset-path           "js/dev"
                :source-map-timestamp true}}
    ;; This next build is an compressed minified build for
    ;; production. You can build this with:
    ;; lein cljsbuild once min
    {:id "min"
     :source-paths ["src"]
     :compiler {:main            keechma-todomvc.app
                :optimizations   :advanced
                :output-to       "resources/public/js/app.js"
                :output-dir      "resources/public/js/min"
                :elide-asserts   true
                :closure-defines {goog.DEBUG false}
                :pretty-print    false}}]}

  :figwheel {;; :http-server-root "public" ;; default and assumes "resources"
             ;; :server-port 3449 ;; default
             ;; :server-ip "127.0.0.1"

             :css-dirs ["resources/public/css"] ;; watch and update CSS

             ;; Start an nREPL server into the running figwheel process
             ;; :nrepl-port 7888

             ;; Server Ring Handler (optional)
             ;; if you want to embed a ring handler into the figwheel http-kit
             ;; server, this is for simple ring servers, if this
             ;; doesn't work for you just run your own server :)
             ;; :ring-handler hello_world.server/handler

             ;; To be able to open files in your editor from the heads up display
             ;; you will need to put a script on your path.
             ;; that script will have to take a file path and a line number
             ;; ie. in  ~/bin/myfile-opener
             ;; #! /bin/sh
             ;; emacsclient -n +$2 $1
             ;;
             ;; :open-file-command "myfile-opener"

             ;; if you want to disable the REPL
             ;; :repl false

             ;; to configure a different figwheel logfile path
             ;; :server-logfile "tmp/logs/figwheel-logfile.log"
             })

–∫–∞–∫ –º–Ω–µ –µ–≥–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø–æ–¥ figwheel main?
—Ç–æ–µ—Å—Ç—å –ø–æ–¥ —Ñ–∞–∏–ª deps.edn?
—Ç–∞–∫ —á—Ç–æ–± —è –º–æ–≥ –µ–≥–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∫ clojure -M:fig:build?
–µ—Å—Ç—å –∫–∞–∫–æ–π—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–ø–æ—Å–æ–± —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å ./deps.edn –Ω–∞ –æ—Å–Ω–æ–≤–µ ./project.clj?
*** –∫–æ–º–∞–Ω–¥–∞
clojure -Sdeps '{:deps {leiningen/tools.deps.converter {:mvn/version "0.4.2"}}}' \
-m leiningen.tools.deps.converter project.clj
*** –≤—Ä—É—á–Ω—É—é

–ö—Ä—É—Ç–æ–π —à–∞–≥! üéØ –ü–µ—Ä–µ—Ö–æ–¥ —Å **Leiningen + Figwheel Classic** ‚Üí –Ω–∞ **deps.edn + Figwheel Main** ‚Äî —Å–µ–π—á–∞—Å —ç—Ç–æ ‚Äú–∫–∞–Ω–æ–Ω‚Äù –¥–ª—è ClojureScript ‚úÖ
–ù–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ *–∫ —Å–æ–∂–∞–ª–µ–Ω–∏—é –Ω–µ—Ç* ‚Äî –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å –≤—Ä—É—á–Ω—É—é. –Ø –ø–æ–º–æ–≥—É —Å–¥–µ–ª–∞—Ç—å —ç—Ç–æ –∫—Ä–∞—Å–∏–≤–æ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ –±–æ–ª—å–Ω–æ üí™

---

## ‚úÖ –ß—Ç–æ –Ω–∞–º –Ω–∞–¥–æ –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏

–ò–∑ —Ç–≤–æ–µ–≥–æ `project.clj` –≤–∞–∂–Ω—ã:

| –ß—Ç–æ                  | –ò–∑ `project.clj` ‚Üí –í `deps.edn`       |
| -------------------- | ------------------------------------- |
| –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏          | `:dependencies`                       |
| –ø—É—Ç–∏                 | `:source-paths`                       |
| –∫–æ–Ω—Ñ–∏–≥ Figwheel Main | —Å–æ–∑–¥–∞—ë–º –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª `dev.cljs.edn` |
| –∑–∞–ø—É—Å–∫               | `clojure -M:fig`                      |

–û—Å—Ç–∞–ª—å–Ω–æ–µ –º–æ–∂–Ω–æ –∑–∞–±—ã—Ç—å.
`cljsbuild`, `plugins` ‚Äî **–Ω–µ –Ω—É–∂–Ω—ã** –≤ deps.edn –º–∏—Ä–µ ‚ùå

---

## ‚úÖ –ü—Ä–∏–º–µ—Ä —Ç–≤–æ–µ–≥–æ `deps.edn`

–°–æ–∑–¥–∞–π `deps.edn` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```clojure
{:paths ["src" "resources"]

 :deps {org.clojure/clojure            {:mvn/version "1.10.1"}
        org.clojure/clojurescript      {:mvn/version "1.10.597"}
        org.clojure/core.async         {:mvn/version "0.7.559"
                                        :exclusions  [org.clojure/tools.reader]}
        reagent/reagent                {:mvn/version "0.9.1"}
        keechma/keechma                {:mvn/version "0.3.14"
                                        :exclusions [cljsjs/react-with-addons
                                                     cljsjs/react-dom
                                                     cljsjs/react-dom-server]}
        keechma/entitydb               {:mvn/version "0.1.6"}}

 :aliases
 {:fig
  {:extra-deps {com.bhauman/figwheel-main       {:mvn/version "0.2.18"}
                com.bhauman/rebel-readline-cljs {:mvn/version "0.1.4"}}
   :main-opts ["-m" "figwheel.main" "-b" "dev" "-r"]}}}
```

---

## ‚úÖ –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥ —Å–±–æ—Ä–∫–∏ Figwheel Main

–°–æ–∑–¥–∞–π –ø–∞–ø–∫—É:

```
./dev
```

–ò —Ñ–∞–π–ª `dev/dev.cljs.edn`:

```clojure
^{:watch-dirs ["src"]
  :css-dirs ["resources/public/css"]}
{:main keechma-todomvc.app}
```

–≠—Ç–æ –∑–∞–º–µ–Ω—è–µ—Ç –≤–µ—Å—å —Ç–≤–æ–π –±–ª–æ–∫:

```
:cljsbuild
:figwheel
```

---

## ‚úÖ HTML –∏—Å–ø—Ä–∞–≤–∏—Ç—å –ø—É—Ç—å –∫ js

–í `resources/public/index.html` (–∏–ª–∏ –≥–¥–µ main HTML):

–ó–∞–º–µ–Ω–∏—Ç—å:

```html
<script src="js/app.js"></script>
```

–ù–∞ Figwheel Main –ø—É—Ç—å:

```html
<script src="/cljs-out/dev-main.js"></script>
```

(Figwheel —Å–∞–º —Å–æ–∑–¥–∞—Å—Ç `cljs-out/`)

---

## ‚úÖ –ö–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ–ø–µ—Ä—å üöÄ

–†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
clojure -M:fig
```

–ü—Ä–æ–¥–∞–∫—à–Ω-—Å–±–æ—Ä–∫–∞:

```bash
clojure -M:fig -bo dev
```

---

## ‚úÖ –ß—Ç–æ –¥–µ–ª–∞—Ç—å —Å `project.clj`?

–£–¥–∞–ª–∏ –∏–ª–∏ –æ—Å—Ç–∞–≤—å —Ç–æ–ª—å–∫–æ –∫–∞–∫ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–µ–∫—Ç–∞ ‚Äî –æ–Ω –±–æ–ª—å—à–µ –Ω–µ –Ω—É–∂–µ–Ω üëç

---

## ‚ú® –ë–æ–Ω—É—Å: —Ö–æ—Ç–∏–º REPL + –∞–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫—É –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö?

–ú–æ–∂–Ω–æ —Ç–∞–∫–∂–µ:

```bash
clojure -M:fig -b dev -r
```

---

## üìå –û—Ç–≤–µ—Ç—ã –Ω–∞ —Ç–≤–æ–∏ –≤–æ–ø—Ä–æ—Å—ã

| –í–æ–ø—Ä–æ—Å                                                        | –û—Ç–≤–µ—Ç                   |
| ------------------------------------------------------------- | ----------------------- |
| –ú–æ–∂–Ω–æ –ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å project.clj ‚Üí deps.edn? | ‚ùå –ù–µ—Ç (—Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–Ω–æ—Å)  |
| –ú–æ–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ `clojure -M:fig:build`?              | ‚úÖ –î–∞, —Å–º. alias         |
| Lein plugins –Ω—É–∂–Ω—ã?                                           | ‚ùå –í–æ–æ–±—â–µ –Ω–µ—Ç –≤ deps.edn |

---

–•–æ—á–µ—à—å ‚Äî —è –º–æ–≥—É:
‚úÖ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –¥–ª—è —Ç–µ–±—è –≤—Å—ë –ø–æ–ª–Ω–æ—Å—Ç—å—é
‚úÖ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è
‚úÖ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (src/dev separation)
‚úÖ –¥–æ–±–∞–≤–∏—Ç—å hot reload React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–æ—á–Ω–æ –∫–∞–∫ –≤ –ø—Ä–µ–∂–Ω–µ–º figwheel

–•–æ—á–µ—à—å ‚Äî –ø—Ä–æ—Å—Ç–æ —Å–∫–∏–Ω—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞ (`tree -L 3`) –∏ —è —Å–¥–µ–ª–∞—é –∏–¥–µ–∞–ª—å–Ω—É—é –º–∏–≥—Ä–∞—Ü–∏—é üî•
*** –æ—à–∏–±–∫–∞
**** 1

#+begin_src html :no-expand t :mkdirp yes 
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Worder ‚Ä¢ Keechma</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link rel="icon" href="https://clojurescript.org/images/cljs-logo-icon-32.png">
  </head>
  <body>
    <div id="app"> 
    </div> <!-- end of app div -->
    <script src="cljs-out/dev-main.js" type="text/javascript"></script>
    <script>keechma_todomvc.worder.main()</script>
  </body>
</html>
#+end_src




(ns ^:figwheel-hooks keechma-todomvc.worder
  "# Keechma TodoMVC App"
  (:require [keechma-todomvc.components :as components]
            [keechma-todomvc.controllers.todos :as todos]
            [keechma-todomvc.subscriptions :as subscriptions]
            [keechma.app-state :as app-state]))

(defn multiply [a b] (* a b))

(defonce running-app (atom nil))

;; ## App Definition

(def app-definition
  "Pulls the app together."
  {:routes [[":status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

;; ## App Lifecycle

(defn start!
  "Starts the app."
  []
  (reset! running-app (app-state/start! app-definition)))

(defn restart!
  "Restarts the app. `project.clj` contains a config setting for
  `figwheel` requesting a call to this function whenever the code is
  reloaded."
  []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup
  "Enables console output for dev builds."
  []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

;; ## Main

(defn ^:export main
  "Called from `index.html` to start the app. Exported because
  `index.html` refers to it by name even in non-dev builds."
  []
  (dev-setup)
  (start!))


~/Dev/ClojureScript/tutorials/my-cljs-project/worder $ clojure -M:fig:build

[Figwheel] Validating figwheel-main.edn
[Figwheel] figwheel-main.edn is valid \(„ÉÑ)/
[Figwheel] Compiling build dev to "target/public/cljs-out/dev-main.js"
[Figwheel] Successfully compiled build dev to "target/public/cljs-out/dev-main.js" in 2.309 seconds.
[Figwheel] Outputting main file: target/public/cljs-out/dev-main-auto-testing.js
[Figwheel] Watching paths: ("test" "src") to compile build - dev
[Figwheel] Starting Server at http://localhost:9500
[Figwheel] Starting REPL
Prompt will show when REPL connects to evaluation environment (i.e. a REPL hosting webpage)
Figwheel Main Controls:
          (figwheel.main/stop-builds id ...)  ;; stops Figwheel autobuilder for ids
          (figwheel.main/start-builds id ...) ;; starts autobuilder focused on ids
          (figwheel.main/reset)               ;; stops, cleans, reloads config, and starts autobuilder
          (figwheel.main/build-once id ...)   ;; builds source one time
          (figwheel.main/clean id ...)        ;; deletes compiled cljs target files
          (figwheel.main/status)              ;; displays current state of system
Figwheel REPL Controls:
          (figwheel.repl/conns)               ;; displays the current connections
          (figwheel.repl/focus session-name)  ;; choose which session name to focus on
In the cljs.user ns, controls can be called without ns ie. (conns) instead of (figwheel.repl/conns)
    Docs: (doc function-name-here)
    Exit: :cljs/quit
 Results: Stored in vars *1, *2, *3, *e holds last exception object
WARNING: A restricted method in java.lang.System has been called
WARNING: java.lang.System::loadLibrary has been called by org.fusesource.hawtjni.runtime.Library in an unnamed module (file:/home/buyn/.m2/repository/org/fusesource/jansi/jansi/1.16/jansi-1.16.jar)
WARNING: Use --enable-native-access=ALL-UNNAMED to avoid a warning for callers in this module
WARNING: Restricted methods will be blocked in a future release unless native access is enabled

[Rebel readline] Type :repl/help for online help info
Opening URL http://localhost:9500
ClojureScript 1.11.132
cljs.user=> 

 util.cljs:187:64
Feature :formatters cannot be installed. Unsupported Javascript context: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0. util.cljs:248:15
CLJS DevTools: some custom formatters were not rendered.
https://github.com/binaryage/cljs-devtools/blob/master/docs/faq.md#why-some-custom-formatters-were-not-rendered util.cljs:136:15
Uncaught Error: Bad dependency path or symbol: keechma_todomvc.components.todo_edit
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2349
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2361
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2361
    load_ http://localhost:9500/cljs-out/dev/goog/base.js:2368
    require http://localhost:9500/cljs-out/dev/goog/base.js:832
    <anonymous> http://localhost:9500/:13
base.js:2349:17
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2349
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2361
    visit http://localhost:9500/cljs-out/dev/goog/base.js:2361
    load_ http://localhost:9500/cljs-out/dev/goog/base.js:2368
    require http://localhost:9500/cljs-out/dev/goog/base.js:832
    <anonymous> http://localhost:9500/:13
Uncaught ReferenceError: keechma_todomvc is not defined
    <anonymous> http://localhost:9500/:14
localhost:9500:14:13
    <anonymous> http://localhost:9500/:14
 [goog.net.WebSocket] Opening the WebSocket on ws://localhost:9500/figwheel-connect?fwprocess=7fb158&fwbuild=dev&fwsid=ba3c1dab-1ca9-4ad4-ac61-a614e44e1471 <empty string> console.js:218:20
 [goog.net.WebSocket] WebSocket opened on ws://localhost:9500/figwheel-connect?fwprocess=7fb158&fwbuild=dev&fwsid=ba3c1dab-1ca9-4ad4-ac61-a614e44e1471 <empty string> console.js:218:20
 [Figwheel REPL] Session ID: ba3c1dab-1ca9-4ad4-ac61-a614e44e1471 <empty string> console.js:218:20
 [Figwheel REPL] Session Name: Bridget <empty string>
    <anonymous> http://localhost:9500/:12
**** 2
Installing CLJS DevTools 1.0.5 and enabling features :formatters :hints :async util.cljs:187:64
Feature :formatters cannot be installed. Unsupported Javascript context: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0. util.cljs:248:15
CLJS DevTools: some custom formatters were not rendered.
https://github.com/binaryage/cljs-devtools/blob/master/docs/faq.md#why-some-custom-formatters-were-not-rendered util.cljs:136:15
dev mode core.cljs:200:24
Uncaught 
Object { message: "Missing dependencies :todo-edit for component :todo-item", data: {‚Ä¶}, cause: null, name: "Error", description: undefined, number: undefined, fileName: "http://localhost:9500/cljs-out/dev/cljs/core.js", lineNumber: 38425, columnNumber: 10, stack: "cljs$core$ExceptionInfo@http://localhost:9500/cljs-out/dev/cljs/core.js:38425:10\ncljs.core.ex_info.cljs$core$IFn$_invoke$arity$3@http://localhost:9500/cljs-out/dev/cljs/core.js:38486:9\ncljs.core.ex_info.cljs$core$IFn$_invoke$arity$2@http://localhost:9500/cljs-out/dev/cljs/core.js:38482:26\ncljs$core$ex_info@http://localhost:9500/cljs-out/dev/cljs/core.js:38468:26\nkeechma$ui_component$make_ex@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:11:26\nkeechma$ui_component$component_with_deps@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:971:36\nkeechma$ui_component$resolved_system/<@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:1017:86\ncljs.core.seq_reduce.cljs$core$IFn$_invoke$arity$3/nval<@http://localhost:9500/cljs-out/dev/cljs/core.js:8530:98\ncljs.core.seq_reduce.cljs$core$IFn$_invoke$arity$3@http://localhost:9500/cljs-out/dev/cljs/core.js:8531:3\ncljs.core.Cons.prototype.cljs$core$IReduce$_reduce$arity$3@http://localhost:9500/cljs-out/dev/cljs/core.js:11531:29\ncljs.core.reduce.cljs$core$IFn$_invoke$arity$3@http://localhost:9500/cljs-out/dev/cljs/core.js:8684:13\ncljs$core$reduce@http://localhost:9500/cljs-out/dev/cljs/core.js:8648:25\nkeechma$ui_component$resolved_system@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:1012:25\nkeechma.ui_component.system.cljs$core$IFn$_invoke$arity$2@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:1175:51\nkeechma$ui_component$system@http://localhost:9500/cljs-out/dev/keechma/ui_component.js:1155:36\nkeechma$app_state$resolve_main_component@http://localhost:9500/cljs-out/dev/keechma/app_state.js:801:50\nkeechma.app_state.start_BANG_.cljs$core$IFn$_invoke$arity$2@http://localhost:9500/cljs-out/dev/keechma/app_state.js:988:92\nkeechma$app_state$start_BANG_@http://localhost:9500/cljs-out/dev/keechma/app_state.js:970:38\nkeechma.app_state.start_BANG_.cljs$core$IFn$_invoke$arity$1@http://localhost:9500/cljs-out/dev/keechma/app_state.js:980:38\nkeechma$app_state$start_BANG_@http://localhost:9500/cljs-out/dev/keechma/app_state.js:966:38\nkeechma_todomvc$worder$start_BANG_@http://localhost:9500/cljs-out/dev/keechma_todomvc/worder.js:23:105\nkeechma_todomvc$worder$main@http://localhost:9500/cljs-out/dev/keechma_todomvc/worder.js:58:43\n@http://localhost:9500/:14:36\n" }
core.cljs:11778:11
 [goog.net.WebSocket] Opening the WebSocket on ws://localhost:9500/figwheel-connect?fwprocess=b292cc&fwbuild=dev&fwsid=ae8af371-96d0-41d5-ab1c-859cabaf1a7a <empty string> console.js:218:20
 [goog.net.WebSocket] WebSocket opened on ws://localhost:9500/figwheel-connect?fwprocess=b292cc&fwbuild=dev&fwsid=ae8af371-96d0-41d5-ab1c-859cabaf1a7a <empty string> console.js:218:20
 [Figwheel REPL] Session ID: ae8af371-96d0-41d5-ab1c-859cabaf1a7a <empty string> console.js:218:20
 [Figwheel REPL] Session Name: Eufemia <empty string>
**** 3
Installing CLJS DevTools 1.0.5 and enabling features :formatters :hints :async util.cljs:187:64
Feature :formatters cannot be installed. Unsupported Javascript context: Mozilla/5.0 (X11; Linux x86_64; rv:142.0) Gecko/20100101 Firefox/142.0. util.cljs:248:15
CLJS DevTools: some custom formatters were not rendered.
https://github.com/binaryage/cljs-devtools/blob/master/docs/faq.md#why-some-custom-formatters-were-not-rendered util.cljs:136:15
dev mode core.cljs:200:24
Uncaught TypeError: can't access property "call", reagent.core.render_component is undefined
    keechma$app_state$mount_to_element_BANG_ app_state.cljs:200
    cljs$core$IFn$_invoke$arity$2 app_state.cljs:312
    keechma$app_state$start_BANG_ app_state.cljs:258
    cljs$core$IFn$_invoke$arity$1 app_state.cljs:301
    keechma$app_state$start_BANG_ app_state.cljs:258
    keechma_todomvc$worder$start_BANG_ worder.cljs:27
    keechma_todomvc$worder$main worder.cljs:52
    <anonymous> (index):14
app_state.cljs:200:5
 [goog.net.WebSocket] Opening the WebSocket on ws://localhost:9500/figwheel-connect?fwprocess=1af083&fwbuild=dev&fwsid=c6a9dd49-7f6e-4d90-9e13-4a3715118bc4 <empty string> console.js:218:20
 [goog.net.WebSocket] WebSocket opened on ws://localhost:9500/figwheel-connect?fwprocess=1af083&fwbuild=dev&fwsid=c6a9dd49-7f6e-4d90-9e13-4a3715118bc4 <empty string> console.js:218:20
 [Figwheel REPL] Session ID: c6a9dd49-7f6e-4d90-9e13-4a3715118bc4 <empty string> console.js:218:20
 [Figwheel REPL] Session Name: Rolando <empty string> console.js:218:20
*** –ò–ò
**** index.html
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Worder ‚Ä¢ Keechma</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/style.css" rel="stylesheet" type="text/css">
    <link rel="icon" href="https://clojurescript.org/images/cljs-logo-icon-32.png">
  </head>
  <body>
    <div id="app"> 
    </div> <!-- end of app div -->
    <script src="cljs-out/dev-main.js" type="text/javascript"></script>
    <script>keechma_todomvc.worder.main()</script>
  </body>
</html>
**** src deps.edn
#+begin_src clojure :no-expand t
{:deps {org.clojure/clojure {:mvn/version "1.12.0"}
        org.clojure/clojurescript {:mvn/version "1.11.132"}
        org.clojure/data.json {:mvn/version "2.5.1"}
        cljsjs/react {:mvn/version "18.3.1-1"}
        cljsjs/react-dom {:mvn/version "18.3.1-1"}
        org.clojure/core.async     {:mvn/version "0.7.559"
                                    :exclusions  [org.clojure/tools.reader]}
        keechma/keechma            {:mvn/version "0.3.14"
                                    :exclusions [cljsjs/react-with-addons
                                                 cljsjs/react-dom
                                                 cljsjs/react-dom-server]}
        keechma/entitydb           {:mvn/version "0.1.6"}
        reagent/reagent {:mvn/version "1.2.0" }}

 :paths ["src" "resources"]

 :aliases {:fig {:extra-deps
                 {com.bhauman/rebel-readline-cljs {:mvn/version "0.1.4"}
                  com.bhauman/figwheel-main {:mvn/version "0.2.20"}
                  org.slf4j/slf4j-nop {:mvn/version "2.0.16"}}
                 :extra-paths ["target" "test"]}
           :build {:main-opts ["-m" "figwheel.main" "-b" "dev" "-r"]}
           :clean {:main-opts ["-m" "figwheel.main" "--clean" "dev"]}
           :min   {:main-opts ["-m" "figwheel.main" "-O" "advanced" "-bo" "dev"]}
           :test  {:main-opts ["-m" "figwheel.main" "-co" "test.cljs.edn" "-m" "keechma-todomvc.test-runner"]}}}

#+end_src
**** src worder.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns ^:figwheel-hooks keechma-todomvc.worder
  "# Keechma TodoMVC App"
  (:require [keechma-todomvc.components :as components]
            [keechma-todomvc.controllers.todos :as todos]
            [keechma-todomvc.subscriptions :as subscriptions]
            [goog.dom :as gdom]
            [reagent.core :as reagent :refer [atom]]
            [reagent.dom :as rdom]
            [keechma.app-state :as app-state]))

(defn multiply [a b] (* a b))

(defonce running-app (atom nil))

;; ;; ## App Definition

(def app-definition
  "Pulls the app together."
  {:routes [[":status" {:status "all"}]]
   :controllers {:todos (todos/->Controller)}
   :components components/system
   :subscriptions subscriptions/subscriptions
   :html-element (.getElementById js/document "app")})

;; ## App Lifecycle

(defn start!
  "Starts the app."
  []
  (reset! running-app (app-state/start! app-definition)))

(defn restart!
  "Restarts the app. `project.clj` contains a config setting for
  `figwheel` requesting a call to this function whenever the code is
  reloaded."
  []
  (if-let [current @running-app]
    (app-state/stop! current start!)
    (start!)))

(defn dev-setup
  "Enables console output for dev builds."
  []
  (when ^boolean js/goog.DEBUG
    (enable-console-print!)
    (println "dev mode")))

;; ;; ## Main

(defn ^:export main
  "Called from `index.html` to start the app. Exported because
  `index.html` refers to it by name even in non-dev builds."
  []
  (dev-setup)
  (start!))

(println "This text is printed from src/keechma_todomvc/worder.cljs. Go ahead and edit it and see reloading in action.")

;; define your app data so that it doesn't get over-written on reload
(defonce app-state (atom {:text "Hello world!"}))

(defn get-app-element []
  (gdom/getElement "app"))

(defn hello-world []
  [:div
   [:h1 (:text @app-state)]
   [:h3 "Edit this in src/keechma_todomvc/worder.cljs and watch it change!"]])

(defn mount [el]
  (rdom/render [hello-world] el))

(defn mount-app-element []
  (when-let [el (get-app-element)]
    (mount el)))

;; conditionally start your application based on the presence of an "app" element
;; this is particularly helpful for testing this ns without launching the app
(mount-app-element)
(dev-setup)
(start!)

specify reload hook with ^:after-load metadata
(defn ^:after-load on-reload []
  (mount-app-element)
  (dev-setup)
  (start!)
  ;; optionally touch your app-state to force rerendering depending on
  ;; your application
  ;; (swap! app-state update-in [:__figwheel_counter] inc)
)

;; (defn ^:after-load on-reload []
;;   (restart!))
#+end_src
**** –Ω—É–∂–Ω–∞ –ø–æ–º–æ—à—å
–ø—ã—Ç–∞—é—Å—å –ø—Ä–æ–µ–∫—Ç —Å lein figwheel –ø–µ—Ä–µ–ª–æ–∂–∏—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–∞ figwheel main
figwheel —Ç–µ–º–ª–ø–∞—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ –∞ –≤–æ—Ç –∫–∏—á–º–∞ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

–ø—Ä–∏—ç—Ç–æ–º –µ—Å–ª–∏ —è —É–±–∏—Ä–∞—é —á–∞—Ç—å—Å
specify reload hook with ^:after-load metadata
(defn ^:after-load on-reload []
  (mount-app-element)
  (dev-setup)
  (start!)
  ;; optionally touch your app-state to force rerendering depending on
  ;; your application
  ;; (swap! app-state update-in [:__figwheel_counter] inc)
)

–∏ –æ—Å—Ç–æ–≤–∞–ª—è—é —Ç–æ–ª—å–∫–æ
(defn ^:after-load on-reload []
  (restart!))

–ø–æ—Ö–æ–∂–æ –∫–∏—á–º –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–æ–≤—Å–µ–º.
*** –õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ —Å–µ–π—á–∞—Å

–û—Ç–∫–∞—Ç–∏—Ç—å Reagent –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é —Å–æ–≤–º–µ—Å—Ç–∏–º—É—é –≤–µ—Ä—Å–∏—é:

reagent/reagent {:mvn/version "0.10.0"}


                 [reagent "0.9.1"]
*** –æ—Ç–∫–∞—Ç
**** –ò–ò
buyn@ArchSRV:~/Dev/ClojureScript/tutorials/my-cljs-project % git status
On branch main
Your branch is up to date with 'origin/main'.

nothing to commit, working tree clean
buyn@ArchSRV:~/Dev/ClojureScript/tutorials/my-cljs-project % git log --oneline

bf51392 (HEAD -> main, origin/main) ass css
42cb6ae add files from todomvs and fix errors
d49e5f8 add deps to sorce
f92b97e add empty feegwheal templat
bb63b1b add hcain to template converter
d6a3537 add comand for conversio to main
e80a0b3 first change
d36d75d add to Woeder project copy of Toduer
61e3578 add new org project
2486e93 end risoning todomvc
6672ce9 ignor change
87f0a57 clone Keechma todomvc and start risoning
dfe18b0 start risoning
a5ae467 add projrct clone Keechma Counter
bb01003 fix home page
bf86704 new files core and note-form
c537fcb fix bide initialized
631d7d1 add massaging and UI
fe039f5 add new project noter
817e02f add chat
faffa29 Add first components
53e43de fix async
285e637 add files
4fa4514 add grup-chat project and org file
e4fe4d4 tangle error manual fix
4d43c21 start transfer all from book version
de7f8d7 new reagent test app
081e156 add grupchat org
09eaa2d end project
83f46a0 add style
da61c02 add reander header
e911ed5 tagle reander
a897a3c add rehdering
7f9948e fix test
c7b418c srart editing
4e97680 new project contacts
d766099 tagle all
9654579 add promt fun
f505989 add end vwersion of starbase


—Ö–æ—Ä–æ—à—å –º–µ–Ω—è –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç –∫–æ–º–∏—Ç
d6a3537 add comand for conversio to main
–∏ –¥–æ–≤–∞–π –ø—Ä–µ–≤—Ä–∞—Ç–∏–º –µ–≥–æ –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç—É 3 –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –±—Ä–∞–Ω—á—å.
–ø–æ—Ç–æ–º –º—ã —Å–º–æ–∂–µ–º —ç—Ç–æ –±—Ä–∞–Ω—á—å —Å–¥–µ–ª–∞—Ç—å –æ—Å–Ω–æ–≤–Ω—ã–º? –∞ —Ç–æ—Ç –∫–æ—Ç–æ—Ä—ã–π –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è?
**** 1
–î–∞, –≤—Å—ë –≤–µ—Ä–Ω–æ üëç
–¢—ã –º–æ–∂–µ—à—å —Å–ø–æ–∫–æ–π–Ω–æ —Å–¥–µ–ª–∞—Ç—å –æ—Ç –Ω—É–∂–Ω–æ–≥–æ –∫–æ–º–º–∏—Ç–∞ **–Ω–æ–≤—É—é –≤–µ—Ç–∫—É**, –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å –≤ –Ω–µ–π ‚Äî –∏ –µ—Å–ª–∏ –æ–Ω–∞ —Å—Ç–∞–Ω–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π, —Ç–æ –ø–æ—Ç–æ–º –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å `main` –Ω–∞ –Ω–µ—ë –∏–ª–∏ –≤–æ–≤—Å–µ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é.

---

## ‚úÖ –®–∞–≥ 1 ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –æ—Ç –∫–æ–º–º–∏—Ç–∞ `d6a3537`

```bash
git checkout -b new-main d6a3537
```

–ö–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—ë—Ç –≤–µ—Ç–∫—É `new-main` –∏ —Å—Ä–∞–∑—É –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç –Ω–∞ –Ω–µ—ë.

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
git status
git log --oneline
```

---

## ‚úÖ –®–∞–≥ 2 ‚Äî –∑–∞–ø—É—à–∏—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –Ω–∞ GitHub (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

```bash
git push -u origin new-main
```

---

## ‚úÖ –ß—Ç–æ –¥–∞–ª—å—à–µ –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

| –¶–µ–ª—å                                     | –ö–æ–º–∞–Ω–¥–∞                                                         |
| ---------------------------------------- | --------------------------------------------------------------- |
| –°–¥–µ–ª–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –æ—Å–Ω–æ–≤–Ω–æ–π             | —á–µ—Ä–µ–∑ UI GitHub (Settings ‚Üí Branches) –∏–ª–∏: `git branch -M main` |
| –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é `main` –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è | `git push origin --delete main`                                 |
| –ò–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ —É–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—É—é –≤–µ—Ç–∫—É        | `git branch -D main`                                            |

---

## –ï—Å–ª–∏ —Ö–æ—á–µ—à—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∑–∞–º–µ–Ω–∏—Ç—å main –Ω–æ–≤–æ–π –≤–µ—Ç–∫–æ–π

–í–∞—Ä–∏–∞–Ω—Ç –ê ‚Äî –ø–æ—Å–ª–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—Å—ë –æ–∫:

```bash
git checkout main
git reset --hard new-main
git push --force
```

–í–∞—Ä–∏–∞–Ω—Ç –ë ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –Ω–æ–≤—É—é –≤–µ—Ç–∫—É –≤ main —Å—Ä–∞–∑—É:

```bash
git branch -M main
git push -u origin main --force
```

---

–•–æ—á–µ—à—å ‚Äî —è –ø—Ä–æ—Å–ª–µ–∂—É —Å —Ç–æ–±–æ–π –∫–∞–∂–¥—ã–π —à–∞–≥ –∏ –ø—Ä–æ–≤–µ—Ä–∏–º –≤–º–µ—Å—Ç–µ, —á—Ç–æ–±—ã –Ω–∏—á–µ–≥–æ –ª–∏—à–Ω–µ–≥–æ –Ω–µ –∑–∞—Ç–µ—Ä–µ—Ç—å ‚úÖ
–ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏, –∫–æ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–º–∞–Ω–¥—É ‚Ññ1 üòé**** 

**** 2
–î–∞ ‚Äî —ç—Ç–æ –∏–¥–µ–∞–ª—å–Ω—ã–π, **—Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π** ‚úÖ
–°—Ç–∞—Ä—ã–π `main` –Ω–µ –ø—Ä–æ–ø–∞–¥—ë—Ç: –ø—Ä–æ—Å—Ç–æ –¥–∞—à—å –µ–º—É –Ω–æ–≤–æ–µ –∏–º—è, –∞ —Å–≤–µ–∂–∏–π –±—Ä–∞–Ω—á —Å—Ç–∞–Ω–µ—Ç –Ω–æ–≤—ã–º `main`.

–ü–æ—à–∞–≥–æ–≤–æ üëá

---

## ‚úÖ –®–∞–≥ 1 ‚Äî —Ç—ã —É–∂–µ –≤ `new-main` (–µ—Å–ª–∏ –Ω–µ—Ç ‚Äî –≤—ã–ø–æ–ª–Ω–∏—Ç–µ)

(–ø—Ä–µ–¥–ø–æ–ª–æ–∂–∏–º, –≤–µ—Ç–∫–∞ `new-main` —É–∂–µ —Å–æ–∑–¥–∞–Ω–∞ –æ—Ç `d6a3537`)

–ü—Ä–æ–≤–µ—Ä–∫–∞:

```bash
git branch
```

–ï—Å–ª–∏ —Ç—ã –Ω–µ –≤ `new-main`, —Ç–æ:

```bash
git checkout new-main
```

---

## ‚úÖ –®–∞–≥ 2 ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Å—Ç–∞—Ä—ã–π `main` ‚Üí –Ω–∞–ø—Ä–∏–º–µ—Ä `main-old`

```bash
git branch -m main main-old
```

–ò –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä:

```bash
git push origin main-old
```

---

## ‚úÖ –®–∞–≥ 3 ‚Äî –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ç–∫—É `new-main` ‚Üí `main`

```bash
git branch -m main
```

–ò —Å–¥–µ–ª–∞—Ç—å –µ—ë –æ—Å–Ω–æ–≤–Ω–æ–π –Ω–∞ GitHub:

```bash
git push -u origin main
```

GitHub —Å–∫–∞–∂–µ—Ç, —á—Ç–æ —Å—Ç–∞—Ä–∞—è –≤–µ—Ç–∫–∞ `main` –∏—Å—á–µ–∑–ª–∞ ‚Äî –Ω–æ —É –Ω–∞—Å –∂–µ –µ—Å—Ç—å `main-old` ‚úÖ

---

## ‚úÖ –®–∞–≥ 4 ‚Äî –ø–æ–ø—Ä–∞–≤–∏—Ç—å —É–¥–∞–ª—ë–Ω–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Å—Ç–∞—Ä—ã–π main

–ù–∞ GitHub –≤ ‚Üí **Settings ‚Üí Branches ‚Üí Default branch**
–≤—ã–±–∏—Ä–∞–µ—à—å `main`.

---

## ‚úÖ –ò—Ç–æ–≥

–¢–≤–æ—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Ç–∞–∫:

| –í–µ—Ç–∫–∞    | –ß—Ç–æ —ç—Ç–æ                           | –°–æ—Å—Ç–æ—è–Ω–∏–µ                                  |
| -------- | --------------------------------- | ------------------------------------------ |
| **main** | –Ω–æ–≤–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞ –æ—Ç `d6a3537` | –∞–∫—Ç–∏–≤–Ω–∞—è                                   |
| main-old | –±—ã–≤—à–∞—è –æ—Å–Ω–æ–≤–Ω–∞—è –≤–µ—Ç–∫–∞             | —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏, –º–æ–∂–Ω–æ —É–¥–∞–ª–∏—Ç—å –ø–æ–∑–∂–µ |

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —è –º–æ–≥—É –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–∞–∂–¥—ã–π —à–∞–≥ –≤–º–µ—Å—Ç–µ —Å —Ç–æ–±–æ–π
–¢—ã –ø—Ä–æ—Å—Ç–æ –ø–æ –æ—á–µ—Ä–µ–¥–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–π –≤—ã–≤–æ–¥ –∫–æ–º–∞–Ω–¥:

```bash
git branch
git status
```

–ì–æ—Ç–æ–≤ –ø–æ–¥—Å—Ç—Ä–∞—Ö–æ–≤–∞—Ç—å üí™üî•


**** –û—à–∏–±–∫–∞ –∑–¥–µ—Å—å –æ–∂–∏–¥–∞–µ–º–∞—è:
–û—Ç–ª–∏—á–Ω–æ, –≤—Å–µ —à–∞–≥–∏ –ø—Ä–æ—à–ª–∏ –∏–¥–µ–∞–ª—å–Ω–æ üëç
–û—Å—Ç–∞–ª—Å—è –ø–æ—Å–ª–µ–¥–Ω–∏–π –ª–æ–≥–∏—á–Ω—ã–π —à—Ç—Ä–∏—Ö ‚úÖ

–û—à–∏–±–∫–∞ –∑–¥–µ—Å—å –æ–∂–∏–¥–∞–µ–º–∞—è:

```
Updates were rejected because the tip of your current branch is behind
its remote counterpart.
```

GitHub –≤—Å—ë –µ—â—ë —Å—á–∏—Ç–∞–µ—Ç **—Å—Ç–∞—Ä—ã–π main** –≥–ª–∞–≤–Ω—ã–º –∏ –Ω–µ —Ö–æ—á–µ—Ç, —á—Ç–æ–±—ã —Ç—ã –ø–µ—Ä–µ–ø–∏—Å–∞–ª –∏—Å—Ç–æ—Ä–∏—é –æ–±—ã—á–Ω—ã–º –ø—É—à–µ–º.

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: –ø—É—à–∏–º –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ ‚Äî –Ω–æ –∞–∫–∫—É—Ä–∞—Ç–Ω–æ

–¢—ã **–Ω–∞ –Ω–æ–≤–æ–π –≤–µ—Ç–∫–µ `main`**, –≤—Å—ë —Ö–æ—Ä–æ—à–æ ‚úÖ

–í—ã–ø–æ–ª–Ω–∏:

```bash
git push -u origin main --force
```

---

## –ß—Ç–æ –±—É–¥–µ—Ç –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ?

| –í–µ—Ç–∫–∞ –Ω–∞ GitHub | –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ                           |
| --------------- | ------------------------------------ |
| **main**        | —Ç–≤–æ–π –Ω–æ–≤—ã–π main –æ—Ç `d6a3537`         |
| main-old        | –≤–µ—Å—å –ø—Ä–µ–∂–Ω–∏–π –∫–æ–¥, –Ω–∏–∫—É–¥–∞ –Ω–µ –∏—Å—á–µ–∑–Ω–µ—Ç |

---

## –ü–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ (–≤ –±—Ä–∞—É–∑–µ—Ä–µ)

–ù–∞ GitHub –∑–∞–π–¥–∏ –≤:

**Repository ‚Üí Settings ‚Üí Branches ‚Üí Default branch**

–ò –ø–µ—Ä–µ–∫–ª—é—á–∏ `Default` ‚Üí `main` (—Ç–æ—Ç —á—Ç–æ –Ω–æ–≤—ã–π).

---

–ö–æ–≥–¥–∞ —Å–¥–µ–ª–∞–µ—à—å `push --force` ‚Äî –∫–∏–Ω—å —Å—é–¥–∞ –≤—ã–≤–æ–¥.
–Ø —Ä—è–¥–æ–º, —Å—Ç—Ä–∞—Ö—É—é üòéüî•


** DONE —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–∏—Ç
** DONE —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π —Ñ–∞–∏–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
** DONE —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–∏—Ç
** DONE –∫–æ–º–ø–æ–Ω–µ—Ç –∏–∑–º–µ—Ä–∏—Ç–µ–ª—å —Ä–µ–∞–∫—Ü–∏–∏
–Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ—Ç- –∫–Ω–æ–ø–∫–∞
–º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –¥–≤—É—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö. –°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–∞–∂–∞—Ç–æ–µ\–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏ –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ–µ.
—ç—Ç–æ –∫–Ω–æ–ø–∫–∞ —Å–∏–∫—É–Ω–¥–æ–º–µ—Ä–∞.
–≤ –∞–∫—Ç–∏–≤–Ω–æ–º –æ–Ω–∞ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–æ—Ç–æ—Ä–æ–º –æ–Ω–∞ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞
–∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –≤—Ç–æ—Ä–æ–π –∫–æ–º–ø–æ–Ω–µ—Ç –∫–æ—Ç–æ—Ä—ã–π –≤—ã–≤–æ–¥–∏—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ—à–µ–¥—à–∏—Ö —Å–µ–∫—É–Ω–¥.
–ø—Ä–∏ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –æ–Ω–æ –≤—ã—Å—á–∏—Ç–≤–∞–µ—Ç —Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥ –ø—Ä–æ—à–ª–æ –∏ –∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é

–ø–æ—Å—É—Ç–µ —ç—Ç–æ –ø—Ä–∏–º–µ—Ä –∫–∞—É–Ω—Ç–µ—Ä–∞
–º–Ω–æ–≥–æ –º–æ–∂–Ω–æ –≤–∑—è—Ç—å –æ—Ç—Ç—É–¥–∞
(find-file-other-frame "~/Dev/ClojureScript/tutorials/my-cljs-project/keechma-counter/src/cljs/keechma_counter/ui/main.cljs")
[[file:keechma-counter/src/cljs/keechma_counter/ui/main.cljs::\[:button {:on-click #(ui/send-command ctx :dec)} "-"\]]]
** DONE –ø–æ–∫–∞–∑–∞—Ç–µ–ª—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–º–µ—Ä–∞ —Ä–µ–∞–∫—Ü–∏–∏
–≤–æ–∑–º–æ–∂–Ω–æ –Ω–µ –∫–æ–º–ø–æ–Ω–µ—Ç –∞ –ø—Ä–æ—Å—Ç–æ —Ö–∏–∫–∞–ø —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
** DONE –ø–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∫–æ–ø–æ–Ω–µ—Ç –≤ —Ç—É–¥—É –∏ —Ç–µ–º
** DONE –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑–∞–º–µ—Ä–∞ –≤ —Ç—É–¥—É-–∏—Ç–µ–º—Å
—É –∫–∞–∂–¥–æ–≥–æ —Ç—É–¥—É –∫–Ω–æ–ø–∫–∞ –∑–∞–º–µ—Ä–∏—Ç—å –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–º–µ—Ä–∞
** DONE —Å–¥–µ–ª–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π –æ—Ä–≥
(find-file-other-frame "/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/worder-cljs-project.org")
** DONE —Å–¥–µ–ª–∞—Ç—å –∫–æ–ø–∏—é –ø—Ä–æ–µ–∫—Ç–∞
** DONE –∑–∞–º–µ–Ω–∏—Ç—å –≤ —Ä–∞–∑–¥–µ–ª–µ —Ñ–∞–π–ª–æ–≤ –Ω–∞ –Ω–æ–≤—ã–π –ø—É—Ç—å
** DONE –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —Å–ª–æ–≤
*** src
**** file components/app.cljs
(find-file-other-frame "./src/keechma_todomvc/components/app.cljs")
**** src components/app.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]))

(defn render
  [ctx]
  [:<>
   [:section.todoapp
    [:header.header
     [:h1 "Worder"]
     [comp> ctx :new-todo]]
    (when (sub> ctx :has-todos?)
      [:<>
       [:section.main
        [comp> ctx :toggle-todos]
        [comp> ctx :todo-list]]
       [comp> ctx :footer]])]
   [:footer.info
    [:p "Double-click to edit a todo"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "http://todomvc.com"} "TodoMVC"]]]])

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :footer]
         :subscription-deps [:has-todos?]))

#+end_src


*** –î–æ–≤–∞–π –≤ components/app.cljs —Å–¥–µ–ª–∞–µ–º –∫–Ω–æ–ø–∫—É
—Ä–∞–∑–º–µ—Å—Ç–∏–º –ø–æ–¥ —Ç–∞–π—Ç–ª–æ–º –í–æ—Ä–¥–µ—Ä.
–æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ—Å–∏—Ç—å —é–∑–µ—Ä–∞ —É–∫–∞–∑–∞—Ç—å –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏.
—á–∏—Ç–∞—Ç—å —ç—Ç–æ—Ç —Ñ–∞–∏–ª. –ü–∞—Ä—Å–∏—Ç—å –µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç –Ω–∞ —Å—Ç—Ä–æ–∫–∏.
–∏ –¥–æ–±–æ–≤–ª—è—Ç—å –∫–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É, –∫–∞–∫ –Ω–æ–≤–æ–µ —Ç—É–¥—É.

*** –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
–°—É–ø–µ—Ä! –í–æ—Ç –∫–∞–∫ –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª "–∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–∞ ‚Üí –ø–∞—Ä—Å–∏–Ω–≥ —Å—Ç—Ä–æ–∫ ‚Üí –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω–æ–µ todo" –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è Keechma + Reagent. –Ø –¥–∞–º **—à–∞–≥-–∑–∞-—à–∞–≥–æ–º** + –∫–æ–¥-–ø—Ä–∏–º–µ—Ä.

---
## üîç –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

1. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –∏–ª–∏ –∏–Ω–ø—É—Ç `<input type="file">` –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç.
2. –ü—Ä–∏ –≤—ã–±–æ—Ä–µ —Ñ–∞–π–ª–∞ ‚Äî –ø—Ä–æ—á–∏—Ç–∞—Ç—å –µ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ (FileReader API) ([MDN Web Docs][1]).
3. –†–∞–∑–±–∏—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –Ω–∞ —Å—Ç—Ä–æ–∫–∏ (`.split("\n")`).
4. –î–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –≤—ã–∑–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞ `:create-todo` (–∏–ª–∏ –∞–Ω–∞–ª–æ–≥) —Å —ç—Ç–æ–π —Å—Ç—Ä–æ–∫–æ–π –∫–∞–∫ –∑–∞–≥–æ–ª–æ–≤–æ–∫.
5. –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–æ–≥—Ä–µ—Å—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä ‚Äú–¥–æ–±–∞–≤–ª–µ–Ω–æ N –∑–∞–¥–∞—á‚Äù).
6. –û–±–µ—Å–ø–µ—á–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫ (–ø—É—Å—Ç–æ–π —Ñ–∞–π–ª, —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏ —Ç.–¥.).

---

## üßÆ –ü—Ä–∏–º–µ—Ä –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: `file-import-button.cljs`

```clojure
(ns keechma-todomvc.components.file-import-button
  (:require [reagent.core :as r]
            [keechma-todomvc.ui :refer [<cmd <comp]]))

(defn render‚Äêimport [_ctx]
  (let [file-ref (r/atom nil)]
    (fn []
      [:div.file-import
       [:input {:type "file"
                :accept ".txt"
                :on-change (fn [e]
                             (let [file (-> e .-target .-files (aget 0))]
                               (when file
                                 (let [reader (js/FileReader.)]
                                   (set! (.-onload reader)
                                         (fn [evt]
                                           (let [text (.. evt -target -result)
                                                 lines (.split text "\n")]
                                             (doseq [line lines
                                                     :let [trimmed (clojure.string/trim line)]
                                                     :when (not (clojure.string/blank? trimmed))]
                                               (<cmd _ctx :create-todo trimmed)))))
                                   (.readAsText reader file))))]
        ]
       [:button {:on-click #(when @file-ref (.click @file-ref))}
        "Import todo-file"]])))
```

–ò —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤ —Å–∏—Å—Ç–µ–º–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:

```clojure
;; –≤ components.cljs
:import-todos (assoc file-import-button/component :topic :todos)
```

---

## ‚úÖ –ß—Ç–æ –≤–∞–∂–Ω–æ —É—á–µ—Å—Ç—å

  * –ö–æ–º–∞–Ω–¥–∞ `:create-todo` –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä –¥–æ–ª–∂–µ–Ω —Å–ª—É—à–∞—Ç—å –µ—ë (—É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å `create-todo`).
  * –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `<cmd _ctx :create-todo trimmed>` –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç –∞—Ä–≥—É–º–µ–Ω—Ç (–≤ –≤–∏–¥–µ —Å—Ç—Ä–æ–∫–∏ –∏–ª–∏ map) –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä.
  * –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ `FileReader.readAsText()` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤. ([MDN Web Docs][2])
  * –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `clojure.string/trim` –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫ ‚Äî —á—Ç–æ–±—ã –Ω–µ —Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–¥–∞—á–∏ —Å –ø—É—Å—Ç—ã–º –∑–∞–≥–æ–ª–æ–≤–∫–æ–º.
  * –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –¥–æ–±–∞–≤–∏—Ç—å UI-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏, –ø–æ–∫–∞–∑–∞—Ç—å —Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ –¥–æ–±–∞–≤–ª–µ–Ω–æ –∏ —Ç.–¥.

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å **–ø–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π —Ñ–∞–π–ª** —Å CSS-—Å—Ç–∏–ª—è–º–∏, –∫–Ω–æ–ø–∫–æ–π –≤ —Å—Ç—Ä–æ–∫–µ `todo-item` (—á—Ç–æ–±—ã –æ–Ω –ø–æ—è–≤–∏–ª—Å—è —Ä—è–¥–æ–º —Å —Ç–∞–π–º–µ—Ä–æ–º –∏ –∫–Ω–æ–ø–∫–æ–π —É–¥–∞–ª–µ–Ω–∏—è) + –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π –≤ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä, —á—Ç–æ–±—ã –≤—Å—ë ‚Äú–∏–∑ –∫–æ—Ä–æ–±–∫–∏‚Äù —Ä–∞–±–æ—Ç–∞–ª–æ. –°–¥–µ–ª–∞—Ç—å?

[1]: https://developer.mozilla.org/en-US/docs/Web/API/File_API/Using_files_from_web_applications?utm_source=chatgpt.com "Using files from web applications - Web APIs | MDN - Mozilla"
[2]: https://developer.mozilla.org/en-US/docs/Web/API/FileReader/readAsText?utm_source=chatgpt.com "FileReader: readAsText() method - Web APIs - MDN Web Docs"

*** –∫–æ–¥ –¥–ª—è `components/app.cljs`
–û—Ç–ª–∏—á–Ω–∞—è –∏–¥–µ—è üí™ ‚Äî –¥–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–º–ø–æ—Ä—Ç–∞, —Å–ø—Ä–∞—à–∏–≤–∞–µ–º –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É, —á–∏—Ç–∞–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ, —Ä–∞–∑–±–∏–≤–∞–µ–º –ø–æ —Å—Ç—Ä–æ–∫–∞–º ‚Üí —Å–æ–∑–¥–∞—ë–º todos.

---

## ‚úÖ –ü–ª–∞–Ω

1. –î–æ–±–∞–≤–ª—è–µ–º –≤ UI –∫–Ω–æ–ø–∫—É **"Import from file"**
2. –ò—Å–ø–æ–ª—å–∑—É–µ–º `<input type="file">` —á–µ—Ä–µ–∑ Reagent ref
3. –ß–∏—Ç–∞–µ–º —Ñ–∞–π–ª —á–µ—Ä–µ–∑ `js/FileReader`
4. –ö–∞–∂–¥—É—é —Å—Ç—Ä–æ–∫—É –ø–µ—Ä–µ–¥–∞—ë–º –≤ `<cmd ctx :create-todo ...>`

---

## ‚úÖ –ü–æ–ª–Ω—ã–π —Ä–∞–±–æ—á–∏–π –∫–æ–¥ –¥–ª—è `components/app.cljs`

üîª –ù–∏–∂–µ —É–∂–µ –≥–æ—Ç–æ–≤—ã–π, –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Å–Ω–∏–ø–ø–µ—Ç:

```clojure
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<cmd <comp comp> sub>]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)]
    (set! (.-onload reader)
          (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t)))))))
    (.readAsText reader file)))

(defn render [ctx]
  (let [file-input (r/atom nil)]
    (fn [ctx]
      [:<>
       [:section.todoapp
        [:header.header
         [:h1 "Worder"]
         ;; ---- –ù–ê–®–ê –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê ----
         [:div
          [:input {:type "file"
                   :style {:display "none"}
                   :ref #(reset! file-input %)
                   :on-change #(import-file ctx %)}]
          [:button {:on-click #(.click @file-input)}
           "Import from file"]]
         ;; --------------------------
         [comp> ctx :new-todo]]
        (when (sub> ctx :has-todos?)
          [:<>
           [:section.main
            [comp> ctx :toggle-todos]
            [comp> ctx :todo-list]]
           [comp> ctx :footer]])]
       [:footer.info
        [:p "Double-click to edit a todo"]
        [:p
         [:a {:href "https://keechma.com"} "Keechma"] " "
         [:a {:href "http://todomvc.com"} "TodoMVC"]]]])))

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :footer]
         :subscription-deps [:has-todos?]))
```

---

## ‚úÖ –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

| –î–µ–π—Å—Ç–≤–∏–µ               | –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç                                              |
| ---------------------- | ----------------------------------------------------------- |
| –¢—ã –∫–ª–∏–∫–∞–µ—à—å –∫–Ω–æ–ø–∫—É ‚úÖ   | –°–∫—Ä—ã—Ç—ã–π `<input type="file">` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–∞ |
| –í—ã–±–æ—Ä —Ñ–∞–π–ª–∞            | `FileReader` —á–∏—Ç–∞–µ—Ç —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ                              |
| –ß—Ç–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ       | –¢–µ–∫—Å—Ç ‚Üí —Å—Ç—Ä–æ–∫–∏ ‚Üí `create-todo` –∫–æ–º–∞–Ω–¥–æ–π                     |
| Keechma UI –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è | –ì–æ—Ç–æ–≤–æ üéâ                                                   |

---

## ‚è´ –ü–ª–∞–Ω—ã –Ω–∞ —É–ª—É—á—à–µ–Ω–∏–µ?

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî –º–æ–≥—É —Å—Ä–∞–∑—É —Å–¥–µ–ª–∞—Ç—å:

‚úÖ –∏–≥–Ω–æ—Ä –ø—É—Å—Ç—ã—Ö —Å—Ç—Ä–æ–∫
‚úÖ trim –∫–∞–≤—ã—á–µ–∫
‚úÖ –∏—Å–∫–ª—é—á–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
‚úÖ –ø–æ–¥—Å–≤–µ—á–∏–≤–∞—Ç—å –æ—à–∏–±–∫–∏ —Ñ–∞–π–ª–∞
‚úÖ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
‚úÖ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª-—Ñ–æ—Ä–º–∞—Ç (.txt, .csv, .json)

---

–•–æ—á–µ—à—å —Å–¥–µ–ª–∞—Ç—å –æ–±—Ä–∞—Ç–Ω—É—é —Ñ–∏—á—É?
üì§ Export todos ‚Üí –≤ JSON –∏–ª–∏ TXT?

–°–∫–∞–∂–∏ ‚Äî —Å–¥–µ–ª–∞—é ‚ù§Ô∏è

*** 

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)
        onload-evt (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t))))))
        result (set! (.-onload reader) onload-evt 
        (.readAsText reader file))
        )]

** DONE –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ª–æ–≤–∞ 
*** raw
–≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å—Ä–∞–∑—É –≤—Å–µ –≤ —Ç–µ–∫—Å—Ç
—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–∏–ª
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
—Å–æ—Ö—Ä–æ–Ω—è—Ç—å —Ç–µ —á—Ç–æ –≤ –¥–∞–Ω—ã–π –º–æ–º–µ–Ω—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã
—Ç–æ–µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ as .txt"
—Ç–æ–µ—Å—Ç—å –ª–∏–±–æ –≤—Å–µ –ª–∏–±–æ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ –ª–∏–±–æ –Ω–µ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
*** src
**** keechma-todomvc.components.todo-list
(ns keechma-todomvc.components.todo-list
  "# Todo List component"
  (:require [keechma-todomvc.ui :refer [<comp comp> route> sub>]]))

(defn render
  "## Renders a list of currently visible todos

  `todo` visiblity is controlled by the current `route`.

### Component Deps

- `:todo-item` Each list item is rendered by a `:todo-item` component
  that receives the `todo` and the calculated `is-editing?` value as
  arguments.

### Subscription Deps

- `:todos-by-status` returns `todos` with a `status`
- `:edit-todo` returns the `todo` currently being edited, or nil"
  [ctx]
  (let [route-status (keyword (route> ctx :status))
        is-editing? (fn [id] (= id (:id (sub> ctx :edit-todo))))
        todo-item (fn [{id :id :as todo}]
                    ^{:key id} [comp> ctx :todo-item todo (is-editing? id)])]
    [:ul.todo-list
     (doall (map todo-item (sub> ctx :todos-by-status route-status)))]))

(def component
  (<comp :renderer render
         :component-deps [:todo-item]
         :subscription-deps [:todos-by-status
                             :edit-todo]))
**** keechma-todomvc.subscriptions
(ns keechma-todomvc.subscriptions
  "# Todo Subscriptions

  Subscription functions return `reagent reactions` that cause
  subscribed UI `components` to re-render when the value managed by
  the `reaction` changes."
  (:require [keechma-todomvc.entities.todo :as todo]
            [reagent.ratom :refer-macros [reaction]]))

;; ## Todos List

(defn todos-by-status
  "Returns a `reaction` on the list of `todos` with a `status`."
  [app-db status]
  (reaction
   (todo/todos-by-status @app-db status)))

(defn count-todos-by-status
  "Derived `reaction` that returns the `count` of `todos` with a
  `status`. Fires only when the `count` changes, independent of the
  details of the list contents."
  [app-db status]
  (reaction
   (count @(todos-by-status app-db status))))

(defn has-todos-by-status?
  "Derived `reaction` that returns `true` if any `todos` with a `status`
  exist. Fires only on a transition either way between `none` and
  `some`, independent of the details of the list contents."
  [app-db status]
  (reaction
   (some? (seq @(todos-by-status app-db status)))))

(defn has-todos?
  "Returns a `reaction` that indicates if there are currently any `todos`
  at all."
  [app-db]
  (has-todos-by-status? app-db :all))

;; ## Todo Editing

(defn edit-todo
  "Returns a `reaction` on the `todo` that is being edited."
  [app-db]
  (reaction
   (todo/edit-todo @app-db)))

(def subscriptions {:todos-by-status todos-by-status
                    :count-todos-by-status count-todos-by-status
                    :has-todos-by-status? has-todos-by-status?
                    :has-todos? has-todos?
                    :edit-todo edit-todo})
*** –ø–æ–º–æ–≥–∏ —Å–¥–µ–ª–∞—Ç—å –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
–Ω–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞.
–æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–∏–æ–ª–æ–≥ —Å–æ—Ö—Ä–∞–Ω–µ–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞.
—Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–∏–ª, –≤ –∫–æ—Ç–æ—Ä–æ–º –∫–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ —ç—Ç–æ —Ç—É–¥—É –∏ —á–µ—Ä–µ–∑ —Å–∏–º–≤–æ–ª "—Ç–∞–±–∞" –∑–Ω–∞—á–∞–µ–Ω–∏–µ —Å–µ–∫—É–Ω–¥. –µ—Å–ª–∏ —Å–µ–∫—É–Ω–¥ –Ω–µ—Ç —Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ = 0.
—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏ –Ω–µ –≤—Å–µ—Ö —Ç—É–¥—É –∞ –≤—ã–±—Ä–∞–Ω—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–º –≤ –¥–∞–Ω—ã–π –º–æ–º–µ–Ω—Ç.
*** 01 –æ—É—Ç
–û—Ç–ª–∏—á–Ω–æ, —Å–¥–µ–ª–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç **Export TXT** —Ä—è–¥–æ–º —Å —Ç–≤–æ–∏–º Import-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º üí™
(–ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —à–∞–±–ª–æ–Ω.)

---

## ‚úÖ –¢–≤–æ–π –≤–æ–ø—Ä–æ—Å –ø—Ä–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

–≠—Ç–æ—Ç –±–ª–æ–∫:

```clojure
[:div
 [:input {:type "file"
          :style {:display "none"}
          :ref #(reset! file-input %)
          :on-change #(import-file ctx %)}]
 [:button {:on-click #(.click @file-input)}
  "üìéImport from file"]]
```

–û–±—ä—è—Å–Ω–µ–Ω–∏–µ:

| –≠–ª–µ–º–µ–Ω—Ç                       | –ó–∞—á–µ–º                                                        |
| ----------------------------- | ------------------------------------------------------------ |
| `input[type=file]`            | –Ω–∞—Å—Ç–æ—è—â–∏–π –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞                                        |
| `display: none`               | —Å–∫—Ä—ã—Ç ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –≤–∏–¥–∏—Ç                                |
| `:ref #(reset! file-input %)` | —Å–æ—Ö—Ä–∞–Ω—è–µ–º DOM-—ç–ª–µ–º–µ–Ω—Ç –≤ –∞—Ç–æ–º ‚Üí –¥–ª—è –≤—ã–∑–æ–≤–∞ `.click`           |
| `on-change`                   | —á–∏—Ç–∞–µ—Ç —Ñ–∞–π–ª –∏ —Å–æ–∑–¥–∞—ë—Ç todos                                  |
| `button`                      | –≤–∏–¥–∏–º–∞—è –∫–Ω–æ–ø–∫–∞, –ø–æ –Ω–∞–∂–∞—Ç–∏—é —Å–∏–º—É–ª–∏—Ä—É–µ—Ç –∫–ª–∏–∫ –ø–æ —Å–∫—Ä—ã—Ç–æ–º—É input |

### –¢–æ –µ—Å—Ç—å:

–ö–ª–∏–∫–∞–µ–º –∫–Ω–æ–ø–∫—É ‚Üí JS —Å–∏–º—É–ª–∏—Ä—É–µ—Ç –≤—ã–±–æ—Ä —Ñ–∞–π–ª–∞ ‚Üí on-change –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –µ–≥–æ üéØ

---

## ‚úÖ –¢–µ–ø–µ—Ä—å —Å–æ–∑–¥–∞—ë–º –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî **Export TXT**

üìå –§–∞–π–ª: `src/keechma_todomvc/components/export_txt.cljs`

```clojure
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub>]]
            [clojure.string :as str]))

(defn download-file [filename content]
  (let [blob (js/Blob. #js [content] #js {:type "text/plain"})
        url (js/URL.createObjectURL blob)
        a (.createElement js/document "a")]
    (set! (.-href a) url)
    (set! (.-download a) filename)
    (.appendChild js/document.body a)
    (.click a)
    (.removeChild js/document.body a)
    (js/URL.revokeObjectURL url)))

(defn render [ctx]
  (let [todos (sub> ctx :todos :all)]
    [:button
     {:on-click
      (fn []
        (let [export-text
              (->> todos
                   (map (fn [{:keys [title time]}]
                          (str title "\t" (or time 0))))
                   (str/join "\n"))]
          (download-file "todos_export.txt" export-text)))}
     "üíæ Export todos to TXT"]))

(def component
  (<comp :renderer render))
```

---

### –í—Å—Ç–∞–≤–ª—è–µ–º –≤ `components.cljs`

```clojure
(ns keechma-todomvc.components
  ...
  (:require
    ...
    [keechma-todomvc.components.import-txt :as import-txt]
    [keechma-todomvc.components.export-txt :as export-txt]))
```

–í —Å–∏—Å—Ç–µ–º—É:

```clojure
:import-txt import-txt/component
:export-txt export-txt/component
```

---

### –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤ UI

–ù–∞–ø—Ä–∏–º–µ—Ä ‚Äî –≤ —Ñ—É—Ç–µ—Ä–µ –∏–ª–∏ –≤ `app/component`:

```clojure
[comp> ctx :export-txt]
[comp> ctx :import-txt]
```

---

## ‚úÖ –†–µ–∑—É–ª—å—Ç–∞—Ç

| –î–µ–π—Å—Ç–≤–∏–µ              | –†–µ–∑—É–ª—å—Ç–∞—Ç                    |
| --------------------- | ---------------------------- |
| –ù–∞–∂–∞–ª **Export**      | –ó–∞–≥—Ä—É–∂–∞–µ—Ç `todos_export.txt` |
| –§–æ—Ä–º–∞—Ç —Å—Ç—Ä–æ–∫–∏         | `"title<TAB>seconds"`        |
| –ï—Å–ª–∏ `time` –Ω–µ—Ç ‚Üí `0` | ‚úÖ                            |

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å:
‚úî –¥–æ–±–∞–≤–∏—Ç—å BOM ‚Üí —á—Ç–æ–±—ã UTF-8 –Ω–∞ Windows —á–∏—Ç–∞–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
‚úî —Å–æ—Ö—Ä–∞–Ω—è—Ç—å —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É (active ‚Üí completed)
‚úî –¥–µ–ª–∞—Ç—å backup-timestamp –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
‚úî –¥–æ–±–∞–≤–∏—Ç—å –¥–∏–∞–ª–æ–≥ –≤—ã–±–æ—Ä–∞ –∏–º–µ–Ω–∏ —Å `<input type="file" nwsaveas>` (Electron)

---

–•–æ—á–µ—à—å ‚Äî —è –µ—â—ë —Å–¥–µ–ª–∞—é **–æ–±—Ä–∞—Ç–Ω—ã–π –∏–º–ø–æ—Ä—Ç**, —á—Ç–æ–±—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–ª —Ñ–æ—Ä–º–∞—Ç —Å –≤—Ä–µ–º—èÃÅ–º–∏ –∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–ª `:time` ‚úÖ
*** 02 –æ—É—Ç
–û—Ç–ª–∏—á–Ω–æ ‚Äî —É —Ç–µ–±—è —É–∂–µ –µ—Å—Ç—å `import_txt.cljs`, —Ç–∞–∫ —á—Ç–æ —Å–¥–µ–ª–∞–µ–º **—Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã–π** –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: —ç–∫—Å–ø–æ—Ä—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö (–æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã—Ö) todos –≤ `.txt`.

---

## ‚úÖ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

‚úî –ö–Ω–æ–ø–∫–∞ ¬´Export¬ª
‚úî –ë–µ—Ä—ë—Ç —Å–ø–∏—Å–æ–∫ —Ç–µ–∫—É—â–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞:
`(sub> ctx :todos-by-status route-status)`
‚úî –§–æ—Ä–º–∞—Ç –≤ —Ñ–∞–π–ª–µ:

```
<todo title>\t<time>
```

–ï—Å–ª–∏ –≤—Ä–µ–º–µ–Ω–∏ –Ω–µ—Ç ‚Üí `0`
‚úî –û—Ç–∫—Ä—ã–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π save-dialog —á–µ—Ä–µ–∑ Blob + download

---

## ‚úÖ –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: `export_txt.cljs`

üìå –ü—É—Ç—å:

```
./src/keechma_todomvc/components/export_txt.cljs
```

```clojure
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title "\t" (or time 0)))
                   todos)
        content (str/join "\n" lines)
        blob (js/Blob. #js [content] #js {:type "text/plain"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    (set! (.-href a) url)
    (set! (.-download a) "todos.txt")
    (.click a)
    (.revokeObjectURL js/URL url)))

(defn render [ctx]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button {:on-click #(export-file @todos)}
     "üíæ Export to text"]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))
```

---

## ‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

–í `components/system`

–¥–æ–±–∞–≤–∏—Ç—å:

```clojure
:export-txt export-txt/component
```

---

## ‚úÖ –í—Å—Ç–∞–≤–∫–∞ –∫–Ω–æ–ø–∫–∏ –≤ UI

–ù–∞–ø—Ä–∏–º–µ—Ä –≤ footer:

```clojure
[comp> ctx :export-txt]
```

---

## üß™ –ü—Ä–æ–≤–µ—Ä–∫–∞

–§–∏–ª—å—Ç—Ä –≤ URL:

```
/active
/completed
```

–ù–∞–∂–∏–º–∞–µ–º **Export** ‚Üí —Ñ–∞–π–ª `todos.txt` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ.

---

## ‚≠ê –•–æ—á–µ—à—å —É–ª—É—á—à–µ–Ω–∏–π?

–ú–æ–≥—É –¥–æ–±–∞–≤–∏—Ç—å –ª—é–±—É—é –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π:

| –§–∏—á–∞                                         | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è                 |
| -------------------------------------------- | -------------------------- |
| –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞ —Å –¥–∞—Ç–æ–π               | ‚úÖ `"todos-2025-11-01.txt"` |
| UTF-8 BOM –¥–ª—è Windows/Excel                  | ‚úÖ                          |
| –í—ã–≥—Ä—É–∑–∫–∞ **–≤—Å–µ—Ö** —Ç—É–¥—É –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —Ñ–∏–ª—å—Ç—Ä–∞ | ‚úÖ                          |
| JSON —ç–∫—Å–ø–æ—Ä—Ç –¥–ª—è –±—ç–∫–∞–ø–∞                      | ‚úÖ                          |
| CSV —ç–∫—Å–ø–æ—Ä—Ç                                  | ‚úÖ                          |
| ZIP —Å –∏—Å—Ç–æ—Ä–∏–µ–π                               | ‚úÖ                          |

---

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å ‚Äî —è –º–æ–≥—É —Å—Ä–∞–∑—É —Å–¥–µ–ª–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç **Export + Import** –≤ –æ–¥–Ω–æ–º –≤—ã–ø–∞–¥–∞—é—â–µ–º –º–µ–Ω—é, —á—Ç–æ–±—ã –≤—ã–≥–ª—è–¥–µ–ª–æ –∫—Ä–∞—Å–∏–≤–æ, –∞ –Ω–µ –¥–≤—É–º—è –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏.
*** src
**** file style.css
(find-file-other-frame "./resources/public/css/style.css")
**** src style.css
***** all
#+begin_src css :no-expand t :mkdirp yes 
/* Source: https://github.com/tastejs/todomvc-app-css/blob/v2.1.0/index.css */
html,
body {
    margin: 0;
    padding: 0;
}

button {
    margin: 0;
    padding: 0;
    border: 0;
    background: none;
    font-size: 100%;
    vertical-align: baseline;
    font-family: inherit;
    font-weight: inherit;
    color: inherit;
    -webkit-appearance: none;
    appearance: none;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font: 14px 'Helvetica Neue', Helvetica, Arial, sans-serif;
    line-height: 1.4em;
    background: #f5f5f5;
    color: #4d4d4d;
    min-width: 230px;
    max-width: 550px;
    margin: 0 auto;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-weight: 300;
}

:focus {
    outline: 0;
}

.hidden {
    display: none;
}

.todoapp {
    background: #fff;
    margin: 130px 0 40px 0;
    position: relative;
    box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.2),
                0 25px 50px 0 rgba(0, 0, 0, 0.1);
}

.todoapp input::-webkit-input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::-moz-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp input::input-placeholder {
    font-style: italic;
    font-weight: 300;
    color: #e6e6e6;
}

.todoapp h1 {
    position: absolute;
    top: -155px;
    width: 100%;
    font-size: 100px;
    font-weight: 100;
    text-align: center;
    color: rgba(175, 47, 47, 0.15);
    -webkit-text-rendering: optimizeLegibility;
    -moz-text-rendering: optimizeLegibility;
    text-rendering: optimizeLegibility;
}

.new-todo,
.edit {
    position: relative;
    margin: 0;
    width: 100%;
    font-size: 24px;
    font-family: inherit;
    font-weight: inherit;
    line-height: 1.4em;
    border: 0;
    color: inherit;
    padding: 6px;
    border: 1px solid #999;
    box-shadow: inset 0 -1px 5px 0 rgba(0, 0, 0, 0.2);
    box-sizing: border-box;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

.new-todo {
    padding: 16px 16px 16px 60px;
    border: none;
    background: rgba(0, 0, 0, 0.003);
    box-shadow: inset 0 -2px 1px rgba(0,0,0,0.03);
}

.main {
    position: relative;
    z-index: 2;
    border-top: 1px solid #e6e6e6;
}

.toggle-all {
    text-align: center;
    border: none; /* Mobile Safari */
    opacity: 0;
    position: absolute;
}

.toggle-all + label {
    width: 60px;
    height: 34px;
    font-size: 0;
    position: absolute;
    top: -52px;
    left: -13px;
    -webkit-transform: rotate(90deg);
    transform: rotate(90deg);
}

.toggle-all + label:before {
    content: '‚ùØ';
    font-size: 22px;
    color: #e6e6e6;
    padding: 10px 27px 10px 27px;
}

.toggle-all:checked + label:before {
    color: #737373;
}

.todo-list {
    margin: 0;
    padding: 0;
    list-style: none;
}

.todo-list li {
    position: relative;
    font-size: 24px;
    border-bottom: 1px solid #ededed;
}

.todo-list li:last-child {
    border-bottom: none;
}

.todo-list li.editing {
    border-bottom: none;
    padding: 0;
}

.todo-list li.editing .edit {
    display: block;
    width: 506px;
    padding: 12px 16px;
    margin: 0 0 0 43px;
}

.todo-list li.editing .view {
    display: none;
}

.todo-list li .toggle {
    text-align: center;
    width: 40px;
    /* auto, since non-WebKit browsers doesn't support input styling */
    height: auto;
    position: absolute;
    top: 0;
    bottom: 0;
    margin: auto 0;
    border: none; /* Mobile Safari */
    -webkit-appearance: none;
    appearance: none;
}

.todo-list li .toggle {
    opacity: 0;
}

.todo-list li .toggle + label {
    /*
        Firefox requires `#` to be escaped - https://bugzilla.mozilla.org/show_bug.cgi?id=922433
        IE and Edge requires *everything* to be escaped to render, so we do that instead of just the `#` - https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7157459/
   ,*/
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23ededed%22%20stroke-width%3D%223%22/%3E%3C/svg%3E');
    background-repeat: no-repeat;
    background-position: center left;
}

.todo-list li .toggle:checked + label {
    background-image: url('data:image/svg+xml;utf8,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2240%22%20height%3D%2240%22%20viewBox%3D%22-10%20-18%20100%20135%22%3E%3Ccircle%20cx%3D%2250%22%20cy%3D%2250%22%20r%3D%2250%22%20fill%3D%22none%22%20stroke%3D%22%23bddad5%22%20stroke-width%3D%223%22/%3E%3Cpath%20fill%3D%22%235dc2af%22%20d%3D%22M72%2025L42%2071%2027%2056l-4%204%2020%2020%2034-52z%22/%3E%3C/svg%3E');
}

.todo-list li label {
    word-break: break-all;
    padding: 15px 15px 15px 60px;
    display: block;
    line-height: 1.2;
    transition: color 0.4s;
}

.todo-list li.completed label {
    color: #d9d9d9;
    text-decoration: line-through;
}

.todo-list li .destroy {
    display: none;
    position: absolute;
    top: 0;
    right: 10px;
    bottom: 0;
    width: 40px;
    height: 40px;
    margin: auto 0;
    font-size: 30px;
    color: #cc9a9a;
    margin-bottom: 11px;
    transition: color 0.2s ease-out;
}

.todo-list li .destroy:hover {
    color: #af5b5e;
}

.todo-list li .destroy:after {
    content: '√ó';
}

.todo-list li:hover .destroy {
    display: block;
}

.todo-list li .edit {
    display: none;
}

.todo-list li.editing:last-child {
    margin-bottom: -1px;
}

.footer {
    color: #777;
    padding: 10px 15px;
    height: 20px;
    text-align: center;
    border-top: 1px solid #e6e6e6;
}

.footer:before {
    content: '';
    position: absolute;
    right: 0;
    bottom: 0;
    left: 0;
    height: 50px;
    overflow: hidden;
    box-shadow: 0 1px 1px rgba(0, 0, 0, 0.2),
                0 8px 0 -3px #f6f6f6,
                0 9px 1px -3px rgba(0, 0, 0, 0.2),
                0 16px 0 -6px #f6f6f6,
                0 17px 2px -6px rgba(0, 0, 0, 0.2);
}

.todo-count {
    float: left;
    text-align: left;
}

.todo-count strong {
    font-weight: 300;
}

.filters {
    margin: 0;
    padding: 0;
    list-style: none;
    position: absolute;
    right: 0;
    left: 0;
}

.filters li {
    display: inline;
}

.filters li a {
    color: inherit;
    margin: 3px;
    padding: 3px 7px;
    text-decoration: none;
    border: 1px solid transparent;
    border-radius: 3px;
}

.filters li a:hover {
    border-color: rgba(175, 47, 47, 0.1);
}

.filters li a.selected {
    border-color: rgba(175, 47, 47, 0.2);
}

.clear-completed,
html .clear-completed:active {
    float: right;
    position: relative;
    line-height: 20px;
    text-decoration: none;
    cursor: pointer;
}

.clear-completed:hover {
    text-decoration: underline;
}

.info {
    margin: 65px auto 0;
    color: #bfbfbf;
    font-size: 10px;
    text-shadow: 0 1px 0 rgba(255, 255, 255, 0.5);
    text-align: center;
}

.info p {
    line-height: 1;
}

.info a {
    color: inherit;
    text-decoration: none;
    font-weight: 400;
}

.info a:hover {
    text-decoration: underline;
}

/*
    Hack to remove background from Mobile Safari.
    Can't use it globally since it destroys checkboxes in Firefox
,*/
@media screen and (-webkit-min-device-pixel-ratio:0) {
    .toggle-all,
    .todo-list li .toggle {
        background: none;
    }

    .todo-list li .toggle {
        height: 40px;
    }
}

@media (max-width: 430px) {
    .footer {
        height: 50px;
    }

    .filters {
        bottom: 10px;
    }
}
#+end_src
***** /* === Timer Component Styling Fit for TodoMVC === */
#+begin_src css :no-expand t :mkdirp yes 
.todo-list li .timer {
    display: inline-flex;
    align-items: center;
    margin-left: auto; 
}

.todo-list li .timer button {
    font-size: 13px;           
    padding: 7px 13px;         
    background: none;
    border: 2px solid #ccc;
    border-radius: 4px;
    cursor: pointer;
    color: #555;
    transition: all 0.2s ease-out;
}

.todo-list li .timer button:hover {
    background: #eee;
    border-color: #bbb;
    color: #333;
}

/* —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–≥–¥–∞ —Ç–∞–π–º–µ—Ä –∑–∞–ø—É—â–µ–Ω */
.todo-list li .timer.running button {
    background: #27ae60;
    border-color: #1e874b;
    color: #fff;
}

.todo-list li.completed .timer .seconds {
    color: #d9d9d9;
}

.todo-list li .timer .seconds {
    margin-left: 8px;
    font-size: 14px;
    color: #777;
}


#+end_src
**** file components/app.cljs
(find-file-other-frame "./src/keechma_todomvc/components/app.cljs")
**** src components/app.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]))


(defn render
  [ctx]
  [:<>
   [:section.todoapp
    [:header.header
     [:h1 "Worder"]
     [comp> ctx :import-txt]
     [comp> ctx :new-todo]]
    (when (sub> ctx :has-todos?)
      [:<>
       [:section.main
        [comp> ctx :toggle-todos]
        [comp> ctx :todo-list]]
       [comp> ctx :footer]])]
   [:footer.info
    [comp> ctx :export-txt]
    [:p "Double-click to edit a Word"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "http://todomvc.com"} "Freeman"]]]])

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :import-txt
                          :export-txt
                          :footer]
         :subscription-deps [:has-todos?]))

#+end_src

**** file import_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/import_txt.cljs")
**** src import_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.import-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn import-file [ctx e]
  (let [file (-> e .-target .-files (aget 0))
        reader (js/FileReader.)
        onload-evt (fn [evt]
            (let [content (.. evt -target -result)
                  lines (.split content "\n")]
              (doseq [l lines]
                (let [t (clojure.string/trim l)]
                  (when-not (empty? t)
                    (<cmd ctx :create-todo t))))))]
        (set! (.-onload reader) onload-evt)
        (println (.readAsText reader file))))

(defn render [ctx]
  (let [file-input (r/atom nil)]  
    (fn []
      [:div
        [:input {:type "file"
                :style {:display "none"}
                :ref #(reset! file-input %)
                :on-change #(import-file ctx %)}]
        [:button {:on-click #(.click @file-input)}
        "üìéImport from file"]])))

(def component
  (<comp :renderer render))
#+end_src

**** file export_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/export_txt.cljs")
**** src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title "\t" (or time 0)))
                   todos)
        content (str/join "\n" lines)
        blob (js/Blob. #js [content] #js {:type "text/plain;charset=utf-8"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    (set! (.-href a) url)
    (set! (.-download a)
          (str "todos-" (.toISOString (js/Date.)) ".txt"))
    (.click a)
    (.revokeObjectURL js/URL url)))

(defn render [ctx]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button.export-btn
     {:on-click #(export-file @todos)
      :title "Export current list to text file"}
     "üíæ Export to text"]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))


#+end_src


#+end_src
*** –¥–æ–±–∞–≤–∏–ª –Ω–æ –Ω–∞ –º—ã—à—å [comp> ctx :export-txt] –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∞–Ω–∏–º–∞—Ü–∏—é –Ω–∞–∂–∞—Ç–∏—è, –Ω–æ –Ω–µ –≤—ã–≤–æ–¥–∏—Ç –æ–∫–Ω–æ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ø—É—Ç–∏.
–º–æ–∂–µ—Ç —Å—Ç–æ–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∏—Ü–∏–ø onload-evt (fn [evt] –∫–Ω–æ–ø–∫–∏ –∏–∑ import_txt.cljs?
** DONE –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Å–ª–æ–≤–∞ –≤ —Ü—Å–≤
CSV —ç–∫—Å–ø–æ—Ä—Ç
–≤–æ–∑–º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ —Å—Ä–∞–∑—É –≤—Å–µ –≤ —Ü—Å–≤
—Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ 
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ –Ω–µ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
—Å–æ—Ö—Ä–æ–Ω—è—Ç—å —Ç–µ —á—Ç–æ –≤ –¥–∞–Ω—ã–π –º–æ–º–µ–Ω—Ç –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã
—Ç–æ–µ—Å—Ç—å –∫–Ω–æ–ø–∫–∞ "—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã–µ as .csv"
—Ç–æ–µ—Å—Ç—å –ª–∏–±–æ –≤—Å–µ –ª–∏–±–æ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ –ª–∏–±–æ –Ω–µ –∑–∞–≤–µ—Ä—à–æ–Ω—ã–µ
*** 03
–î–∞, –∞–±—Å–æ–ª—é—Ç–Ω–æ –≤–µ—Ä–Ω–æ üí° ‚Äî –∏–º–µ–Ω–Ω–æ —ç—Ç–æ –∏ —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å.
–í `import-txt.cljs` —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å **–Ω–∞—Å—Ç–æ—è—â–∏–π `<button>` —ç–ª–µ–º–µ–Ω—Ç** —Å —Ö–µ–Ω–¥–ª–µ—Ä–æ–º `:on-click`, –∫–æ—Ç–æ—Ä—ã–π —Ä–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è, –∞ `export-txt` —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –ø–æ–∫–∞ –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–µ–∫—Å—Ç –∏–ª–∏ —Å—Å—ã–ª–∫—É, –±–µ–∑ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

---

### üîç –ü–æ—á–µ–º—É `:export-txt` –Ω–µ —Ä–µ–∞–≥–∏—Ä—É–µ—Ç

–ï—Å–ª–∏ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `export-txt` (–∫–æ—Ç–æ—Ä—ã–π —Ç—ã –µ—â—ë –Ω–µ –ø–æ–∫–∞–∑–∞–ª) —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è, —Å–∫–∞–∂–µ–º, –ø—Ä–æ—Å—Ç–æ `[:span "Export"]` –∏–ª–∏ `[:a "Export"]` –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Å–æ–±—ã—Ç–∏—è (`:on-click`), —Ç–æ –±—Ä–∞—É–∑–µ—Ä –Ω–µ –≤–∏–¥–∏—Ç –≤ —ç—Ç–æ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω–æ–≥–æ –¥–µ–π—Å—Ç–≤–∏—è.
–ö—Ä–æ–º–µ —Ç–æ–≥–æ, –µ—Å–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞, –≤–∞–∂–Ω–æ **–≤—ã–∑–≤–∞—Ç—å `js/Blob` + `js/URL.createObjectURL`** ‚Äî –∏–Ω–∞—á–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –Ω–µ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç.

---

### üí° –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ ‚Äî —Å–¥–µ–ª–∞—Ç—å –∫–Ω–æ–ø–∫—É –∫–∞–∫ –≤ `import-txt`

–¢–æ –µ—Å—Ç—å –≤ –¥—É—Ö–µ:

```clojure
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]
            [reagent.core :as r]))

(defn export-file [ctx]
  (let [todos (sub> ctx :todos)
        content (clojure.string/join "\n" (map :title todos))
        blob (js/Blob. #js [content] #js {:type "text/plain"})
        url (js/URL.createObjectURL blob)
        link (.createElement js/document "a")]
    (set! (.-href link) url)
    (set! (.-download link) "todos.txt")
    (.click link)
    (.revokeObjectURL js/URL url)))

(defn render [ctx]
  [:button {:on-click #(export-file ctx)}
   "üíæ Export to file"])

(def component
  (<comp :renderer render))
```

---

### üß© –ß—Ç–æ –¥–µ–ª–∞–µ—Ç —ç—Ç–æ—Ç –∫–æ–¥

  * –ë–µ—Ä—ë—Ç –≤—Å–µ –∑–∞–¥–∞—á–∏ —á–µ—Ä–µ–∑ `sub> ctx :todos` (–ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç—Å—è, —á—Ç–æ —Ç–∞–∫–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ –µ—Å—Ç—å).
  * –°–æ–∑–¥–∞—ë—Ç –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª (`Blob`), —Å–æ–¥–µ—Ä–∂–∞—â–∏–π —Ç–µ–∫—Å—Ç—ã –∑–∞–¥–∞—á.
  * –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç —Å—Å—ã–ª–∫—É –∏ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ.
  * –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –æ—á–∏—â–∞–µ—Ç URL, —á—Ç–æ–±—ã –Ω–µ —É—Ç–µ–∫–∞–ª–∞ –ø–∞–º—è—Ç—å.

---

### ‚ú® –ß—Ç–æ–±—ã –≤–ø–∏—Å–∞—Ç—å –≤ —Å—Ç–∏–ª—å TodoMVC

–î–æ–±–∞–≤—å CSS:

```css
footer.info button {
  background: none;
  border: 2px solid #ccc;
  border-radius: 4px;
  padding: 6px 12px;
  color: #555;
  cursor: pointer;
  transition: all 0.2s ease-out;
}

footer.info button:hover {
  background: #eee;
  border-color: #bbb;
  color: #333;
}
```

---

–•–æ—á–µ—à—å, —è –ø–æ–∫–∞–∂—É —Ç–µ–±–µ, –∫–∞–∫ —Å–¥–µ–ª–∞—Ç—å —Ç–∞–∫, —á—Ç–æ–±—ã **—ç–∫—Å–ø–æ—Ä—Ç –∏ –∏–º–ø–æ—Ä—Ç-–∫–Ω–æ–ø–∫–∏** –±—ã–ª–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º–∏ (–æ–¥–∏–Ω —Å—Ç–∏–ª—å, –æ–±—â–∞—è –ª–æ–≥–∏–∫–∞, –Ω–æ —Ä–∞–∑–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è)?
*** 

(defn export-file [ctx]
  (let [todos (sub> ctx :todos)
        content (clojure.string/join "\n" (map :title todos))
        blob (js/Blob. #js [content] #js {:type "text/plain"})
        url (js/URL.createObjectURL blob)
        link (.createElement js/document "a")]
    (set! (.-href link) url)
    (set! (.-download link) "todos.txt")
    (.click link)
    (.revokeObjectURL js/URL url)))
** DONE —Å—Ç–∏–ª—å
*** src
**** file export_txt.cljs
(find-file-other-frame "./src/keechma_todomvc/components/export_txt.cljs")
**** src export_txt.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.export-txt
  (:require [keechma-todomvc.ui :refer [<comp sub> route>]]
            [clojure.string :as str]))

(defn export-file [todos {:keys [sep ext eof]}]
  (let [lines (map (fn [{:keys [title time]}]
                     (str title sep (or time 0)))
                   todos)
        content (str/join eof lines)
        blob (js/Blob. #js [content] #js {:type "text/plain;charset=utf-8"})
        url (.createObjectURL js/URL blob)
        a (.createElement js/document "a")]
    ;; —Å–æ–∑–¥–∞—ë–º —Å—Å—ã–ª–∫—É
    (set! (.-href a) url)
    (set! (.-download a)
          (str "words-" (.toISOString (js/Date.)) ext))
    ;; –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç –≤ DOM, –∏–Ω–∞—á–µ Firefox –Ω–µ —Å—Ä–µ–∞–≥–∏—Ä—É–µ—Ç
    (.appendChild (.-body js/document) a)
    ;; "–∫–ª–∏–∫" –ø–æ —Å—Å—ã–ª–∫–µ
    (.click a)
    ;; —É–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ DOM –∏ –æ—Å–≤–æ–±–æ–∂–¥–∞–µ–º URL —á—É—Ç—å –ø–æ–∑–∂–µ
    (.remove a)
    (js/setTimeout #(js/URL.revokeObjectURL url) 2000)))

(defn render [ctx {:keys [title] :as props}]
  (let [route-status (keyword (route> ctx :status))
        todos (sub> ctx :todos-by-status route-status)]
    [:button.export-btn
     {:on-click #(export-file todos props)
      :title "Export current list to text file"}
     title]))

(def component
  (<comp :renderer render
         :subscription-deps [:todos-by-status]))


#+end_src


#+end_src
**** file components/app.cljs
(find-file-other-frame "./src/keechma_todomvc/components/app.cljs")
**** src components/app.cljs
#+begin_src clojure :no-expand t :mkdirp yes 
(ns keechma-todomvc.components.app
  "# Main app component"
  (:require [keechma-todomvc.ui :refer [<comp comp> sub> <cmd]]))


(defn render
  [ctx]
  [:<>
   [:section.todoapp
    [:header.header
     [:h1 "Worder"]
     [comp> ctx :import-txt]
     [comp> ctx :new-todo]]
    (when (sub> ctx :has-todos?)
      [:<>
       [:section.main
        [comp> ctx :toggle-todos]
        [comp> ctx :todo-list]]
       [comp> ctx :footer]])]
   [:footer.info
    [comp> ctx :export-txt {:title "üíæ Export to text"
                            :sep "\t"
                            :eof "\n"
                            :ext ".txt"}]
    [comp> ctx :export-txt {:title "üíæ Export to CSV "
                            :sep ";"
                            :eof "\n"
                            :ext ".csv"}]
    [:p "Double-click to edit a Word"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "http://todomvc.com"} "Freeman"]]]])

(def component
  (<comp :renderer render
         :component-deps [:new-todo
                          :toggle-todos
                          :todo-list
                          :import-txt
                          :export-txt
                          :footer]
         :subscription-deps [:has-todos?]))

#+end_src

**** /* === Export Button (Keechma WorderMVC) === */
#+begin_src css :no-expand t :mkdirp yes 
.export-btn {
    float: right;
    margin-left: 8px;
    padding: 3px 10px;
    font-size: 12px;
    line-height: 20px;
    border: 1px solid #ccc;
    border-radius: 3px;
    background: #fafafa;
    cursor: pointer;
    color: #555;
    transition: all 0.2s ease-in-out;
}

.export-btn:hover {
    background: #e6e6e6;
    border-color: #aaa;
    color: #333;
}

.export-btn:active {
    background: #d6d6d6;
    border-color: #888;
}

.footer .export-btn {
    position: relative;
    top: -2px;
}


#+end_src
*** –¥–æ–≤–∞–π –ø–æ–ø—Ä–∞–≤–∏–º —Å—Ç–∏–ª—å
–∫–Ω–æ–ø–∫–∏ –µ–∫—Å–ø–æ—Ä—Ç–∞
—Å–µ–π—á–∞—Å –æ–Ω–∏ –≤–∏–∑—É–∞–ª—å–Ω–æ —Ä–∞—Å–ø–æ–ª–≥–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–æ 
    [:p "Double-click to edit a Word"]
    [:p
     [:a {:href "https://keechma.com"} "Keechma"] " "
     [:a {:href "http://todomvc.com"} "Freeman"]]]])
–¥–æ–≤–∞–π —Å–¥–µ–ª–∞–µ–º –µ–≥–æ —Å–≤–µ—Ä—Ö—É –Ω–∞–¥ –Ω–∏–º–∏ –∏ –ø—Ä–∏–∂–∞—Ç—ã–º–∏ –∫ –ª–µ–≤–æ–º—É –∫—Ä–∞—é
—Å—Ä–∞–∑—É –ø–æ–¥ [comp> ctx :footer]])]
*** 
/* === Export Panel Layout === */
.export-panel {
    display: flex;
    justify-content: flex-start;
    gap: 8px;
    margin: 10px 0 15px 0;
    padding-left: 2px;
}

/* –°–∞–º–∏ –∫–Ω–æ–ø–∫–∏ —á—É—Ç—å –∫—Ä—É–ø–Ω–µ–µ –∏ –≤–∏–∑—É–∞–ª—å–Ω–æ –≤—ã–¥–µ–ª–µ–Ω—ã */
.export-btn {
    font-size: 13px;
    padding: 4px 12px;
    background: #f8f8f8;
    border: 1px solid #ccc;
    border-radius: 4px;
    color: #444;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
}

.export-btn:hover {
    background: #e6e6e6;
    border-color: #999;
}

.export-btn:active {
    background: #d0d0d0;
    border-color: #777;
}

** DONE –∑–∞–±–∏–ª–¥–∏—Ç—å –¥–ª—è —Ä–∞–∑–º–µ—à–µ–Ω–∏—è
*** SRC
**** "./project.clj"
(defproject keechma-todomvc "0.1.0-SNAPSHOT"
  :description "TodoMVC implemented in Keechma"
  :url "http://github.com/keechma/keechma-todomvc"
  :license {:name "MIT"}

  :min-lein-version "2.5.3"

  :dependencies [[org.clojure/clojure "1.10.1"]
                 [org.clojure/clojurescript "1.10.597"]
                 [org.clojure/core.async "0.7.559"
                  :exclusions [org.clojure/tools.reader]]
                 [reagent "0.9.1"]
                 [keechma "0.3.14"
                  :exclusions [cljsjs/react-with-addons
                               cljsjs/react-dom
                               cljsjs/react-dom-server]]
                 [keechma/entitydb "0.1.6"]]

  :plugins [[lein-figwheel "0.5.19"]
            [lein-cljsbuild "1.1.7"
             :exclusions [[org.clojure/clojure]]]
            [lein-marginalia "0.9.1"]]

  :source-paths ["src"]

  :clean-targets ^{:protect false} ["resources/public/js/compiled" "target"]

  :cljsbuild
  {:builds
   [{:id "dev"
     :source-paths ["src"]
     :figwheel {:on-jsload "keechma-todomvc.app/restart!"}
     :compiler {:main                 keechma-todomvc.app
                :optimizations        :none
                :output-to            "resources/public/js/app.js"
                :output-dir           "resources/public/js/dev"
                :asset-path           "js/dev"
                :source-map-timestamp true}}
    ;; This next build is an compressed minified build for
    ;; production. You can build this with:
    ;; lein cljsbuild once min
    {:id "min"
     :source-paths ["src"]
     :compiler {:main            keechma-todomvc.app
                :optimizations   :advanced
                :output-to       "resources/public/js/app.js"
                :output-dir      "resources/public/js/min"
                :elide-asserts   true
                :closure-defines {goog.DEBUG false}
                :pretty-print    false}}]}

  :figwheel {;; :http-server-root "public" ;; default and assumes "resources"
             ;; :server-port 3449 ;; default
             ;; :server-ip "127.0.0.1"

             :css-dirs ["resources/public/css"] ;; watch and update CSS

             ;; Start an nREPL server into the running figwheel process
             ;; :nrepl-port 7888

             ;; Server Ring Handler (optional)
             ;; if you want to embed a ring handler into the figwheel http-kit
             ;; server, this is for simple ring servers, if this
             ;; doesn't work for you just run your own server :)
             ;; :ring-handler hello_world.server/handler

             ;; To be able to open files in your editor from the heads up display
             ;; you will need to put a script on your path.
             ;; that script will have to take a file path and a line number
             ;; ie. in  ~/bin/myfile-opener
             ;; #! /bin/sh
             ;; emacsclient -n +$2 $1
             ;;
             ;; :open-file-command "myfile-opener"

             ;; if you want to disable the REPL
             ;; :repl false

             ;; to configure a different figwheel logfile path
             ;; :server-logfile "tmp/logs/figwheel-logfile.log"
             })
*** lein figwheel
—Ç–∞–∫ —è –∑–∞–ø—É–∫–∞–ª —ç—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø–æ–∫–∞ –µ–≥–æ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–ª. —Ç–µ–ø–µ—Ä—å –≤–æ–ø—Ä–æ—Å.
—è —Ö–æ—á—É –µ–≥–æ –∑–∞—Ö–æ—Å—Ç–∏—Ç—å –∞ –∑–Ω–∞—á–∏—Ç –º–Ω–µ –Ω—É–∂–Ω–æ –µ–≥–æ –∑–∞–±–∏–ª–¥–∏—Ç—å –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å?
–∫–∞–∫–æ–π –∫–æ–º–∞–Ω–¥–æ–π —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å?
*** lein cljsbuild once min
–î–∞ üíØ ‚Äî –≤—Å—ë –≤–µ—Ä–Ω–æ.
–ö–æ–≥–¥–∞ —Ç—ã —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ—à—å ‚Äî `lein figwheel` –∑–∞–ø—É—Å–∫–∞–µ—Ç ‚Äú–∂–∏–≤–æ–π‚Äù –¥–µ–≤-—Å–µ—Ä–≤–µ—Ä —Å live reload.
–ê **–¥–ª—è –¥–µ–ø–ª–æ—è/—Ö–æ—Å—Ç–∏–Ω–≥–∞** —Ç–µ–±–µ –Ω—É–∂–Ω–æ —Å–æ–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—É—é (‚Äúminified‚Äù) –≤–µ—Ä—Å–∏—é, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –æ–¥–∏–Ω –≥–æ—Ç–æ–≤—ã–π `app.js` –±–µ–∑ dev-–∫–æ–¥–∞, –¥–µ–±–∞–≥-–∏–Ω—Ñ–æ –∏ Figwheel-—Ö—É–∫–æ–≤.

---

### üöÄ –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è production-—Å–±–æ—Ä–∫–∏

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ (–≥–¥–µ –ª–µ–∂–∏—Ç `project.clj`) –∑–∞–ø—É—Å—Ç–∏:

```bash
lein cljsbuild once min
```

---

### üß± –ß—Ç–æ –ø—Ä–∏ —ç—Ç–æ–º –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç

  * Leiningen –∑–∞–ø—É—Å—Ç–∏—Ç **build —Å id `"min"`**, –æ–ø–∏—Å–∞–Ω–Ω—ã–π –≤ —Ç–≤–æ—ë–º `:cljsbuild`.
  * –û–Ω —Å–æ–∑–¥–∞—Å—Ç –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JavaScript:

  ```
  resources/public/js/app.js
  ```

  –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π output-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

  ```
  resources/public/js/min/
  ```
  * –ò—Å—Ö–æ–¥–Ω—ã–µ –∫–∞—Ä—Ç—ã (`source maps`) –∏ dev-—Ñ–∞–π–ª—ã –Ω–µ –ø–æ–ø–∞–¥—É—Ç –≤ –±–∏–ª–¥.

---

### üß≠ –ü–æ—Å–ª–µ —Å–±–æ—Ä–∫–∏

1. –ü—Ä–æ–≤–µ—Ä—å, —á—Ç–æ –≤ `resources/public/index.html` –ø–æ–¥–∫–ª—é—á—ë–Ω –∏–º–µ–Ω–Ω–æ —ç—Ç–æ—Ç `app.js`:

   ```html
   <script src="js/app.js"></script>
   ```

   (–∞ –Ω–µ `js/dev/app.js` –∏–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ–¥–æ–±–Ω–æ–µ)

2. –ú–æ–∂–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ:

   ```bash
   npx http-server resources/public
   ```

   –∏–ª–∏

   ```bash
   python3 -m http.server -d resources/public
   ```

3. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø—Ä–æ—Å—Ç–æ –∑–∞–ª–∏–≤–∞–µ—à—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ `resources/public` –Ω–∞ –ª—é–±–æ–π —Ö–æ—Å—Ç–∏–Ω–≥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Netlify, GitHub Pages, Vercel –∏ —Ç.–¥.).

---

### üí° –ü–æ–¥—Å–∫–∞–∑–∫–∞

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Å–¥–µ–ª–∞—Ç—å **—á–∏—Å—Ç—É—é –ø–µ—Ä–µ—Å–±–æ—Ä–∫—É**, —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏:

```bash
lein clean
```

–∞ –ø–æ—Ç–æ–º:

```bash
lein cljsbuild once min
```

---

–•–æ—á–µ—à—å ‚Äî —è –ø–æ–∫–∞–∂—É, –∫–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç—É—é —Ü–µ–ª—å `lein build` (alias), —á—Ç–æ–±—ã –≤–º–µ—Å—Ç–æ –¥–ª–∏–Ω–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã —Ç—ã –º–æ–≥ –ø—Ä–æ—Å—Ç–æ –ø–∏—Å–∞—Ç—å `lein build` –¥–ª—è production-—Å–±–æ—Ä–∫–∏?
*** 
** DONE –∑–∞—Ö–æ—Å—Ç–∏—Ç—å
–≤–æ–∑–º–æ–∂–Ω–æ –Ω—É–∂–Ω–∞ –±—É–¥–µ—Ç –ø–æ–º–æ—à—å –£–Ω–∏
* 2025-11-02
** file worder-cljs-project.org
(find-file-other-frame "/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/worder/worder-cljs-project.org")
** my-cljs-project.org
(find-file-other-frame "/home/buyn/Dev/ClojureScript/tutorials/my-cljs-project/my-cljs-project.org")
